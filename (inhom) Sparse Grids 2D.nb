(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.4' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    103854,       2677]
NotebookOptionsPosition[    100684,       2566]
NotebookOutlinePosition[    101042,       2582]
CellTagsIndexPosition[    100999,       2579]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Standard Definitions", "Subsection",
 CellChangeTimes->{{3.673277052290266*^9, 3.6732770726158047`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Phi]", "[", "x_", "]"}], ":=", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Abs", "[", "x", "]"}], ">", "1"}], ",", "0", ",", 
    RowBox[{"1", "-", 
     RowBox[{"Abs", "[", "x", "]"}]}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Phi]", "[", 
   RowBox[{"l_", ",", "i_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"l", "\[Equal]", 
      RowBox[{"-", "1"}]}], ",", "1", ",", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"l", "\[Equal]", "0"}], ",", "#", ",", 
       RowBox[{"\[Phi]", "[", 
        RowBox[{
         SuperscriptBox["2", "l"], 
         RowBox[{"(", 
          RowBox[{"#", "-", 
           RowBox[{
            SuperscriptBox["2", 
             RowBox[{"-", "l"}]], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", "i"}], "-", "1"}], ")"}]}]}], ")"}]}], "]"}]}], 
      "]"}]}], "]"}], "&"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Phi]", "[", 
   RowBox[{"lx_", ",", "ly_", ",", "i_", ",", "j_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"\[Phi]", "[", 
      RowBox[{"lx", ",", "i"}], "]"}], "[", "#1", "]"}], 
    RowBox[{
     RowBox[{"\[Phi]", "[", 
      RowBox[{"ly", ",", "j"}], "]"}], "[", "#2", "]"}]}], 
   "&"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Psi]", "[", 
   RowBox[{"lx_", ",", "ly_", ",", "i_", ",", "j_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"\[Phi]", "[", 
     RowBox[{
      SuperscriptBox["2", "lx"], 
      RowBox[{"(", 
       RowBox[{"#1", "-", 
        RowBox[{
         SuperscriptBox["2", 
          RowBox[{"-", "lx"}]], "i"}]}], ")"}]}], "]"}], 
    RowBox[{"\[Phi]", "[", 
     RowBox[{
      SuperscriptBox["2", "ly"], 
      RowBox[{"(", 
       RowBox[{"#2", "-", 
        RowBox[{
         SuperscriptBox["2", 
          RowBox[{"-", "ly"}]], "j"}]}], ")"}]}], "]"}]}], 
   "&"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ceil", "[", 
   RowBox[{"x_", ",", "l_"}], "]"}], ":=", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"x", "\[GreaterEqual]", "1"}], ",", 
    SuperscriptBox["2", 
     RowBox[{"l", "-", "1"}]], ",", 
    RowBox[{"1", "+", 
     RowBox[{"Floor", "[", 
      RowBox[{
       SuperscriptBox["2", 
        RowBox[{"l", "-", "1"}]], "x"}], "]"}]}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"switch", "[", "x_", "]"}], ":=", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"x", "\[GreaterEqual]", "1"}], ",", "x", ",", "1"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"switch2", "[", "x_", "]"}], ":=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"x", "\[Equal]", 
      RowBox[{"-", "1"}]}], ",", "0", ",", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"x", "\[Equal]", "0"}], ",", "1", ",", 
       SuperscriptBox["2", 
        RowBox[{"-", "x"}]]}], "]"}]}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"column2", "[", 
   RowBox[{"diag_", ",", "row_"}], "]"}], ":=", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"diag", "<", "1"}], ",", "diag", ",", " ", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"row", "<", "1"}], ",", "diag", ",", 
      RowBox[{"diag", "-", "row", "+", "1"}]}], "]"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"column1", "[", 
    RowBox[{"diag_", ",", "row_"}], "]"}], ":=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"diag", "\[Equal]", "row"}], ",", 
     RowBox[{"-", "1"}], ",", 
     RowBox[{"column2", "[", 
      RowBox[{"diag", ",", "row"}], "]"}]}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"getrow", "[", 
   RowBox[{"perp_", ",", "diag_"}], "]"}], ":=", 
  RowBox[{"Which", "[", 
   RowBox[{
    RowBox[{"diag", "\[Equal]", 
     RowBox[{"-", "1"}]}], ",", 
    RowBox[{"-", "1"}], ",", 
    RowBox[{"diag", "\[Equal]", "0"}], ",", 
    RowBox[{"Min", "[", 
     RowBox[{"perp", ",", "0"}], "]"}], ",", 
    RowBox[{"perp", "\[LessEqual]", "diag"}], ",", "perp", ",", "True", ",", 
    "diag"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"getcol", "[", 
    RowBox[{"perp_", ",", "diag_"}], "]"}], ":=", 
   RowBox[{"Which", "[", 
    RowBox[{
     RowBox[{"diag", "\[Equal]", 
      RowBox[{"-", "1"}]}], ",", 
     RowBox[{"-", "1"}], ",", 
     RowBox[{"diag", "\[Equal]", "0"}], ",", 
     RowBox[{"Min", "[", 
      RowBox[{
       RowBox[{"diag", "-", "perp"}], ",", "0"}], "]"}], ",", 
     RowBox[{"perp", ">", "0"}], ",", 
     RowBox[{"diag", "-", "perp", "+", "1"}], ",", "True", ",", "diag"}], 
    "]"}]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"endperp", "[", "n_", "]"}], ":=", 
   RowBox[{"Which", "[", 
    RowBox[{
     RowBox[{"n", "\[Equal]", 
      RowBox[{"-", "1"}]}], ",", 
     RowBox[{"-", "1"}], ",", 
     RowBox[{"n", "\[Equal]", "0"}], ",", "1", ",", "True", ",", 
     RowBox[{"n", "+", "2"}]}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"d\[Phi]", "[", "x_", "]"}], ":=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Abs", "[", "x", "]"}], ">", "1"}], ",", "0", ",", 
     "\[IndentingNewLine]", "\t\t\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"x", "\[Equal]", "1"}], " ", ",", 
       RowBox[{
        RowBox[{"-", "1"}], "/", "2"}], ",", "\[IndentingNewLine]", "\t\t\t", 
       
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"x", "\[Equal]", 
          RowBox[{"-", "1"}]}], ",", 
         RowBox[{"1", "/", "2"}], ",", "\[IndentingNewLine]", "\t\t\t", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"x", "\[Equal]", "0"}], ",", "0", ",", 
           "\[IndentingNewLine]", "\t\t\t", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"x", ">", "0"}], ",", 
             RowBox[{"-", "1"}], ",", "1"}], "]"}]}], "]"}]}], "]"}]}], 
      "]"}]}], "]"}]}], 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Don", "'"}], "t", " ", "think", " ", "I", " ", "need", " ", 
    "this"}], "*)"}]}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.672490224395479*^9, 3.672490298682095*^9}, 
   3.6724944378264093`*^9, {3.672494898687271*^9, 3.672494957647328*^9}, {
   3.672496678860899*^9, 3.6724967092866983`*^9}, 3.672496936925047*^9, {
   3.672497137416025*^9, 3.672497137938712*^9}, {3.672497654192381*^9, 
   3.6724977082489758`*^9}, {3.6724977496958313`*^9, 3.672497762411235*^9}, {
   3.672757291016025*^9, 3.672757331279429*^9}, {3.67275767040593*^9, 
   3.672757682845997*^9}, {3.672757721439649*^9, 3.67275773288477*^9}, {
   3.6731055659610367`*^9, 3.673105573038452*^9}, {3.6731077900913553`*^9, 
   3.673107795441799*^9}, {3.673111144094293*^9, 3.6731111471587067`*^9}, {
   3.67311118676823*^9, 3.673111196955504*^9}, 3.6731132158566*^9, {
   3.673113441846511*^9, 3.673113455170422*^9}, {3.673113485653905*^9, 
   3.6731134966601753`*^9}, 3.673115028551476*^9, {3.6731150643821163`*^9, 
   3.673115123930702*^9}, {3.673115492203158*^9, 3.6731154931966057`*^9}, {
   3.67311562008355*^9, 3.673115670135125*^9}, {3.673115713193399*^9, 
   3.6731157292920856`*^9}, {3.673115828134582*^9, 3.6731158455282593`*^9}, {
   3.673226161112205*^9, 3.673226161339789*^9}, {3.6732267733638697`*^9, 
   3.673226789334585*^9}, 3.673277018076087*^9, {3.67327848391285*^9, 
   3.673278522454027*^9}, {3.673371562946054*^9, 3.6733715810386972`*^9}, {
   3.673625453062598*^9, 3.673625465333948*^9}, {3.67362576703554*^9, 
   3.6736257999170837`*^9}, {3.673626166302894*^9, 3.673626168023837*^9}, {
   3.6736302300216217`*^9, 3.673630328234693*^9}, {3.67363377874596*^9, 
   3.673633778921495*^9}, {3.673707639980641*^9, 3.673707646364229*^9}, {
   3.6737831754221582`*^9, 3.673783209560733*^9}, {3.673785893472739*^9, 
   3.673785988789469*^9}, {3.6737860208897543`*^9, 3.673786028084447*^9}, {
   3.673786230986429*^9, 3.67378624132312*^9}, {3.673786284299685*^9, 
   3.673786305161662*^9}, {3.673786335983499*^9, 3.6737863535520563`*^9}, {
   3.673786406633304*^9, 3.673786408624165*^9}, {3.673787677416293*^9, 
   3.673787713948784*^9}, 3.673787988762076*^9, {3.673798866362308*^9, 
   3.673799013917637*^9}, {3.673799240953815*^9, 3.673799248487845*^9}, {
   3.673799284797557*^9, 3.67379930504216*^9}, {3.673799353720017*^9, 
   3.673799362750903*^9}, {3.673799419915134*^9, 3.67379947974662*^9}, {
   3.6737995547718363`*^9, 3.6737995647953453`*^9}, {3.67379960247902*^9, 
   3.673799673038477*^9}, {3.673799707707058*^9, 3.67379975376333*^9}, {
   3.673801251597981*^9, 3.6738012517052927`*^9}, {3.673801300132337*^9, 
   3.673801300466476*^9}, {3.673801335100066*^9, 3.673801359821342*^9}, {
   3.673801602312234*^9, 3.6738019209687757`*^9}, {3.6738029969809017`*^9, 
   3.6738030314442663`*^9}, {3.673803082532922*^9, 3.673803106762065*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"test2D", "[", 
   RowBox[{"x_", ",", "y_"}], "]"}], ":=", 
  RowBox[{"Cos", "[", 
   RowBox[{"x", "+", "y"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.673873259802924*^9, 3.673873273365546*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Standard Basis", "Subsection",
 CellChangeTimes->{{3.673277052290266*^9, 3.673277056255988*^9}, {
   3.673367982176783*^9, 3.6733679845358677`*^9}, 3.673643134677516*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"standardCoefficients2D", "[", 
   RowBox[{"f_", ",", "lx_", ",", "ly_"}], "]"}], ":=", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"f", "[", 
     RowBox[{
      RowBox[{
       SuperscriptBox["2", 
        RowBox[{"-", "lx"}]], " ", "i"}], ",", 
      RowBox[{
       SuperscriptBox["2", 
        RowBox[{"-", "ly"}]], " ", "j"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "0", ",", 
      SuperscriptBox["2", "lx"]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"j", ",", "0", ",", 
      SuperscriptBox["2", "ly"]}], "}"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"standardReconstruct2D", "[", 
    RowBox[{"coefficients_", ",", "lx_", ",", "ly_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"coefficients", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{"i", "+", "1"}], ",", 
          RowBox[{"j", "+", "1"}]}], "]"}], "]"}], " ", 
       RowBox[{
        RowBox[{"\[Psi]", "[", 
         RowBox[{"lx", ",", "ly", ",", "i", ",", "j"}], "]"}], "[", 
        RowBox[{"#1", ",", "#2"}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "0", ",", 
        SuperscriptBox["2", "lx"]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", "0", ",", 
        SuperscriptBox["2", "ly"]}], "}"}]}], "]"}], "&"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"standardProject2D", "[", 
   RowBox[{"f_", ",", "lx_", ",", "ly_"}], "]"}], ":=", 
  RowBox[{"standardReconstruct2D", "[", 
   RowBox[{
    RowBox[{"standardCoefficients2D", "[", 
     RowBox[{"f", ",", "lx", ",", "ly"}], "]"}], ",", "lx", ",", "ly"}], 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.6733680003972816`*^9, 3.6733681189558687`*^9}, {
  3.673370933680094*^9, 3.673370994522457*^9}, {3.673371036059031*^9, 
  3.6733711201950502`*^9}, {3.6733711714335012`*^9, 3.673371175445512*^9}, {
  3.673371413375792*^9, 3.673371423930414*^9}, {3.6733715870924797`*^9, 
  3.673371621567006*^9}, {3.673371658601623*^9, 3.673371665146308*^9}, {
  3.673617918986994*^9, 3.6736179378880987`*^9}, {3.67361801388404*^9, 
  3.6736180150769053`*^9}, {3.67362175928094*^9, 3.673621761032077*^9}, {
  3.673803992943742*^9, 3.673804011118949*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Full Basis", "Subsection",
 CellChangeTimes->{{3.673277052290266*^9, 3.673277056255988*^9}, {
  3.67357648054101*^9, 3.673576481088376*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"getCoefficient", "[", 
    RowBox[{"f_", ",", "x_", ",", "l_"}], "]"}], ":=", 
   RowBox[{"N", "@", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"l", "\[Equal]", 
       RowBox[{"-", "1"}]}], ",", 
      RowBox[{"f", "[", "0", "]"}], ",", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"l", "\[Equal]", "0"}], ",", 
        RowBox[{
         RowBox[{"f", "[", "1", "]"}], "-", 
         RowBox[{"f", "[", "0", "]"}]}], ",", 
        RowBox[{
         RowBox[{"f", "[", "x", "]"}], "-", 
         RowBox[{
          RowBox[{"1", "/", "2"}], " ", 
          RowBox[{"f", "[", 
           RowBox[{"x", "+", 
            RowBox[{"2", "^", 
             RowBox[{"-", "l"}]}]}], "]"}]}], "-", 
         RowBox[{
          RowBox[{"1", "/", "2"}], " ", 
          RowBox[{"f", "[", 
           RowBox[{"x", "-", 
            RowBox[{"2", "^", 
             RowBox[{"-", "l"}]}]}], "]"}]}]}]}], "]"}]}], "]"}]}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"getCoefficient2D", "[", 
    RowBox[{"f_", ",", "x_", ",", "y_", ",", "lx_", ",", "ly_"}], "]"}], ":=", 
   RowBox[{"getCoefficient", "[", 
    RowBox[{
     RowBox[{"Function", "[", 
      RowBox[{"y1", ",", 
       RowBox[{"getCoefficient", "[", 
        RowBox[{
         RowBox[{"Function", "[", 
          RowBox[{"x1", ",", 
           RowBox[{"f", "[", 
            RowBox[{"x1", ",", "y1"}], "]"}]}], "]"}], ",", "x", ",", "lx"}], 
        "]"}]}], "]"}], ",", "y", ",", "ly"}], "]"}]}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Tensor", " ", "product", " ", "construction"}], 
   "\[IndentingNewLine]", "*)"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"fullCoefficients2D", "[", 
    RowBox[{"f_", ",", "lx_", ",", "ly_"}], "]"}], ":=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"getCoefficient2D", "[", 
        RowBox[{"f", ",", 
         RowBox[{
          SuperscriptBox["2", 
           RowBox[{"-", "kx"}]], " ", "i"}], ",", 
         RowBox[{
          SuperscriptBox["2", 
           RowBox[{"-", "ky"}]], " ", "j"}], ",", "kx", ",", "ky"}], "]"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{
          SuperscriptBox["2", 
           RowBox[{"switch", "[", "kx", "]"}]], "-", "1"}], ",", "2"}], "}"}],
        ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", 
         RowBox[{
          SuperscriptBox["2", 
           RowBox[{"switch", "[", "ky", "]"}]], "-", "1"}], ",", "2"}], 
        "}"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"kx", ",", 
       RowBox[{"-", "1"}], ",", "lx"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"ky", ",", 
       RowBox[{"-", "1"}], ",", "ly"}], "}"}]}], "]"}]}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Reconstruct2D", "[", "coefficients_", "]"}], ":=", " ", 
   RowBox[{
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"coefficients", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{"kx", "+", "2"}], ",", 
          RowBox[{"ky", "+", "2"}], ",", 
          RowBox[{"ceil", "[", 
           RowBox[{"#1", ",", 
            RowBox[{"switch", "[", "kx", "]"}]}], "]"}], ",", 
          RowBox[{"ceil", "[", 
           RowBox[{"#2", ",", 
            RowBox[{"switch", "[", "ky", "]"}]}], "]"}]}], "]"}], "]"}], " ", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\[Phi]", "[", 
         RowBox[{"kx", ",", "ky", ",", 
          RowBox[{"ceil", "[", 
           RowBox[{"#1", ",", 
            RowBox[{"switch", "[", "kx", "]"}]}], "]"}], ",", 
          RowBox[{"ceil", "[", 
           RowBox[{"#2", ",", 
            RowBox[{"switch", "[", "ky", "]"}]}], "]"}]}], "]"}], "[", 
        RowBox[{"#1", ",", "#2"}], "]"}]}], "\[IndentingNewLine]", ",", 
      RowBox[{"{", 
       RowBox[{"kx", ",", 
        RowBox[{"-", "1"}], ",", 
        RowBox[{
         RowBox[{"Length", "[", "coefficients", "]"}], "-", "2"}]}], "}"}], 
      ",", 
      RowBox[{"{", 
       RowBox[{"ky", ",", 
        RowBox[{"-", "1"}], ",", 
        RowBox[{
         RowBox[{"Length", "[", "coefficients", "]"}], "-", "2"}]}], "}"}]}], 
     "]"}], "&"}]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"reverseFlatten", "[", 
    RowBox[{"coefficients_", ",", "kx_", ",", "ky_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "k", "}"}], ",", 
     RowBox[{
      RowBox[{"k", "=", "0"}], ";", 
      RowBox[{"Return", "[", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"coefficients", "[", 
            RowBox[{"[", 
             RowBox[{"++", "k"}], "]"}], "]"}], " ", ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", 
             SuperscriptBox["2", 
              RowBox[{
               RowBox[{"switch", "[", "lx", "]"}], "-", "1"}]]}], "}"}], ",", 
           
           RowBox[{"{", 
            RowBox[{"j", ",", "1", ",", 
             SuperscriptBox["2", 
              RowBox[{
               RowBox[{"switch", "[", "ly", "]"}], "-", "1"}]]}], "}"}]}], 
          "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"lx", ",", 
           RowBox[{"-", "1"}], ",", "kx"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"ly", ",", 
           RowBox[{"-", "1"}], ",", "ky"}], "}"}]}], "]"}], "]"}], ";"}]}], 
    "]"}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"project2D", "[", 
   RowBox[{"f_", ",", "lx_", ",", "ly_"}], "]"}], ":=", 
  RowBox[{"Reconstruct2D", "[", 
   RowBox[{"fullCoefficients2D", "[", 
    RowBox[{"f", ",", "lx", ",", "ly"}], "]"}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.672497905249762*^9, 3.6724980460804987`*^9}, {
   3.672498086010971*^9, 3.672498086426568*^9}, {3.672498120610044*^9, 
   3.672498132168372*^9}, {3.6724981933241796`*^9, 3.6724982357720547`*^9}, {
   3.672498276279566*^9, 3.672498326466967*^9}, {3.672498396348793*^9, 
   3.672498474897173*^9}, {3.67249856256668*^9, 3.6724985772347393`*^9}, {
   3.672498885753086*^9, 3.6724988887908688`*^9}, {3.672498973735808*^9, 
   3.6724989750417128`*^9}, {3.672499010376442*^9, 3.672499028840345*^9}, {
   3.672499325454844*^9, 3.672499329989029*^9}, {3.672499410615137*^9, 
   3.672499411943338*^9}, {3.673034778920154*^9, 3.673034779751392*^9}, {
   3.67303878112294*^9, 3.673038789981296*^9}, {3.6730390939721413`*^9, 
   3.673039148248605*^9}, 3.673264987008442*^9, {3.673265302956407*^9, 
   3.673265412069075*^9}, 3.673265484744018*^9, {3.6732655859770203`*^9, 
   3.673265599390531*^9}, {3.673549789331839*^9, 3.673549792474326*^9}, {
   3.673549937783786*^9, 3.673550067559483*^9}, {3.673550130904303*^9, 
   3.673550188655244*^9}, {3.673550222539015*^9, 3.673550263661482*^9}, {
   3.673550377429068*^9, 3.673550605255698*^9}, {3.673550658843258*^9, 
   3.673550674368505*^9}, {3.673550721880124*^9, 3.673550733630953*^9}, {
   3.6735508024880533`*^9, 3.6735508208972387`*^9}, {3.673551354349574*^9, 
   3.673551396733061*^9}, {3.673551464740687*^9, 3.67355147329633*^9}, {
   3.673551584855508*^9, 3.673551634805602*^9}, {3.673551685006486*^9, 
   3.673551707024789*^9}, {3.6735517673505163`*^9, 3.6735517949923353`*^9}, {
   3.6735518410399*^9, 3.673551856586239*^9}, {3.673552424760128*^9, 
   3.673552441686385*^9}, {3.6735528116472397`*^9, 3.673552820772859*^9}, {
   3.673553485545643*^9, 3.673553494259479*^9}, {3.6735535318168592`*^9, 
   3.67355353200189*^9}, {3.673553604649831*^9, 3.673553647805532*^9}, {
   3.673553784064872*^9, 3.673553853609994*^9}, {3.673554166480525*^9, 
   3.6735541678554363`*^9}, {3.673554200527424*^9, 3.673554201829867*^9}, {
   3.673554251115727*^9, 3.673554282927092*^9}, {3.6735543333531923`*^9, 
   3.673554340509158*^9}, {3.6735543940457973`*^9, 3.6735544556685667`*^9}, {
   3.673554497906698*^9, 3.673554498898905*^9}, {3.673576494836705*^9, 
   3.673576499717845*^9}, 3.6735765366015453`*^9, {3.673618128943383*^9, 
   3.673618130973936*^9}, {3.673619092051015*^9, 3.67361912676166*^9}, {
   3.673620420351119*^9, 3.673620496933251*^9}, {3.673620881831188*^9, 
   3.673620882921871*^9}, {3.673620949180478*^9, 3.6736210125382423`*^9}, {
   3.673621431465794*^9, 3.6736214391143417`*^9}, {3.6736215581179047`*^9, 
   3.6736215599219103`*^9}, {3.673621636818694*^9, 3.673621651195643*^9}, {
   3.673622841424548*^9, 3.6736228650698757`*^9}, 3.6736229433901*^9, {
   3.6736232301017036`*^9, 3.6736232463693113`*^9}, {3.673623282681774*^9, 
   3.67362328670819*^9}, 3.673623546299397*^9, {3.673624155189372*^9, 
   3.673624187683448*^9}, {3.673624259831815*^9, 3.673624287992454*^9}, {
   3.673624335560773*^9, 3.6736243654325733`*^9}, {3.673624615790103*^9, 
   3.6736246228422747`*^9}, {3.673624663960896*^9, 3.67362466708747*^9}, {
   3.673624820117755*^9, 3.6736249337957172`*^9}, {3.673625035903747*^9, 
   3.6736251121044083`*^9}, {3.6736253167153788`*^9, 
   3.6736253579904623`*^9}, {3.6736255302697477`*^9, 3.673625587758218*^9}, {
   3.673625691597685*^9, 3.67362571108678*^9}, {3.673625949932444*^9, 
   3.673625970469276*^9}, {3.673626294423847*^9, 3.673626308940868*^9}, {
   3.673626361145555*^9, 3.6736263813442917`*^9}, {3.673626612762067*^9, 
   3.673626642947071*^9}, 3.673627182248803*^9, {3.673627271199099*^9, 
   3.6736273004473343`*^9}, {3.673627575286366*^9, 3.673627582774056*^9}, {
   3.673630558590191*^9, 3.673630594039089*^9}, {3.673630834026103*^9, 
   3.673630835187813*^9}, {3.673634052909828*^9, 3.6736340758783207`*^9}, {
   3.673634114536069*^9, 3.673634152687709*^9}, {3.673641997399588*^9, 
   3.673642095416727*^9}, {3.673642167167782*^9, 3.6736421781509953`*^9}, {
   3.6736422248218727`*^9, 3.673642244356945*^9}, 3.67364312756176*^9, {
   3.6736454537836723`*^9, 3.6736454639501257`*^9}, {3.673784467451808*^9, 
   3.67378450842913*^9}, {3.6738040733758163`*^9, 3.673804077443865*^9}, {
   3.6738041119027452`*^9, 3.673804118531611*^9}, {3.673872609465744*^9, 
   3.673872610676214*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Sparse Basis", "Subsection",
 CellChangeTimes->{{3.673277052290266*^9, 3.673277061302971*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"sparseCoefficients2D", "[", 
    RowBox[{"f_", ",", "n_"}], "]"}], ":=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"getCoefficient2D", "[", 
          RowBox[{"f", ",", 
           RowBox[{
            RowBox[{"switch2", "[", 
             RowBox[{"getrow", "[", 
              RowBox[{"perp", ",", "diag"}], "]"}], "]"}], " ", "i"}], ",", 
           RowBox[{
            RowBox[{"switch2", "[", 
             RowBox[{"getcol", "[", 
              RowBox[{"perp", ",", "diag"}], "]"}], "]"}], " ", "j"}], ",", 
           RowBox[{"getrow", "[", 
            RowBox[{"perp", ",", "diag"}], "]"}], ",", 
           RowBox[{"getcol", "[", 
            RowBox[{"perp", ",", "diag"}], "]"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{
            SuperscriptBox["2", 
             RowBox[{"switch", "[", 
              RowBox[{"getrow", "[", 
               RowBox[{"perp", ",", "diag"}], "]"}], "]"}]], "-", "1"}], ",", 
           "2"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "1", ",", 
           RowBox[{
            SuperscriptBox["2", 
             RowBox[{"switch", "[", 
              RowBox[{"getcol", "[", 
               RowBox[{"perp", ",", "diag"}], "]"}], "]"}]], "-", "1"}], ",", 
           "2"}], "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"perp", ",", 
         RowBox[{"-", "1"}], ",", 
         RowBox[{"endperp", "[", "diag", "]"}]}], "}"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"diag", ",", 
       RowBox[{"-", "1"}], ",", "n"}], "}"}]}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"sparseReconstruct", "[", "coefficients_", "]"}], ":=", 
   RowBox[{
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"coefficients", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{"diag", "+", "2"}], ",", 
            RowBox[{"perp", "+", "2"}], ",", 
            RowBox[{"ceil", "[", 
             RowBox[{"#1", ",", 
              RowBox[{"switch", "[", 
               RowBox[{"getrow", "[", 
                RowBox[{"perp", ",", "diag"}], "]"}], "]"}]}], "]"}], ",", 
            RowBox[{"ceil", "[", 
             RowBox[{"#2", ",", 
              RowBox[{"switch", "[", 
               RowBox[{"getcol", "[", 
                RowBox[{"perp", ",", "diag"}], "]"}], "]"}]}], "]"}]}], "]"}],
           "]"}], " ", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"\[Phi]", "[", 
           RowBox[{
            RowBox[{"getrow", "[", 
             RowBox[{"perp", ",", "diag"}], "]"}], ",", 
            RowBox[{"getcol", "[", 
             RowBox[{"perp", ",", "diag"}], "]"}], ",", 
            RowBox[{"ceil", "[", 
             RowBox[{"#1", ",", 
              RowBox[{"switch", "[", 
               RowBox[{"getrow", "[", 
                RowBox[{"perp", ",", "diag"}], "]"}], "]"}]}], "]"}], ",", 
            RowBox[{"ceil", "[", 
             RowBox[{"#2", ",", 
              RowBox[{"switch", "[", 
               RowBox[{"getcol", "[", 
                RowBox[{"perp", ",", "diag"}], "]"}], "]"}]}], "]"}]}], "]"}],
           "[", 
          RowBox[{"#1", ",", "#2"}], "]"}]}], "\[IndentingNewLine]", ",", 
        RowBox[{"{", 
         RowBox[{"perp", ",", 
          RowBox[{"-", "1"}], ",", 
          RowBox[{"endperp", "[", "diag", "]"}]}], "}"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"diag", ",", 
        RowBox[{"-", "1"}], ",", 
        RowBox[{
         RowBox[{"Length", "[", "coefficients", "]"}], "-", "2"}]}], "}"}]}], 
     "]"}], "&"}]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"sparseProject", "[", 
    RowBox[{"f_", ",", "n_"}], "]"}], ":=", 
   RowBox[{"sparseReconstruct", "[", 
    RowBox[{"sparseCoefficients2D", "[", 
     RowBox[{"f", ",", "n"}], "]"}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sparseIntegrate", "[", 
   RowBox[{"f_", ",", "n_"}], "]"}], ":=", 
  RowBox[{"Sum", "[", 
   RowBox[{
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{"f", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"switch2", "[", 
            RowBox[{"getrow", "[", 
             RowBox[{"perp", ",", "diag"}], "]"}], "]"}], "i"}], ",", 
          RowBox[{
           RowBox[{"switch2", "[", 
            RowBox[{"getcol", "[", 
             RowBox[{"perp", ",", "diag"}], "]"}], "]"}], "j"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{
           SuperscriptBox["2", 
            RowBox[{"switch", "[", 
             RowBox[{"getrow", "[", 
              RowBox[{"perp", ",", "diag"}], "]"}], "]"}]], "-", "1"}], ",", 
          "2"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "1", ",", 
          RowBox[{
           SuperscriptBox["2", 
            RowBox[{"switch", "[", 
             RowBox[{"getcol", "[", 
              RowBox[{"perp", ",", "diag"}], "]"}], "]"}]], "-", "1"}], ",", 
          "2"}], "}"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"perp", ",", 
        RowBox[{"-", "1"}], ",", 
        RowBox[{"endperp", "[", "diag", "]"}]}], "}"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"diag", ",", 
      RowBox[{"-", "1"}], ",", "n"}], "}"}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.672618929348575*^9, 3.6726189300061407`*^9}, {
   3.672618978737381*^9, 3.672619078806769*^9}, {3.672619110725196*^9, 
   3.672619157350065*^9}, {3.672619193438739*^9, 3.67261920365707*^9}, {
   3.672619319494294*^9, 3.672619334232011*^9}, {3.67262008873687*^9, 
   3.672620094647687*^9}, {3.67262015651656*^9, 3.672620440911069*^9}, {
   3.6726205701211433`*^9, 3.67262063754361*^9}, {3.672676267266491*^9, 
   3.672676273622691*^9}, {3.6726763961071568`*^9, 3.672676404788162*^9}, {
   3.6732665910954447`*^9, 3.673266619018859*^9}, {3.673266658674885*^9, 
   3.673266663847871*^9}, {3.673269162063302*^9, 3.673269227835155*^9}, {
   3.6732692710491867`*^9, 3.673269277740987*^9}, {3.673269310322139*^9, 
   3.6732693403785973`*^9}, {3.673277030707767*^9, 3.673277034000938*^9}, {
   3.673627599666712*^9, 3.673627625079471*^9}, {3.673627832142569*^9, 
   3.6736279276961527`*^9}, {3.6736279872590714`*^9, 3.673627987495245*^9}, {
   3.673628028968935*^9, 3.673628098048843*^9}, {3.673628424293537*^9, 
   3.673628424484264*^9}, {3.673628628463648*^9, 3.673628628574724*^9}, {
   3.6736287722368917`*^9, 3.673628812901684*^9}, {3.673628856743156*^9, 
   3.673628899406356*^9}, {3.6736294759345503`*^9, 3.673629483468844*^9}, 
   3.6736295186229763`*^9, {3.673630334859116*^9, 3.6736304022984457`*^9}, {
   3.673630813940319*^9, 3.673630816180293*^9}, 3.67370039301103*^9, {
   3.673782946285776*^9, 3.673782964305489*^9}, {3.6737829947533092`*^9, 
   3.6737830274457273`*^9}, {3.673783160702259*^9, 3.673783172602543*^9}, {
   3.67378326572011*^9, 3.673783308866743*^9}, {3.673783340462134*^9, 
   3.673783419519454*^9}, {3.673784243401146*^9, 3.6737842639124947`*^9}, {
   3.67378452670199*^9, 3.673784566047907*^9}, {3.6737846210423727`*^9, 
   3.67378464273494*^9}, {3.673784738036634*^9, 3.67378476262145*^9}, {
   3.673785866920824*^9, 3.673785886606626*^9}, {3.673786447224745*^9, 
   3.673786477162902*^9}, {3.6737875807216*^9, 3.67378764476019*^9}, {
   3.673787718978281*^9, 3.673787763520397*^9}, {3.673788178123294*^9, 
   3.67378822384226*^9}, {3.6737987403772593`*^9, 3.6737987463428993`*^9}, {
   3.673798833989471*^9, 3.673798854517301*^9}, {3.67379902265583*^9, 
   3.673799153787937*^9}, {3.6738031149029207`*^9, 3.673803117513816*^9}, {
   3.6738032301133327`*^9, 3.67380323901864*^9}, {3.67380351441521*^9, 
   3.6738036175419273`*^9}, {3.673804153635599*^9, 3.673804241715304*^9}, {
   3.6738042961849813`*^9, 3.673804296724662*^9}, {3.673873396311283*^9, 
   3.673873397564124*^9}, {3.673873430072906*^9, 3.673873433691896*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Differentiation", "Subsection",
 CellChangeTimes->{{3.673277052290266*^9, 3.673277061302971*^9}, {
  3.673277119209675*^9, 3.6732771212386723`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"diffx", "[", 
    RowBox[{"f_", ",", "l_"}], "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"#1", "<", " ", 
       SuperscriptBox["2", 
        RowBox[{"-", "l"}]]}], ",", 
      FractionBox[
       RowBox[{
        RowBox[{"f", "[", 
         RowBox[{
          RowBox[{"#1", "+", 
           SuperscriptBox["2", 
            RowBox[{
             RowBox[{"-", "l"}], "-", "1"}]]}], ",", "#2"}], "]"}], "-", 
        RowBox[{"f", "[", 
         RowBox[{"#1", ",", "#2"}], "]"}]}], 
       SuperscriptBox["2", 
        RowBox[{"-", "l"}]]], ",", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"#1", ">", " ", 
         RowBox[{"1", "-", 
          SuperscriptBox["2", 
           RowBox[{"-", "l"}]]}]}], ",", 
        FractionBox[
         RowBox[{
          RowBox[{"f", "[", 
           RowBox[{"#1", ",", "#2"}], "]"}], "-", 
          RowBox[{"f", "[", 
           RowBox[{
            RowBox[{"#1", "-", 
             SuperscriptBox["2", 
              RowBox[{
               RowBox[{"-", "l"}], "-", "1"}]]}], ",", "#2"}], "]"}]}], 
         SuperscriptBox["2", 
          RowBox[{"-", "l"}]]], ",", 
        FractionBox[
         RowBox[{
          RowBox[{"f", "[", 
           RowBox[{
            RowBox[{"#1", "+", 
             SuperscriptBox["2", 
              RowBox[{"-", "l"}]]}], ",", "#2"}], "]"}], "-", 
          RowBox[{"f", "[", 
           RowBox[{
            RowBox[{"#1", "-", 
             SuperscriptBox["2", 
              RowBox[{"-", "l"}]]}], ",", "#2"}], "]"}]}], 
         RowBox[{"2", " ", 
          SuperscriptBox["2", 
           RowBox[{"-", "l"}]]}]]}], " ", "]"}]}], "]"}], "&"}]}], 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"#1", "<", " ", 
       SuperscriptBox["2", 
        RowBox[{"-", "l"}]]}], ",", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"diffx", "[", 
         RowBox[{
          RowBox[{"diffx", "[", 
           RowBox[{"f", ",", 
            RowBox[{"l", "+", "1"}]}], "]"}], ",", 
          RowBox[{"l", "+", "1"}]}], "]"}], "[", 
        RowBox[{
         SuperscriptBox["2", 
          RowBox[{"-", "l"}]], ",", "#2"}], "]"}], "#1"}], ",", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"#1", ">", " ", 
         RowBox[{"1", "-", 
          SuperscriptBox["2", 
           RowBox[{"-", "l"}]]}]}], ",", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"diffx", "[", 
           RowBox[{
            RowBox[{"diffx", "[", 
             RowBox[{"f", ",", 
              RowBox[{"l", "+", "1"}]}], "]"}], ",", 
            RowBox[{"l", "+", "1"}]}], "]"}], "[", 
          RowBox[{
           RowBox[{"1", "-", 
            SuperscriptBox["2", 
             RowBox[{"-", "l"}]]}], ",", "#2"}], "]"}], 
         RowBox[{"(", 
          RowBox[{"#1", "-", "1"}], ")"}]}], ",", 
        FractionBox[
         RowBox[{
          RowBox[{"f", "[", 
           RowBox[{
            RowBox[{"#1", "+", 
             SuperscriptBox["2", 
              RowBox[{"-", "l"}]]}], ",", "#2"}], "]"}], "-", 
          RowBox[{"f", "[", 
           RowBox[{
            RowBox[{"#1", "-", 
             SuperscriptBox["2", 
              RowBox[{"-", "l"}]]}], ",", "#2"}], "]"}]}], 
         RowBox[{"2", " ", 
          SuperscriptBox["2", 
           RowBox[{"-", "l"}]]}]]}], " ", "]"}]}], "]"}], "&"}], "*)"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"diffy", "[", 
   RowBox[{"f_", ",", "l_"}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"#1", "<", " ", 
      SuperscriptBox["2", 
       RowBox[{"-", "l"}]]}], ",", 
     FractionBox[
      RowBox[{
       RowBox[{"f", "[", 
        RowBox[{
         RowBox[{"#1", "+", 
          SuperscriptBox["2", 
           RowBox[{
            RowBox[{"-", "l"}], "-", "1"}]]}], ",", "#2"}], "]"}], "-", 
       RowBox[{"f", "[", 
        RowBox[{"#1", ",", "#2"}], "]"}]}], 
      SuperscriptBox["2", 
       RowBox[{"-", "l"}]]], ",", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"#1", ">", " ", 
        RowBox[{"1", "-", 
         SuperscriptBox["2", 
          RowBox[{"-", "l"}]]}]}], ",", 
       FractionBox[
        RowBox[{
         RowBox[{"f", "[", 
          RowBox[{"#1", ",", "#2"}], "]"}], "-", 
         RowBox[{"f", "[", 
          RowBox[{
           RowBox[{"#1", "-", 
            SuperscriptBox["2", 
             RowBox[{
              RowBox[{"-", "l"}], "-", "1"}]]}], ",", "#2"}], "]"}]}], 
        SuperscriptBox["2", 
         RowBox[{"-", "l"}]]], ",", 
       FractionBox[
        RowBox[{
         RowBox[{"f", "[", 
          RowBox[{
           RowBox[{"#1", "+", 
            SuperscriptBox["2", 
             RowBox[{"-", "l"}]]}], ",", "#2"}], "]"}], "-", 
         RowBox[{"f", "[", 
          RowBox[{
           RowBox[{"#1", "-", 
            SuperscriptBox["2", 
             RowBox[{"-", "l"}]]}], ",", "#2"}], "]"}]}], 
        RowBox[{"2", " ", 
         SuperscriptBox["2", 
          RowBox[{"-", "l"}]]}]]}], " ", "]"}]}], "]"}], "&"}], 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"#2", "<", " ", 
       SuperscriptBox["2", 
        RowBox[{"-", "l"}]]}], ",", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"diffy", "[", 
         RowBox[{
          RowBox[{"diffy", "[", 
           RowBox[{"f", ",", 
            RowBox[{"l", "+", "1"}]}], "]"}], ",", 
          RowBox[{"l", "+", "1"}]}], "]"}], "[", 
        RowBox[{"#1", ",", 
         SuperscriptBox["2", 
          RowBox[{"-", "l"}]]}], "]"}], "#2"}], ",", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"#2", ">", " ", 
         RowBox[{"1", "-", 
          SuperscriptBox["2", 
           RowBox[{"-", "l"}]]}]}], ",", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"diffy", "[", 
           RowBox[{
            RowBox[{"diffy", "[", 
             RowBox[{"f", ",", 
              RowBox[{"l", "+", "1"}]}], "]"}], ",", 
            RowBox[{"l", "+", "1"}]}], "]"}], "[", 
          RowBox[{"#1", ",", 
           RowBox[{"1", "-", 
            SuperscriptBox["2", 
             RowBox[{"-", "l"}]]}]}], "]"}], 
         RowBox[{"(", 
          RowBox[{"#2", "-", "1"}], ")"}]}], ",", 
        FractionBox[
         RowBox[{
          RowBox[{"f", "[", 
           RowBox[{"#1", ",", 
            RowBox[{"#2", "+", 
             SuperscriptBox["2", 
              RowBox[{"-", "l"}]]}]}], "]"}], "-", 
          RowBox[{"f", "[", 
           RowBox[{"#1", ",", 
            RowBox[{"#2", "-", 
             SuperscriptBox["2", 
              RowBox[{"-", "l"}]]}]}], "]"}]}], 
         RowBox[{"2", " ", 
          SuperscriptBox["2", 
           RowBox[{"-", "l"}]]}]]}], "]"}]}], "]"}], "&"}], 
   "*)"}]}]}], "Input",
 CellChangeTimes->{{3.673194722114348*^9, 3.673194848078546*^9}, {
  3.673195420421319*^9, 3.673195424146777*^9}, {3.67319548233215*^9, 
  3.6731954984431143`*^9}, {3.673195695801755*^9, 3.673195698084182*^9}, {
  3.673195740549865*^9, 3.673195742188155*^9}, {3.673195791828994*^9, 
  3.67319579584198*^9}, {3.673195916950042*^9, 3.673195927075912*^9}, {
  3.673272654000877*^9, 3.673272657649295*^9}, {3.673631402814698*^9, 
  3.673631509795334*^9}, {3.673631572843629*^9, 3.6736315790820503`*^9}, {
  3.6736441006268263`*^9, 3.673644104168631*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Algorithms to form the D Matrices", "Subsection",
 CellChangeTimes->{{3.673277052290266*^9, 3.673277061302971*^9}, {
  3.673277119209675*^9, 3.6732771212386723`*^9}, {3.673348508736053*^9, 
  3.673348513701818*^9}, {3.673726996709992*^9, 3.673726996814013*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"dxMatrix", "[", 
   RowBox[{"lx_", ",", "ly_"}], "]"}], ":=", 
  RowBox[{"Flatten", "[", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"fullCoefficients2D", "[", 
          RowBox[{
           RowBox[{"diffx", "[", 
            RowBox[{
             RowBox[{"\[Phi]", "[", 
              RowBox[{"kx", ",", "ky", ",", "i", ",", "j"}], "]"}], ",", 
             "lx"}], "]"}], ",", "lx", ",", "ly"}], "]"}], "//", "Flatten"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          SuperscriptBox["2", 
           RowBox[{
            RowBox[{"switch", "[", "kx", "]"}], "-", "1"}]]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "1", ",", 
          SuperscriptBox["2", 
           RowBox[{
            RowBox[{"switch", "[", "ky", "]"}], "-", "1"}]]}], "}"}]}], "]"}],
       ",", 
      RowBox[{"{", 
       RowBox[{"kx", ",", 
        RowBox[{"-", "1"}], ",", "lx"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"ky", ",", 
        RowBox[{"-", "1"}], ",", "ly"}], "}"}]}], "]"}], ",", "3"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"dyMatrix", "[", 
    RowBox[{"lx_", ",", "ly_"}], "]"}], ":=", 
   RowBox[{"Flatten", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"fullCoefficients2D", "[", 
           RowBox[{
            RowBox[{"diffy", "[", 
             RowBox[{
              RowBox[{"\[Phi]", "[", 
               RowBox[{"kx", ",", "ky", ",", "i", ",", "j"}], "]"}], ",", 
              "lx"}], "]"}], ",", "lx", ",", "ly"}], "]"}], "//", "Flatten"}],
          ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           SuperscriptBox["2", 
            RowBox[{
             RowBox[{"switch", "[", "kx", "]"}], "-", "1"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "1", ",", 
           SuperscriptBox["2", 
            RowBox[{
             RowBox[{"switch", "[", "ky", "]"}], "-", "1"}]]}], "}"}]}], 
        "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"kx", ",", 
         RowBox[{"-", "1"}], ",", "lx"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"ky", ",", 
         RowBox[{"-", "1"}], ",", "ly"}], "}"}]}], "]"}], ",", "3"}], "]"}]}],
   "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dxMatrixStandard", "[", 
   RowBox[{"lx_", ",", "ly_"}], "]"}], ":=", 
  RowBox[{"Flatten", "[", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"standardCoefficients2D", "[", 
        RowBox[{
         RowBox[{"diffx", "[", 
          RowBox[{
           RowBox[{"\[Psi]", "[", 
            RowBox[{"lx", ",", "ly", ",", "i", ",", "j"}], "]"}], ",", "lx"}],
           "]"}], ",", "lx", ",", "ly"}], "]"}], "//", "Flatten"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "0", ",", 
        SuperscriptBox["2", "lx"]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", "0", ",", 
        SuperscriptBox["2", "ly"]}], "}"}]}], "]"}], ",", "1"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"dyMatrixStandard", "[", 
    RowBox[{"lx_", ",", "ly_"}], "]"}], ":=", 
   RowBox[{"Flatten", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"standardCoefficients2D", "[", 
         RowBox[{
          RowBox[{"diffy", "[", 
           RowBox[{
            RowBox[{"\[Psi]", "[", 
             RowBox[{"lx", ",", "ly", ",", "i", ",", "j"}], "]"}], ",", 
            "lx"}], "]"}], ",", "lx", ",", "ly"}], "]"}], "//", "Flatten"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "0", ",", 
         SuperscriptBox["2", "lx"]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "0", ",", 
         SuperscriptBox["2", "ly"]}], "}"}]}], "]"}], ",", "1"}], "]"}]}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"dxMatrixSparse", "[", "n_", "]"}], ":=", 
   RowBox[{"Flatten", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"sparseCoefficients2D", "[", 
             RowBox[{
              RowBox[{"diffx", "[", 
               RowBox[{
                RowBox[{"\[Phi]", "[", 
                 RowBox[{"row", ",", 
                  RowBox[{"diag", "-", "row", "-", "1"}], ",", "i", ",", 
                  "j"}], "]"}], ",", "n"}], "]"}], ",", "n"}], "]"}], "//", 
            "Flatten"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", 
             SuperscriptBox["2", 
              RowBox[{
               RowBox[{"switch", "[", "row", "]"}], "-", "1"}]]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "1", ",", 
             SuperscriptBox["2", 
              RowBox[{
               RowBox[{"switch", "[", 
                RowBox[{"diag", "-", "row", "-", "1"}], "]"}], "-", "1"}]]}], 
            "}"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"row", ",", 
           RowBox[{"-", "1"}], ",", "diag"}], "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"diag", ",", 
         RowBox[{"-", "1"}], ",", "n"}], "}"}]}], "]"}], ",", "3"}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dyMatrixSparse", "[", "n_", "]"}], ":=", 
  RowBox[{"Flatten", "[", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"sparseCoefficients2D", "[", 
            RowBox[{
             RowBox[{"diffy", "[", 
              RowBox[{
               RowBox[{"\[Phi]", "[", 
                RowBox[{"row", ",", 
                 RowBox[{"diag", "-", "row", "-", "1"}], ",", "i", ",", "j"}],
                 "]"}], ",", "n"}], "]"}], ",", "n"}], "]"}], "//", 
           "Flatten"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            SuperscriptBox["2", 
             RowBox[{
              RowBox[{"switch", "[", "row", "]"}], "-", "1"}]]}], "}"}], ",", 
          
          RowBox[{"{", 
           RowBox[{"j", ",", "1", ",", 
            SuperscriptBox["2", 
             RowBox[{
              RowBox[{"switch", "[", 
               RowBox[{"diag", "-", "row", "-", "1"}], "]"}], "-", "1"}]]}], 
           "}"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"row", ",", 
          RowBox[{"-", "1"}], ",", "diag"}], "}"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"diag", ",", 
        RowBox[{"-", "1"}], ",", "n"}], "}"}]}], "]"}], ",", "3"}], 
   "]"}]}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.673277867319282*^9, 3.6732779300785646`*^9}, {
   3.673277978146747*^9, 3.6732780613417473`*^9}, {3.673278163936036*^9, 
   3.673278194240142*^9}, {3.6732783469534073`*^9, 3.6732783674885817`*^9}, {
   3.673278532659255*^9, 3.673278558822431*^9}, {3.673278639088067*^9, 
   3.673278640005465*^9}, {3.673290353189601*^9, 3.6732903560928698`*^9}, {
   3.673290433654249*^9, 3.673290460510437*^9}, {3.673314006761815*^9, 
   3.6733140253354063`*^9}, {3.673347895510769*^9, 3.673347979542997*^9}, {
   3.67334800955755*^9, 3.673348010890189*^9}, {3.673348519527342*^9, 
   3.6733485396519337`*^9}, {3.6733720182152987`*^9, 3.673372091710594*^9}, {
   3.673372138253531*^9, 3.673372155572139*^9}, {3.673373040842484*^9, 
   3.6733730522313433`*^9}, {3.673576517299284*^9, 3.6735765213924427`*^9}, {
   3.6735777990523787`*^9, 3.6735778022107058`*^9}, {3.6735779933788157`*^9, 
   3.673577993517743*^9}, {3.6735782590440693`*^9, 3.673578266240716*^9}, {
   3.6735783990495977`*^9, 3.6735784109048443`*^9}, {3.673578875313389*^9, 
   3.673578905089498*^9}, 3.673579073462871*^9, {3.67357912109041*^9, 
   3.6735791212321453`*^9}, {3.6736291034321833`*^9, 3.67362913050037*^9}, {
   3.6736296430613728`*^9, 3.673629730192254*^9}, {3.6737828651909122`*^9, 
   3.673782876276456*^9}, {3.673783015579423*^9, 3.6737830232833347`*^9}, {
   3.673875729211529*^9, 3.6738757646233187`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"sparseSection", "[", 
    RowBox[{"n_", ",", "kx_", ",", "ky_"}], "]"}], ":=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"kx", ">", "0"}], " ", "&&", 
       RowBox[{"ky", ">", "0"}]}], ")"}], ",", " ", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"kx", "+", "ky"}], ">", "n"}], ",", "0", ",", "1"}], "]"}], 
     ",", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"kx", ">", "n"}], " ", "||", " ", 
        RowBox[{"ky", ">", "n"}]}], ",", "0", ",", "1"}], "]"}]}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sparseEmbedding", "[", "n_", "]"}], ":=", 
  RowBox[{"Flatten", "[", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"sparseSection", "[", 
         RowBox[{"n", ",", "kx", ",", "ky"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          SuperscriptBox["2", 
           RowBox[{
            RowBox[{"switch", "[", "kx", "]"}], "-", "1"}]]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "1", ",", 
          SuperscriptBox["2", 
           RowBox[{
            RowBox[{"switch", "[", "ky", "]"}], "-", "1"}]]}], "}"}]}], "]"}],
       ",", 
      RowBox[{"{", 
       RowBox[{"kx", ",", 
        RowBox[{"-", "1"}], ",", "n"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"ky", ",", 
        RowBox[{"-", "1"}], ",", "n"}], "}"}]}], "]"}], ",", "3"}], 
   "]"}]}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.673871975335453*^9, 3.673872000261675*^9}, {
   3.6738720345530453`*^9, 3.6738721615702868`*^9}, {3.673872226390912*^9, 
   3.673872288590211*^9}, {3.673872367733705*^9, 3.6738723726884317`*^9}, 
   3.673872459533833*^9, 3.6738728104421177`*^9, {3.673874435962675*^9, 
   3.673874444313146*^9}, {3.673875581622025*^9, 3.67387558708954*^9}, {
   3.673875715744316*^9, 3.6738757185628853`*^9}, {3.6738759959481583`*^9, 
   3.673876005547387*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"#", "[", 
      RowBox[{"[", 
       RowBox[{"i", ",", "i"}], "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "81"}], "}"}]}], "]"}], "&"}], "@", 
  RowBox[{"sparseEmbedding", "[", "3", "]"}]}]], "Input",
 CellChangeTimes->{{3.673875884371244*^9, 3.67387588974543*^9}, {
  3.67387594129633*^9, 3.6738759486037483`*^9}, {3.673875981521517*^9, 
  3.673875985725198*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "1.`", ",", "1.`", ",", "1.`", ",", "1.`", ",", "1.`", ",", "1.`", ",", 
   "1.`", ",", "1.`", ",", "1.`", ",", "1.`", ",", "1.`", ",", "1.`", ",", 
   "1.`", ",", "1.`", ",", "1.`", ",", "1.`", ",", "1.`", ",", "1.`", ",", 
   "1.`", ",", "1.`", ",", "1.`", ",", "1.`", ",", "1.`", ",", "0.`", ",", 
   "0.`", ",", "0.`", ",", "0.`", ",", "1.`", ",", "1.`", ",", "1.`", ",", 
   "1.`", ",", "1.`", ",", "1.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
   "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
   "0.`", ",", "0.`", ",", "0.`", ",", "1.`", ",", "1.`", ",", "1.`", ",", 
   "1.`", ",", "1.`", ",", "1.`", ",", "1.`", ",", "1.`", ",", "0.`", ",", 
   "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
   "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
   "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
   "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
   "0.`", ",", "0.`", ",", "0.`"}], "}"}]], "Output",
 CellChangeTimes->{
  3.673875938524823*^9, {3.673875979079155*^9, 3.6738759873280153`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"#1", ".", "#2"}], "-", 
      RowBox[{"#2", ".", "#1"}]}], "&"}], "[", 
    RowBox[{
     RowBox[{"dxMatrix", "[", 
      RowBox[{"4", ",", "4"}], "]"}], ",", 
     RowBox[{"sparseEmbedding", "[", "4", "]"}]}], "]"}], "//", "ArrayPlot"}],
   "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.6738722423356123`*^9, 3.6738722653929853`*^9}, {
   3.673872302842557*^9, 3.673872350271927*^9}, {3.673872424261882*^9, 
   3.673872475162575*^9}, 3.673872505975293*^9, {3.6738744744400387`*^9, 
   3.673874504553689*^9}, {3.6738755952242737`*^9, 3.673875723449419*^9}, {
   3.673875771197034*^9, 3.67387579185819*^9}, {3.673875829849378*^9, 
   3.673875863744936*^9}}],

Cell[BoxData[
 GraphicsBox[RasterBox[CompressedData["
1:eJzt3V1qW2cUhWG3I8hlLhWRuh1Gx9AhBHrdKWTowQRRckCWpfOjtfd+BOFB
OEmXdD6s14pxv3z7759/f395efny289fP29//c2326eQHSRJkkepf0iS5DT1
D0mSnKb+IUmS09Q/JElymvqHJElOU/+QJMlp6h+SJEmSJEmSJEmSJEmSJEmS
JEmSJEmSJEmSJEmSJEmSJEmSJEmSJEmSJEmSJEmSJEmSJEmSJEmSJEmSJEmS
JEmSJEmSJEmSJEmSJEmSJEmSJEmSJEmSJEmSJEmSJEmSJEmSJEmSJEmSJEmS
JEmSJEmSJEmSJEmSJEmSJEmSJEmSJEmSJEmSJEmSJEmSJEmSJEmSJEmSJEmS
JEmSJEmSJEmSJEmSZCc/2UGSJIeZ0h0pO0iSZH9TuiNlB0mS7G9Kd6TsIEmS
/U3pjpQdJEmyvyndkbKDJEn2N6U7UnaQJMn+pnRHyg6SJMmjTOmfU8gOkiTZ
X/1DkiSnqX9IkuQ09Q9JkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkuQ2
pvycR5IkyaPUPyRJcpr6hyRJTlP/kCRJ/qo+IkmS09Q/JElymvqHJElOU/+Q
JEmSJEmSJEmSJEmSJEmSJEmSJEmSJEmSJEmSJFnPlJ8nmLLjFLKDJEnuZ0p3
pOzQPyRJ9jelO1J26B+SJPub0h0pO/QPSZI8Sv0zYy9Jkvxf/TNjL0mS5Nam
dCRJkuRR6h+SJDldPUSSJKepf0iS5Nam98Xy+6N9vzRJklyr/iFJktPVQyRJ
cpr6hyRJMtv0XiNJktxa/UOSJKerh0iS5DT1D0mS25vy+pqyI/37j9P3kSRZ
wZTuSNmR3hfp+0iS5MfVPz32pXu5PXsHSZK835RerOalHy+3Z+8hSZL3q4Me
83LzfhpJktdN7YzTwmfvqaL3gUiS/Lg6qJeXm+eNJMm6pvZZqt4HIkmyjzro
Pi837wORJN8z5fU1ZUfq62bqrlQvt2fvIEmSJEmSJEmSJEmSJEmSJEmSJEmS
JEmSJEmSJEmSJEmSJEmSJEmSJEmSJEmSJEmSJEmSJEmSJEnO9BSygyRJ8ij1
D0mSnKb+IUmS09Q/JElymvqHJElOU/+QJMlp6h+SJDlN/UOSJEmSJEmSJEmS
JEmSJEmSJEmSJEmSJEmSJEmSJEmSJEmSJEmSJEmSJEmSJEmSJEmSJEmSJEmS
JC+e7CBJksNM6Y6UHSRJsr8p3ZGygyRJ9jelO1J2kCTJ/qZ0R8oOkiTZ35Tu
SNlBkiT7m9IdKTtIkmR/U7ojZQdJkuRRpvTP15AdJEmyv/qHJElOU/+QJMlp
6h+SJMlMUzqNJEnyKPUPSZKcpv4hSZLT1D8kSZK/qo9IkuQ09Q9Jkpym/iFJ
ktPUPyRJMqUHUnb4+YokSfY3pTtSdugfkiT7m9IdKTv0D0mS/U3pjpQd+ock
SR6l/nnMzyE7SJLk/eqfx9Q/JElya1O67JrLXtNDJElyrfqHJElON72Hlv1T
7d/zSJJknvqHJMl5prz+p+xI7wv/HkaS5HpTuiNlh/4hSZIkyce8fD31eeGz
d5EkSW7tte5Jf3+ZJEnyXnUPSZKcpu4hSZIkSZIkSZIkSZIkSZIkSZIkSZIk
SZIkSZIkebR+7hlJkpym/iFJktPUPyRJcpr6hyRJTlP/kCTJaeofkiQ5Tf1D
kiSnqX9IkmQVU7olZQdJkuxvSnek7CBJkv1N6Y6UHSRJsr8p3ZGygyRJ9jel
O1J2kCTJ/qZ0R8oOkiTZ35TuSNlBkiT7m9IdKTtIkiSPMqV/ziE7SJJkf/UP
SZKcpv4hSZLT1D8kSTLFlC5J2XEO2UGSJPczpTtSdpxDdpAkyf1M6Y6UHeeQ
HSRJcj9TuiNlxzlkB0mSJLmHr4v75xv3ySNdns/l/eXXjcv7y99PkuTbTf8w
Wf1DktzD8437Xj+4p2t7xvkkST7i+cZ9ry/cU/1DkiS7+brw60L9QpIkq3ur
c/QOSZIkSZIkSZIkSZIkSZLzTPn+wZT/XwdJkuyv/iFJktPUPyRJcpr6hyRJ
TlP/kCTJaeofkiQ5Tf1DkiSnqX9IkiRZyT9Wfpzv++eNj9/6+uHWx2/9/eQa
9z5fa89/+uMjmav+2Vf9w8rqH5Jd1T/7qn9YWf1Dsqv6Z1/1Dyurf0iSb7fl
58vl5+flfZ9fuaX3nqdb53Pr/x5Jsqf6h89U/5Akyape64rXhR/9cyRJkiRJ
kiRJTrDZ++TfVz6etX+e71v9+a2+n7V1/mrr+oXZ7Hron2yrP7/V97O2zl9t
Xb8wm10P/ZNt9ee3+n7W1vmrresXZrProX+yrf78Vt/P2jp/tXX9wmx2PfRP
ttWf3+r7WVvnr7auX5jNrof+ybb681t9P2vr/NXW9Quz2fXQP9lWf36r72dt
nb/aun5hNrse+ifb6s9v9f2srfNXW9ePa7x1fpyvde79/Lk+3NPu56v74yN5
Xf2zr/qHle1+vro/PpLX1T/7qn9Y2e7nq/vjI3ld/bOv+oeV7X6+uj8+ktzK
ez9f+vzKLT36PDm/JMm3m/7hM9U/JEmyqo92hR4hSZIkSZIkSZIkSZIkSZIk
SZIkSZIkSZIkSZIkSZIkSZIkSZIkSZIkSZIkSZIkSZIkSZIkSZIkSZIkSZIk
SZIkyfL+ANkJrLg=
   "], {{0, 0}, {289, 289}}, {0, 12.}],
  Frame->Automatic,
  FrameLabel->{None, None},
  FrameTicks->{{None, None}, {None, None}},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  Method->{
   "DefaultBoundaryStyle" -> Automatic, "DefaultPlotStyle" -> 
    Automatic}]], "Output",
 CellChangeTimes->{{3.6738722464383287`*^9, 3.673872266643956*^9}, {
   3.673872299015409*^9, 3.673872375415271*^9}, {3.673872437623279*^9, 
   3.673872507556072*^9}, {3.673874430621417*^9, 3.673874506167935*^9}, {
   3.673875603670108*^9, 3.673875634349202*^9}, 3.673875667702771*^9, 
   3.673875698141835*^9, {3.673875783863778*^9, 3.67387579789776*^9}, 
   3.6738758556196203`*^9, 3.673875906969873*^9}]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.673872068618469*^9, 3.6738720726100817`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Table", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"Sqrt", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          SuperscriptBox["2", 
           RowBox[{"-", "6"}]], ")"}], "2"], " ", 
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"test2D", "[", 
              RowBox[{"x", ",", "y"}], "]"}], "-", 
             RowBox[{"#", "[", 
              RowBox[{"x", ",", "y"}], "]"}]}], ")"}], "^", "2"}], ",", 
          RowBox[{"{", 
           RowBox[{"x", ",", "0.01", ",", "1", ",", 
            SuperscriptBox["2", 
             RowBox[{"-", "6"}]]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"y", ",", "0.01", ",", "1", ",", 
            SuperscriptBox["2", 
             RowBox[{"-", "6"}]]}], "}"}]}], "]"}]}], "&"}], "@", 
      RowBox[{"sparseProject", "[", 
       RowBox[{"test2D", ",", "n"}], "]"}]}], "]"}], "//", "N"}], ",", 
   RowBox[{"{", 
    RowBox[{"n", ",", "1", ",", "8"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.673873290840557*^9, 3.673873311954681*^9}, {
   3.673874607347128*^9, 3.6738746087002697`*^9}, 3.67387463937224*^9, {
   3.673881499094136*^9, 3.673881505970889*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0.02517431732761512`", ",", "0.00657039287083258`", ",", 
   "0.0016981877452894455`", ",", "0.0004404140491842503`", ",", 
   "0.00011762989351751823`", ",", "0.000036825486582472205`", ",", 
   "8.500770260862527`*^-6", ",", "2.5901831665621765`*^-6"}], 
  "}"}]], "Output",
 CellChangeTimes->{3.673881566847356*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"sparseError2", "=", 
  RowBox[{"{", 
   RowBox[{
   "0.027014112462531867`", ",", "0.00757616246655969`", ",", 
    "0.0020888184112343427`", ",", "0.0005706304725197153`", ",", 
    "0.00015477287387275615`", ",", "0.000036825486582472205`", ",", 
    "8.500770260862527`*^-6", ",", "2.5901831665621765`*^-6"}], 
   "}"}]}]], "Input",
 CellChangeTimes->{{3.673874743365778*^9, 3.673874751950137*^9}, {
   3.673874813420267*^9, 3.67387481503063*^9}, {3.673874860066923*^9, 
   3.673874860333379*^9}, {3.67387492840945*^9, 3.6738749285970163`*^9}, {
   3.6738812527576523`*^9, 3.673881349341607*^9}, {3.673881458017088*^9, 
   3.673881458997725*^9}, 3.673881773470211*^9, {3.67388181127463*^9, 
   3.673881811804722*^9}, {3.674305845269979*^9, 3.674305846706855*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0.02517431732761512`", ",", "0.00657039287083258`", ",", 
   "0.0016981877452894455`", ",", "0.0004404140491842503`", ",", 
   "0.00011762989351751823`", ",", "0.000036825486582472205`", ",", 
   "8.500770260862527`*^-6", ",", "2.5901831665621765`*^-6"}], 
  "}"}]], "Output",
 CellChangeTimes->{3.673881774196415*^9, 3.673881812683338*^9, 
  3.674305491925125*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"Table", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"Sqrt", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", ".005", ")"}], "2"], " ", 
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"test2D", "[", 
              RowBox[{"x", ",", "y"}], "]"}], "-", 
             RowBox[{"#", "[", 
              RowBox[{"x", ",", "y"}], "]"}]}], ")"}], "^", "2"}], ",", 
          RowBox[{"{", 
           RowBox[{"x", ",", "0", ",", "1", ",", ".005"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"y", ",", "0", ",", "1", ",", ".005"}], "}"}]}], "]"}]}], 
       "&"}], "@", 
      RowBox[{"sparseProject", "[", 
       RowBox[{"test2D", ",", "n"}], "]"}]}], "]"}], "//", "N"}], ",", 
   RowBox[{"{", 
    RowBox[{"n", ",", "1", ",", "5"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.674305574835462*^9, 3.674305603227508*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"sparseError2", "=", 
  RowBox[{"{", 
   RowBox[{
   "0.027014112462531867`", ",", "0.00757616246655969`", ",", 
    "0.0020888184112343427`", ",", "0.0005706304725197153`", ",", 
    "0.00015477287387275615`", ",", "0.00004175531062197106`", ",", 
    "0.000011212337863803431`", ",", "2.9933461908806863`*^-6", ",", 
    "7.962955961280505`*^-7", ",", "2.1102049143402773`*^-7", ",", 
    "5.5790440149218446`*^-8", ",", "1.4676457332174641`*^-8"}], "}"}]}]], \
"Input",
 CellChangeTimes->{{3.674305946250574*^9, 3.674305950584152*^9}, {
   3.674306476909037*^9, 3.6743064772656507`*^9}, {3.6743065207917747`*^9, 
   3.674306521111444*^9}, {3.674306652480788*^9, 3.6743066526877832`*^9}, {
   3.674306744024979*^9, 3.674306744272581*^9}, {3.674306809848168*^9, 
   3.674306810085792*^9}, {3.674307801342723*^9, 3.6743078017589684`*^9}, 
   3.674308199095769*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0.027014112462531867`", ",", "0.00757616246655969`", ",", 
   "0.0020888184112343427`", ",", "0.0005706304725197153`", ",", 
   "0.00015477287387275615`", ",", "0.00004175531062197106`", ",", 
   "0.000011212337863803431`", ",", "2.9933461908806863`*^-6", ",", 
   "7.962955961280505`*^-7", ",", "2.1102049143402773`*^-7", ",", 
   "5.5790440149218446`*^-8", ",", "1.4676457332174641`*^-8"}], 
  "}"}]], "Output",
 CellChangeTimes->{3.6743059532576723`*^9, 3.674306522629233*^9, 
  3.674306653077691*^9, 3.674306744694461*^9, 3.674306811420092*^9, 
  3.6743078024132023`*^9, 3.6743082001111917`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Sqrt", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", ".005", ")"}], "2"], " ", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"test2D", "[", 
            RowBox[{"x", ",", "y"}], "]"}], "-", 
           RowBox[{"#", "[", 
            RowBox[{"x", ",", "y"}], "]"}]}], ")"}], "^", "2"}], ",", 
        RowBox[{"{", 
         RowBox[{"x", ",", "0", ",", "1", ",", ".005"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"y", ",", "0", ",", "1", ",", ".005"}], "}"}]}], "]"}]}], 
     "&"}], "@", 
    RowBox[{"sparseProject", "[", 
     RowBox[{"test2D", ",", "12"}], "]"}]}], "]"}], "//", "N"}]], "Input",
 CellChangeTimes->{{3.674305526328239*^9, 3.674305539843557*^9}, {
   3.6743055714156933`*^9, 3.6743055984225597`*^9}, {3.6743058351735992`*^9, 
   3.6743058546248217`*^9}, {3.674306396745495*^9, 3.67430643080359*^9}, 
   3.674306486056839*^9, 3.6743065895304823`*^9, {3.6743066977064342`*^9, 
   3.6743066979240828`*^9}, 3.674306754905142*^9, 3.674307527971114*^9, {
   3.6743078816933823`*^9, 3.6743078870666323`*^9}}],

Cell[BoxData["1.4676457332174641`*^-8"], "Output",
 CellChangeTimes->{3.674305554897455*^9, 3.674305939779359*^9, 
  3.6743064213909597`*^9, 3.6743064557218723`*^9, 3.674306516216096*^9, 
  3.674306625914639*^9, 3.674306740577622*^9, 3.674306804444809*^9, 
  3.674307586653681*^9, 3.674308114511115*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Sqrt", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", ".01", ")"}], "2"], " ", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"test2D", "[", 
            RowBox[{"x", ",", "y"}], "]"}], "-", 
           RowBox[{"#", "[", 
            RowBox[{"x", ",", "y"}], "]"}]}], ")"}], "^", "2"}], ",", 
        RowBox[{"{", 
         RowBox[{"x", ",", "0", ",", "1", ",", ".01"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"y", ",", "0", ",", "1", ",", ".01"}], "}"}]}], "]"}]}], 
     "&"}], "@", 
    RowBox[{"project2D", "[", 
     RowBox[{"test2D", ",", "7", ",", "7"}], "]"}]}], "]"}], "//", 
  "N"}]], "Input",
 CellChangeTimes->{{3.674306064052782*^9, 3.6743061346359367`*^9}, {
  3.674306231915596*^9, 3.674306232413464*^9}, {3.674306265515355*^9, 
  3.6743063211934853`*^9}}],

Cell[BoxData["6.350669922665702`*^-6"], "Output",
 CellChangeTimes->{{3.674306079278976*^9, 3.674306108020927*^9}, 
   3.674306149519547*^9, {3.674306237871765*^9, 3.674306314487545*^9}, 
   3.674306350170288*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"fullError", "=", 
  RowBox[{"{", 
   RowBox[{
   "0.02524008289780807`", ",", "0.00644999", ",", "0.0016204219737433931`", 
    ",", "0.0004062798404350583`", ",", "0.0001015966883936506`", ",", 
    "0.000025402687440491205`", ",", "6.350669922665702`*^-6"}], 
   "}"}]}]], "Input",
 CellChangeTimes->{{3.673875187419756*^9, 3.673875190366488*^9}, {
   3.673875405606435*^9, 3.673875405927767*^9}, {3.673881024356723*^9, 
   3.673881024708954*^9}, {3.674306084924329*^9, 3.6743061137884808`*^9}, 
   3.674306157763073*^9, {3.674306263108581*^9, 3.674306318447846*^9}, {
   3.67430635336242*^9, 3.674306354979377*^9}, {3.674306636667728*^9, 
   3.674306650483917*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0.02524008289780807`", ",", "0.00644999`", ",", "0.0016204219737433931`", 
   ",", "0.0004062798404350583`", ",", "0.0001015966883936506`", ",", 
   "0.000025402687440491205`", ",", "6.350669922665702`*^-6", ",", 
   "7.962955961280505`*^-7"}], "}"}]], "Output",
 CellChangeTimes->{3.673875190776291*^9, 3.673875406611252*^9, 
  3.6738810273007193`*^9, 3.6743051903687696`*^9, 3.674305475188705*^9, 
  3.674306159281981*^9, 3.674306356469983*^9, 3.67430663816113*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Sqrt", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        SuperscriptBox["2", 
         RowBox[{"-", "6"}]], ")"}], "2"], " ", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"test2D", "[", 
            RowBox[{"x", ",", "y"}], "]"}], "-", 
           RowBox[{"#", "[", 
            RowBox[{"x", ",", "y"}], "]"}]}], ")"}], "^", "2"}], ",", 
        RowBox[{"{", 
         RowBox[{"x", ",", "0.01", ",", "1", ",", 
          SuperscriptBox["2", 
           RowBox[{"-", "6"}]]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"y", ",", "0.01", ",", "1", ",", 
          SuperscriptBox["2", 
           RowBox[{"-", "6"}]]}], "}"}]}], "]"}]}], "&"}], "@", 
    RowBox[{"sparseProject", "[", 
     RowBox[{"test2D", ",", "4"}], "]"}]}], "]"}], "//", "N"}]], "Input",
 CellChangeTimes->{{3.6738747904452543`*^9, 3.67387479323481*^9}, 
   3.673874833106793*^9, {3.67387488033361*^9, 3.673874880433322*^9}, {
   3.673881158646158*^9, 3.673881162624275*^9}, 3.673881215589629*^9, {
   3.6738812638902407`*^9, 3.673881352285657*^9}, {3.6738814169909697`*^9, 
   3.673881418759503*^9}}],

Cell[BoxData["0.00042887723647028046`"], "Output",
 CellChangeTimes->{
  3.673874810114787*^9, 3.673874853724908*^9, 3.673874905672236*^9, 
   3.673881192578026*^9, 3.673881235165175*^9, {3.673881280751383*^9, 
   3.673881358038114*^9}}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"test2D", "[", 
   RowBox[{"x_", ",", "y_"}], "]"}], ":=", 
  RowBox[{"Cos", "[", 
   RowBox[{"x", "+", "y"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.6743053752164392`*^9, 3.674305381291051*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ListPlot", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"fullLengths", "[", 
          RowBox[{"[", "n", "]"}], "]"}], ",", 
         RowBox[{
          RowBox[{"fullError", "[", 
           RowBox[{"[", "n", "]"}], "]"}], "//", "Log2"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"n", ",", "1", ",", "7"}], "}"}]}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"sparseLengths", "[", 
          RowBox[{"[", "n", "]"}], "]"}], ",", 
         RowBox[{
          RowBox[{"sparseError2", "[", 
           RowBox[{"[", "n", "]"}], "]"}], "//", "Log2"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"n", ",", "1", ",", "12"}], "}"}]}], "]"}]}], "}"}], 
   "\[IndentingNewLine]", ",", 
   RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
   RowBox[{"AxesLabel", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"\"\<Log # of Points\>\"", ",", " ", "\"\<Log of Error\>\""}], 
     "}"}]}], ",", 
   RowBox[{"PlotLegends", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"\"\<Full\>\"", ",", "\"\<Sparse\>\""}], "}"}]}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.673874724213746*^9, 3.673874757140642*^9}, {
   3.673875121489868*^9, 3.673875142501671*^9}, {3.673875417166319*^9, 
   3.673875418406535*^9}, {3.6738810444223747`*^9, 3.673881059364006*^9}, {
   3.6738819145264606`*^9, 3.673881914885633*^9}, {3.6743053980131073`*^9, 
   3.6743054193333483`*^9}, {3.6743054828875732`*^9, 3.674305483050435*^9}, 
   3.6743068174207363`*^9, {3.6743078090554447`*^9, 3.6743078303881702`*^9}}],

Cell[BoxData[
 TemplateBox[{GraphicsBox[{{}, {{{}, {
        Hue[0.67, 0.6, 0.6], 
        Directive[
         PointSize[0.012833333333333334`], 
         RGBColor[0.368417, 0.506779, 0.709798], 
         AbsoluteThickness[1.6]], 
        PointBox[{{3.169925001442312, -5.308139541100055}, {
         4.643856189774724, -7.276487360864427}, {
         6.339850002884624, -9.269414730716361}, {
         8.174925682500678, -11.265238599587711`}, {
         10.088788238716907`, -13.26485900220238}, {
         12.044735626056909`, -15.264659341534921`}, {
         14.022454510846508`, -17.264659781671057`}}]}, {
        Hue[0.9060679774997897, 0.6, 0.6], 
        Directive[
         PointSize[0.012833333333333334`], 
         RGBColor[0.880722, 0.611041, 0.142051], 
         AbsoluteThickness[1.6]], 
        PointBox[{{3., -5.210142906178357}, {
         4.087462841250339, -7.044317015737154}, {
         5.20945336562895, -8.903097205659982}, {
         6.339850002884624, -10.775155588502193`}, {
         7.467605550082998, -12.657559738548452`}, {
         8.588714635582264, -14.547680776952093`}, {
         9.702172685365548, -16.444553351256868`}, {
         10.808159772868375`, -18.34980942814796}, {
         11.907266248531066`, -20.260192585320517`}, {
         13.000176099486442`, -22.1761135635974}, {
         14.08754571427451, -24.09540682577009}, {
         15.169964136519175`, -26.02192099296887}}]}, {}}}, {}}, {
    DisplayFunction -> Identity, PlotRangePadding -> {{
        Scaled[0.02], 
        Scaled[0.02]}, {
        Scaled[0.05], 
        Scaled[0.02]}}, AxesOrigin -> {2.8098443103668878`, 0}, 
     PlotRange -> {{3., 15.169964136519175`}, {-26.02192099296887, 0}}, 
     PlotRangeClipping -> True, ImagePadding -> All, DisplayFunction -> 
     Identity, AspectRatio -> NCache[GoldenRatio^(-1), 0.6180339887498948], 
     Axes -> {True, True}, AxesLabel -> {
       FormBox["\"Log # of Points\"", TraditionalForm], 
       FormBox["\"Log of Error\"", TraditionalForm]}, 
     AxesOrigin -> {2.8098443103668878`, 0}, DisplayFunction :> Identity, 
     Frame -> {{False, False}, {False, False}}, 
     FrameLabel -> {{None, None}, {None, None}}, 
     FrameTicks -> {{Automatic, Automatic}, {Automatic, Automatic}}, 
     GridLines -> {None, None}, GridLinesStyle -> Directive[
       GrayLevel[0.5, 0.4]], 
     Method -> {"CoordinatesToolOptions" -> {"DisplayFunction" -> ({
           (Part[{{Identity, Identity}, {Identity, Identity}}, 1, 2][#]& )[
            Part[#, 1]], 
           (Part[{{Identity, Identity}, {Identity, Identity}}, 2, 2][#]& )[
            Part[#, 2]]}& ), "CopiedValueFunction" -> ({
           (Part[{{Identity, Identity}, {Identity, Identity}}, 1, 2][#]& )[
            Part[#, 1]], 
           (Part[{{Identity, Identity}, {Identity, Identity}}, 2, 2][#]& )[
            Part[#, 2]]}& )}}, 
     PlotRange -> {{3., 15.169964136519175`}, {-26.02192099296887, 0}}, 
     PlotRangeClipping -> True, PlotRangePadding -> {{
        Scaled[0.02], 
        Scaled[0.02]}, {
        Scaled[0.05], 
        Scaled[0.02]}}, Ticks -> {Automatic, Automatic}}],FormBox[
    FormBox[
     TemplateBox[{"\"Full\"", "\"Sparse\""}, "PointLegend", 
      DisplayFunction -> (FormBox[
        StyleBox[
         StyleBox[
          PaneBox[
           TagBox[
            GridBox[{{
               TagBox[
                GridBox[{{
                   GraphicsBox[{{}, {
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.462], 
                    RGBColor[0.368417, 0.506779, 0.709798], 
                    AbsoluteThickness[1.6]], {
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.462], 
                    RGBColor[0.368417, 0.506779, 0.709798], 
                    AbsoluteThickness[1.6]], 
                    PointBox[
                    NCache[{
                    Scaled[{
                    Rational[1, 2], 
                    Rational[1, 2]}]}, {
                    Scaled[{0.5, 0.5}]}]]}}}, AspectRatio -> Full, 
                    ImageSize -> {10, 10}, PlotRangePadding -> None, 
                    ImagePadding -> Automatic, 
                    BaselinePosition -> (Scaled[0.1] -> Baseline)], #}, {
                   GraphicsBox[{{}, {
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.462], 
                    RGBColor[0.880722, 0.611041, 0.142051], 
                    AbsoluteThickness[1.6]], {
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.462], 
                    RGBColor[0.880722, 0.611041, 0.142051], 
                    AbsoluteThickness[1.6]], 
                    PointBox[
                    NCache[{
                    Scaled[{
                    Rational[1, 2], 
                    Rational[1, 2]}]}, {
                    Scaled[{0.5, 0.5}]}]]}}}, AspectRatio -> Full, 
                    ImageSize -> {10, 10}, PlotRangePadding -> None, 
                    ImagePadding -> Automatic, 
                    BaselinePosition -> (Scaled[0.1] -> Baseline)], #2}}, 
                 GridBoxAlignment -> {
                  "Columns" -> {Center, Left}, "Rows" -> {{Baseline}}}, 
                 AutoDelete -> False, 
                 GridBoxDividers -> {
                  "Columns" -> {{False}}, "Rows" -> {{False}}}, 
                 GridBoxItemSize -> {"Columns" -> {{All}}, "Rows" -> {{All}}},
                  GridBoxSpacings -> {
                  "Columns" -> {{0.5}}, "Rows" -> {{0.8}}}], "Grid"]}}, 
             GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
             AutoDelete -> False, 
             GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{1}}, "Rows" -> {{0}}}], 
            "Grid"], Alignment -> Left, AppearanceElements -> None, 
           ImageMargins -> {{5, 5}, {5, 5}}, ImageSizeAction -> 
           "ResizeToFit"], LineIndent -> 0, StripOnInput -> False], {
         FontFamily -> "Arial"}, Background -> Automatic, StripOnInput -> 
         False], TraditionalForm]& ), 
      InterpretationFunction :> (RowBox[{"PointLegend", "[", 
         RowBox[{
           RowBox[{"{", 
             RowBox[{
               RowBox[{"Directive", "[", 
                 RowBox[{
                   RowBox[{"PointSize", "[", "0.012833333333333334`", "]"}], 
                   ",", 
                   InterpretationBox[
                    ButtonBox[
                    TooltipBox[
                    GraphicsBox[{{
                    GrayLevel[0], 
                    RectangleBox[{0, 0}]}, {
                    GrayLevel[0], 
                    RectangleBox[{1, -1}]}, {
                    RGBColor[0.368417, 0.506779, 0.709798], 
                    RectangleBox[{0, -1}, {2, 1}]}}, AspectRatio -> 1, Frame -> 
                    True, FrameStyle -> 
                    RGBColor[
                    0.24561133333333335`, 0.3378526666666667, 
                    0.4731986666666667], FrameTicks -> None, PlotRangePadding -> 
                    None, ImageSize -> 
                    Dynamic[{
                    Automatic, 1.35 CurrentValue["FontCapHeight"]/
                    AbsoluteCurrentValue[Magnification]}]], 
                    "RGBColor[0.368417, 0.506779, 0.709798]"], Appearance -> 
                    None, BaseStyle -> {}, BaselinePosition -> Baseline, 
                    DefaultBaseStyle -> {}, ButtonFunction :> 
                    With[{Typeset`box$ = EvaluationBox[]}, 
                    If[
                    Not[
                    AbsoluteCurrentValue["Deployed"]], 
                    SelectionMove[Typeset`box$, All, Expression]; 
                    FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
                    FrontEnd`Private`$ColorSelectorInitialColor = 
                    RGBColor[0.368417, 0.506779, 0.709798]; 
                    FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
                    MathLink`CallFrontEnd[
                    FrontEnd`AttachCell[Typeset`box$, 
                    FrontEndResource["RGBColorValueSelector"], {
                    0, {Left, Bottom}}, {Left, Top}, 
                    "ClosingActions" -> {
                    "SelectionDeparture", "ParentChanged", 
                    "EvaluatorQuit"}]]]], BaseStyle -> Inherited, Evaluator -> 
                    Automatic, Method -> "Preemptive"], 
                    RGBColor[0.368417, 0.506779, 0.709798], Editable -> False,
                     Selectable -> False], ",", 
                   RowBox[{"AbsoluteThickness", "[", "1.6`", "]"}]}], "]"}], 
               ",", 
               RowBox[{"Directive", "[", 
                 RowBox[{
                   RowBox[{"PointSize", "[", "0.012833333333333334`", "]"}], 
                   ",", 
                   InterpretationBox[
                    ButtonBox[
                    TooltipBox[
                    GraphicsBox[{{
                    GrayLevel[0], 
                    RectangleBox[{0, 0}]}, {
                    GrayLevel[0], 
                    RectangleBox[{1, -1}]}, {
                    RGBColor[0.880722, 0.611041, 0.142051], 
                    RectangleBox[{0, -1}, {2, 1}]}}, AspectRatio -> 1, Frame -> 
                    True, FrameStyle -> 
                    RGBColor[
                    0.587148, 0.40736066666666665`, 0.09470066666666668], 
                    FrameTicks -> None, PlotRangePadding -> None, ImageSize -> 
                    Dynamic[{
                    Automatic, 1.35 CurrentValue["FontCapHeight"]/
                    AbsoluteCurrentValue[Magnification]}]], 
                    "RGBColor[0.880722, 0.611041, 0.142051]"], Appearance -> 
                    None, BaseStyle -> {}, BaselinePosition -> Baseline, 
                    DefaultBaseStyle -> {}, ButtonFunction :> 
                    With[{Typeset`box$ = EvaluationBox[]}, 
                    If[
                    Not[
                    AbsoluteCurrentValue["Deployed"]], 
                    SelectionMove[Typeset`box$, All, Expression]; 
                    FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
                    FrontEnd`Private`$ColorSelectorInitialColor = 
                    RGBColor[0.880722, 0.611041, 0.142051]; 
                    FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
                    MathLink`CallFrontEnd[
                    FrontEnd`AttachCell[Typeset`box$, 
                    FrontEndResource["RGBColorValueSelector"], {
                    0, {Left, Bottom}}, {Left, Top}, 
                    "ClosingActions" -> {
                    "SelectionDeparture", "ParentChanged", 
                    "EvaluatorQuit"}]]]], BaseStyle -> Inherited, Evaluator -> 
                    Automatic, Method -> "Preemptive"], 
                    RGBColor[0.880722, 0.611041, 0.142051], Editable -> False,
                     Selectable -> False], ",", 
                   RowBox[{"AbsoluteThickness", "[", "1.6`", "]"}]}], "]"}]}],
              "}"}], ",", 
           RowBox[{"{", 
             RowBox[{#, ",", #2}], "}"}], ",", 
           RowBox[{"LegendMarkers", "\[Rule]", 
             RowBox[{"{", 
               RowBox[{
                 RowBox[{"{", 
                   RowBox[{"False", ",", "Automatic"}], "}"}], ",", 
                 RowBox[{"{", 
                   RowBox[{"False", ",", "Automatic"}], "}"}]}], "}"}]}], ",", 
           RowBox[{"Joined", "\[Rule]", 
             RowBox[{"{", 
               RowBox[{"False", ",", "False"}], "}"}]}], ",", 
           RowBox[{"LabelStyle", "\[Rule]", 
             RowBox[{"{", "}"}]}], ",", 
           RowBox[{"LegendLayout", "\[Rule]", "\"Column\""}]}], "]"}]& ), 
      Editable -> True], TraditionalForm], TraditionalForm]},
  "Legended",
  DisplayFunction->(GridBox[{{
      TagBox[
       ItemBox[
        PaneBox[
         TagBox[#, "SkipImageSizeLevel"], Alignment -> {Center, Baseline}, 
         BaselinePosition -> Baseline], DefaultBaseStyle -> "Labeled"], 
       "SkipImageSizeLevel"], 
      ItemBox[#2, DefaultBaseStyle -> "LabeledLabel"]}}, 
    GridBoxAlignment -> {"Columns" -> {{Center}}, "Rows" -> {{Center}}}, 
    AutoDelete -> False, GridBoxItemSize -> Automatic, 
    BaselinePosition -> {1, 1}]& ),
  Editable->True,
  InterpretationFunction->(RowBox[{"Legended", "[", 
     RowBox[{#, ",", 
       RowBox[{"Placed", "[", 
         RowBox[{#2, ",", "After"}], "]"}]}], "]"}]& )]], "Output",
 CellChangeTimes->{
  3.673874763270137*^9, 3.673874824437995*^9, 3.6738748683601437`*^9, {
   3.673874923518271*^9, 3.6738749363738537`*^9}, 3.6738751972838297`*^9, 
   3.673875423922831*^9, {3.673881035311944*^9, 3.6738810637322598`*^9}, 
   3.673881367218585*^9, 3.6738814674718733`*^9, {3.67388175834542*^9, 
   3.673881780359544*^9}, 3.673881818412662*^9, 3.673881917592783*^9, {
   3.674305393341578*^9, 3.674305421424129*^9}, {3.674305460089465*^9, 
   3.674305486015862*^9}, 3.67430595844532*^9, 3.6743061665089407`*^9, 
   3.6743063628651733`*^9, 3.674306534093334*^9, {3.6743066429904013`*^9, 
   3.674306659721241*^9}, 3.674306749799797*^9, 3.674306821373551*^9, 
   3.674307832527443*^9, 3.674308203558638*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Table", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"Length", "[", 
       RowBox[{"Flatten", "[", 
        RowBox[{"sparseCoefficients2D", "[", 
         RowBox[{"test2D", ",", "n"}], "]"}], "]"}], "]"}], "//", "Log2"}], 
     ",", 
     RowBox[{
      RowBox[{"sparseError2", "[", 
       RowBox[{"[", "n", "]"}], "]"}], "//", "Log2"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"n", ",", "7", ",", "9"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.674306004224854*^9, 3.674306004637857*^9}, {
  3.6743065435043583`*^9, 3.674306546837933*^9}, {3.6743066654966087`*^9, 
  3.6743066665633297`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     FractionBox[
      RowBox[{"Log", "[", "833", "]"}], 
      RowBox[{"Log", "[", "2", "]"}]], ",", 
     RowBox[{"-", "16.444553351256868`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     FractionBox[
      RowBox[{"Log", "[", "1793", "]"}], 
      RowBox[{"Log", "[", "2", "]"}]], ",", 
     RowBox[{"-", "18.34980942814796`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     FractionBox[
      RowBox[{"Log", "[", "3841", "]"}], 
      RowBox[{"Log", "[", "2", "]"}]], ",", 
     RowBox[{"-", "20.260192585320517`"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.6743059795475388`*^9, 3.674306004994854*^9}, 
   3.67430654718829*^9, 3.674306667298057*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Table", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"Length", "[", 
       RowBox[{"Flatten", "[", 
        RowBox[{"fullCoefficients2D", "[", 
         RowBox[{"test2D", ",", "n", ",", "n"}], "]"}], "]"}], "]"}], "//", 
      "Log2"}], ",", 
     RowBox[{
      RowBox[{"fullError", "[", 
       RowBox[{"[", "n", "]"}], "]"}], "//", "Log2"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"n", ",", "5", ",", "7"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{
  3.674306037786026*^9, {3.674306181878518*^9, 3.6743061915710497`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     FractionBox[
      RowBox[{"Log", "[", "1089", "]"}], 
      RowBox[{"Log", "[", "2", "]"}]], ",", 
     RowBox[{"-", "13.26485900220238`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     FractionBox[
      RowBox[{"Log", "[", "4225", "]"}], 
      RowBox[{"Log", "[", "2", "]"}]], ",", 
     RowBox[{"-", "15.264659341534921`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     FractionBox[
      RowBox[{"Log", "[", "16641", "]"}], 
      RowBox[{"Log", "[", "2", "]"}]], ",", 
     RowBox[{"-", "17.264659781671057`"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.674306039799231*^9, {3.674306174609466*^9, 3.6743061934053183`*^9}, 
   3.67430637255726*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"fullLengths", "=", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Length", "[", 
      RowBox[{"Flatten", "[", 
       RowBox[{"fullCoefficients2D", "[", 
        RowBox[{"test2D", ",", "n", ",", "n"}], "]"}], "]"}], "]"}], " ", "//",
      "Log2"}], ",", 
    RowBox[{"{", 
     RowBox[{"n", ",", "1", ",", "7"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.674307236918026*^9, 3.674307246605598*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   FractionBox[
    RowBox[{"Log", "[", "9", "]"}], 
    RowBox[{"Log", "[", "2", "]"}]], ",", 
   FractionBox[
    RowBox[{"Log", "[", "25", "]"}], 
    RowBox[{"Log", "[", "2", "]"}]], ",", 
   FractionBox[
    RowBox[{"Log", "[", "81", "]"}], 
    RowBox[{"Log", "[", "2", "]"}]], ",", 
   FractionBox[
    RowBox[{"Log", "[", "289", "]"}], 
    RowBox[{"Log", "[", "2", "]"}]], ",", 
   FractionBox[
    RowBox[{"Log", "[", "1089", "]"}], 
    RowBox[{"Log", "[", "2", "]"}]], ",", 
   FractionBox[
    RowBox[{"Log", "[", "4225", "]"}], 
    RowBox[{"Log", "[", "2", "]"}]], ",", 
   FractionBox[
    RowBox[{"Log", "[", "16641", "]"}], 
    RowBox[{"Log", "[", "2", "]"}]]}], "}"}]], "Output",
 CellChangeTimes->{3.6743072486993427`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"sparseLengths", "=", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Length", "[", 
      RowBox[{"Flatten", "[", 
       RowBox[{"sparseCoefficients2D", "[", 
        RowBox[{"test2D", ",", "n"}], "]"}], "]"}], "]"}], " ", "//", 
     "Log2"}], ",", 
    RowBox[{"{", 
     RowBox[{"n", ",", "1", ",", "12"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.674307256710492*^9, 3.674307272571846*^9}, 
   3.67430781771422*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"3", ",", 
   FractionBox[
    RowBox[{"Log", "[", "17", "]"}], 
    RowBox[{"Log", "[", "2", "]"}]], ",", 
   FractionBox[
    RowBox[{"Log", "[", "37", "]"}], 
    RowBox[{"Log", "[", "2", "]"}]], ",", 
   FractionBox[
    RowBox[{"Log", "[", "81", "]"}], 
    RowBox[{"Log", "[", "2", "]"}]], ",", 
   FractionBox[
    RowBox[{"Log", "[", "177", "]"}], 
    RowBox[{"Log", "[", "2", "]"}]], ",", 
   FractionBox[
    RowBox[{"Log", "[", "385", "]"}], 
    RowBox[{"Log", "[", "2", "]"}]], ",", 
   FractionBox[
    RowBox[{"Log", "[", "833", "]"}], 
    RowBox[{"Log", "[", "2", "]"}]], ",", 
   FractionBox[
    RowBox[{"Log", "[", "1793", "]"}], 
    RowBox[{"Log", "[", "2", "]"}]], ",", 
   FractionBox[
    RowBox[{"Log", "[", "3841", "]"}], 
    RowBox[{"Log", "[", "2", "]"}]], ",", 
   FractionBox[
    RowBox[{"Log", "[", "8193", "]"}], 
    RowBox[{"Log", "[", "2", "]"}]], ",", 
   FractionBox[
    RowBox[{"Log", "[", "17409", "]"}], 
    RowBox[{"Log", "[", "2", "]"}]], ",", 
   FractionBox[
    RowBox[{"Log", "[", "36865", "]"}], 
    RowBox[{"Log", "[", "2", "]"}]]}], "}"}]], "Output",
 CellChangeTimes->{{3.6743072645583763`*^9, 3.6743072749926777`*^9}, 
   3.674307822729604*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Show", "[", 
  RowBox[{
   RowBox[{"ListPlot", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"sparseLengths", "[", 
             RowBox[{"[", "n", "]"}], "]"}], ",", 
            RowBox[{"-", 
             FractionBox[
              RowBox[{
               RowBox[{"Log2", "[", 
                RowBox[{"sparseError2", "[", 
                 RowBox[{"[", "n", "]"}], "]"}], "]"}], "-", 
               RowBox[{"Log2", "[", 
                RowBox[{"sparseError2", "[", 
                 RowBox[{"[", 
                  RowBox[{"n", "-", "1"}], "]"}], "]"}], "]"}]}], 
              RowBox[{
               RowBox[{"sparseLengths", "[", 
                RowBox[{"[", "n", "]"}], "]"}], "-", 
               RowBox[{"sparseLengths", "[", 
                RowBox[{"[", 
                 RowBox[{"n", "-", "1"}], "]"}], "]"}]}]]}]}], " ", "}"}], "//",
           "N"}], ",", 
         RowBox[{"{", 
          RowBox[{"n", ",", "4", ",", "12"}], "}"}]}], "]"}], ",", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"fullLengths", "[", 
             RowBox[{"[", "n", "]"}], "]"}], ",", 
            RowBox[{"-", 
             FractionBox[
              RowBox[{
               RowBox[{"Log2", "[", 
                RowBox[{"fullError", "[", 
                 RowBox[{"[", "n", "]"}], "]"}], "]"}], "-", 
               RowBox[{"Log2", "[", 
                RowBox[{"fullError", "[", 
                 RowBox[{"[", 
                  RowBox[{"n", "-", "1"}], "]"}], "]"}], "]"}]}], 
              RowBox[{
               RowBox[{"fullLengths", "[", 
                RowBox[{"[", "n", "]"}], "]"}], "-", 
               RowBox[{"fullLengths", "[", 
                RowBox[{"[", 
                 RowBox[{"n", "-", "1"}], "]"}], "]"}]}]]}]}], " ", "}"}], "//",
           "N"}], ",", 
         RowBox[{"{", 
          RowBox[{"n", ",", "4", ",", "7"}], "}"}]}], "]"}]}], "}"}], ",", 
     RowBox[{"PlotRange", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{".9", ",", "2"}], "}"}]}]}], "]"}], ",", 
   RowBox[{"Graphics", "[", 
    RowBox[{"{", 
     RowBox[{"Dashed", ",", 
      RowBox[{"Darker", "[", "Yellow", "]"}], ",", 
      RowBox[{"Line", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "1"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"20", ",", "1"}], "}"}]}], "}"}], "]"}], ",", 
      RowBox[{"Darker", "[", "Blue", "]"}], ",", 
      RowBox[{"Line", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "2"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"20", ",", "2"}], "}"}]}], "}"}], "]"}]}], "}"}], "]"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.67430682834305*^9, 3.67430700951998*^9}, {
   3.67430708322959*^9, 3.674307088596096*^9}, {3.674307128659267*^9, 
   3.674307221578635*^9}, {3.674307270839426*^9, 3.674307359002982*^9}, {
   3.67430741256633*^9, 3.6743074457213306`*^9}, {3.6743074789581413`*^9, 
   3.674307499911622*^9}, {3.67430774036066*^9, 3.6743077426996307`*^9}, {
   3.674307785335682*^9, 3.674307786983926*^9}, 3.674307840196639*^9}],

Cell[BoxData[
 GraphicsBox[{{{}, {{}, 
     {RGBColor[0.368417, 0.506779, 0.709798], PointSize[
      0.012833333333333334`], AbsoluteThickness[1.6], 
      PointBox[{{6.339850002884625, 1.6561075299968213`}, {7.467605550082997, 
       1.6691597347693163`}, {8.588714635582264, 1.6859385610650977`}, {
       9.702172685365548, 1.703586924243772}, {10.808159772868375`, 
       1.7226747928792814`}, {11.907266248531064`, 1.73812383010547}, {
       13.000176099486444`, 1.7530457581675736`}, {14.087545714274512`, 
       1.7650789906859468`}, {15.169964136519175`, 1.7798238902878925`}}]}, 
     {RGBColor[0.880722, 0.611041, 0.142051], PointSize[
      0.012833333333333334`], AbsoluteThickness[1.6], 
      PointBox[{{8.174925682500678, 1.0875975803291829`}, {
       10.088788238716907`, 1.0448087800871064`}, {12.044735626056909`, 
       1.0224203126711793`}, {14.022454510846508`, 
       1.0112662904308096`}}]}, {}}, {}}, 
   {RGBColor[
     NCache[
      Rational[2, 3], 0.6666666666666666], 
     NCache[
      Rational[2, 3], 0.6666666666666666], 0], Dashing[{Small, Small}], 
    LineBox[{{0, 1}, {20, 1}}], 
    {RGBColor[0, 0, 
      NCache[
       Rational[2, 3], 0.6666666666666666]], LineBox[{{0, 2}, {20, 2}}]}}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{True, True},
  AxesLabel->{None, None},
  AxesOrigin->{6.2018794695465855`, 0.9055},
  DisplayFunction->Identity,
  Frame->{{False, False}, {False, False}},
  FrameLabel->{{None, None}, {None, None}},
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  ImagePadding->All,
  Method->{"CoordinatesToolOptions" -> {"DisplayFunction" -> ({
        (Part[{{Identity, Identity}, {Identity, Identity}}, 1, 2][#]& )[
         Part[#, 1]], 
        (Part[{{Identity, Identity}, {Identity, Identity}}, 2, 2][#]& )[
         Part[#, 2]]}& ), "CopiedValueFunction" -> ({
        (Part[{{Identity, Identity}, {Identity, Identity}}, 1, 2][#]& )[
         Part[#, 1]], 
        (Part[{{Identity, Identity}, {Identity, Identity}}, 2, 2][#]& )[
         Part[#, 2]]}& )}},
  PlotRange->{{6.339850002884625, 15.169964136519175`}, {0.9, 2}},
  PlotRangeClipping->True,
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {0, 0}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{
  3.674306899884516*^9, 3.674307015112903*^9, 3.6743070942335043`*^9, 
   3.674307199026751*^9, {3.674307297431066*^9, 3.6743073594042053`*^9}, {
   3.674307428278639*^9, 3.674307446631064*^9}, {3.6743074797998123`*^9, 
   3.674307500326639*^9}, 3.674307743473061*^9, 3.674307787204156*^9, 
   3.674307840709936*^9, 3.674308206850152*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Show", "[", 
  RowBox[{
   RowBox[{"ListPlot", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"sparseLengths", "[", 
            RowBox[{"[", "n", "]"}], "]"}], ",", 
           RowBox[{"-", 
            FractionBox[
             RowBox[{
              RowBox[{"Log2", "[", 
               RowBox[{"sparseError2", "[", 
                RowBox[{"[", "n", "]"}], "]"}], "]"}], "-", 
              RowBox[{"Log2", "[", 
               RowBox[{"sparseError2", "[", 
                RowBox[{"[", 
                 RowBox[{"n", "-", "1"}], "]"}], "]"}], "]"}]}], 
             RowBox[{
              RowBox[{"sparseLengths", "[", 
               RowBox[{"[", "n", "]"}], "]"}], "-", 
              RowBox[{"sparseLengths", "[", 
               RowBox[{"[", 
                RowBox[{"n", "-", "1"}], "]"}], "]"}]}]]}]}], " ", "}"}], "//",
          "N"}], ",", 
        RowBox[{"{", 
         RowBox[{"n", ",", "4", ",", "12"}], "}"}]}], "]"}], "}"}], ",", 
     RowBox[{"PlotRange", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"1.6", ",", "2"}], "}"}]}]}], "]"}], ",", 
   RowBox[{"Graphics", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Darker", "[", "Blue", "]"}], ",", 
      RowBox[{"Line", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "2"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"20", ",", "2"}], "}"}]}], "}"}], "]"}]}], "}"}], "]"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.6743077560121727`*^9, 3.674307774118087*^9}, 
   3.674307848047091*^9}],

Cell[BoxData[
 GraphicsBox[{{{}, {{}, 
     {RGBColor[0.368417, 0.506779, 0.709798], PointSize[
      0.012833333333333334`], AbsoluteThickness[1.6], 
      PointBox[{{6.339850002884625, 1.6561075299968213`}, {7.467605550082997, 
       1.6691597347693163`}, {8.588714635582264, 1.6859385610650977`}, {
       9.702172685365548, 1.703586924243772}, {10.808159772868375`, 
       1.7226747928792814`}, {11.907266248531064`, 1.73812383010547}, {
       13.000176099486444`, 1.7530457581675736`}, {14.087545714274512`, 
       1.7650789906859468`}, {15.169964136519175`, 
       1.7798238902878925`}}]}, {}}, {}}, 
   {RGBColor[0, 0, 
     NCache[
      Rational[2, 3], 0.6666666666666666]], LineBox[{{0, 2}, {20, 2}}]}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{True, True},
  AxesLabel->{None, None},
  AxesOrigin->{6.2018794695465855`, 1.602},
  DisplayFunction->Identity,
  Frame->{{False, False}, {False, False}},
  FrameLabel->{{None, None}, {None, None}},
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  ImagePadding->All,
  Method->{"CoordinatesToolOptions" -> {"DisplayFunction" -> ({
        (Part[{{Identity, Identity}, {Identity, Identity}}, 1, 2][#]& )[
         Part[#, 1]], 
        (Part[{{Identity, Identity}, {Identity, Identity}}, 2, 2][#]& )[
         Part[#, 2]]}& ), "CopiedValueFunction" -> ({
        (Part[{{Identity, Identity}, {Identity, Identity}}, 1, 2][#]& )[
         Part[#, 1]], 
        (Part[{{Identity, Identity}, {Identity, Identity}}, 2, 2][#]& )[
         Part[#, 2]]}& )}},
  PlotRange->{{6.339850002884625, 15.169964136519175`}, {1.6, 2}},
  PlotRangeClipping->True,
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {0, 0}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{{3.674307769303781*^9, 3.6743077743241997`*^9}, 
   3.674307848514991*^9, 3.67430820917752*^9}]
}, Open  ]],

Cell["\<\
This plot makes it seem uncertain whether the sparse error is tending to a \
slope of -2. It\[CloseCurlyQuote]s more clear once we approximate the length \
O(n + log n) as O(n), and note that then the differences in lengths are 1 \
instead of 1 + log(n/(n-1). The trend clearer here:\
\>", "Text",
 CellChangeTimes->{{3.674307599724414*^9, 3.674307695289173*^9}, {
  3.6743077289165792`*^9, 3.674307730895854*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ListPlot", "[", 
  RowBox[{
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Log2", "[", 
         RowBox[{"sparseError2", "[", 
          RowBox[{"[", "n", "]"}], "]"}], "]"}], "-", 
        RowBox[{"Log2", "[", 
         RowBox[{"sparseError2", "[", 
          RowBox[{"[", 
           RowBox[{"n", "-", "1"}], "]"}], "]"}], "]"}]}], ")"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"n", ",", "2", ",", "12"}], "}"}]}], "]"}], ",", 
   RowBox[{"PlotRange", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"1.8", ",", "2"}], "}"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.6743070533524437`*^9, 3.674307073891605*^9}, {
  3.674307698769095*^9, 3.674307708942135*^9}, {3.6743078590058804`*^9, 
  3.674307859864678*^9}}],

Cell[BoxData[
 GraphicsBox[{{}, {{}, 
    {RGBColor[0.368417, 0.506779, 0.709798], PointSize[0.012833333333333334`],
      AbsoluteThickness[1.6], 
     PointBox[{{1., 1.8341741095587976`}, {2., 1.858780189922828}, {3., 
      1.8720583828422104`}, {4., 1.8824041500462592`}, {5., 
      1.8901210384036418`}, {6., 1.8968725743047745`}, {7., 
      1.9052560768910922`}, {8., 1.9103831571725571`}, {9., 
      1.9159209782768833`}, {10., 1.9192932621726904`}, {11., 
      1.9265141671987784`}}]}, {}}, {}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{True, True},
  AxesLabel->{None, None},
  AxesOrigin->{0., 1.801},
  DisplayFunction->Identity,
  Frame->{{False, False}, {False, False}},
  FrameLabel->{{None, None}, {None, None}},
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  ImagePadding->All,
  Method->{"CoordinatesToolOptions" -> {"DisplayFunction" -> ({
        (Part[{{Identity, Identity}, {Identity, Identity}}, 1, 2][#]& )[
         Part[#, 1]], 
        (Part[{{Identity, Identity}, {Identity, Identity}}, 2, 2][#]& )[
         Part[#, 2]]}& ), "CopiedValueFunction" -> ({
        (Part[{{Identity, Identity}, {Identity, Identity}}, 1, 2][#]& )[
         Part[#, 1]], 
        (Part[{{Identity, Identity}, {Identity, Identity}}, 2, 2][#]& )[
         Part[#, 2]]}& )}},
  PlotRange->{{0., 11.}, {1.8, 2}},
  PlotRangeClipping->True,
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {0, 0}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{{3.6743070657499733`*^9, 3.674307074790512*^9}, {
   3.6743077043272953`*^9, 3.674307709197504*^9}, 3.6743078602236567`*^9, 
   3.674308212684724*^9}]
}, Open  ]]
}, Open  ]]
},
WindowSize->{808, 651},
WindowMargins->{{28, Automatic}, {36, Automatic}},
FrontEndVersion->"10.4 for Mac OS X x86 (32-bit, 64-bit Kernel) (February 25, \
2016)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 110, 1, 44, "Subsection"],
Cell[693, 25, 8901, 229, 441, "Input"],
Cell[9597, 256, 229, 6, 28, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[9863, 267, 176, 2, 44, "Subsection"],
Cell[10042, 271, 2290, 59, 127, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[12369, 335, 146, 2, 44, "Subsection"],
Cell[12518, 339, 10213, 229, 448, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[22768, 573, 100, 1, 44, "Subsection"],
Cell[22871, 576, 8142, 187, 402, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[31050, 768, 154, 2, 44, "Subsection"],
Cell[31207, 772, 7427, 225, 373, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[38671, 1002, 267, 3, 44, "Subsection"],
Cell[38941, 1007, 8335, 218, 568, "Input"],
Cell[47279, 1227, 2080, 56, 141, "Input"],
Cell[CellGroupData[{
Cell[49384, 1287, 481, 13, 28, "Input"],
Cell[49868, 1302, 1173, 18, 80, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[51078, 1325, 756, 18, 46, "Input"],
Cell[51837, 1345, 3453, 61, 374, "Output"]
}, Open  ]],
Cell[55305, 1409, 94, 1, 28, "Input"],
Cell[CellGroupData[{
Cell[55424, 1414, 1282, 35, 80, "Input"],
Cell[56709, 1451, 361, 8, 57, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[57107, 1464, 790, 14, 63, "Input"],
Cell[57900, 1480, 408, 9, 57, "Output"]
}, Open  ]],
Cell[58323, 1492, 985, 28, 78, "Input"],
Cell[CellGroupData[{
Cell[59333, 1524, 887, 16, 80, InheritFromParent],
Cell[60223, 1542, 642, 12, 57, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[60902, 1559, 1182, 29, 56, "Input"],
Cell[62087, 1590, 303, 4, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[62427, 1599, 934, 27, 56, "Input"],
Cell[63364, 1628, 213, 3, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[63614, 1636, 692, 13, 63, "Input"],
Cell[64309, 1651, 510, 9, 57, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[64856, 1665, 1238, 33, 58, "Input"],
Cell[66097, 1700, 237, 4, 28, "Output"]
}, Open  ]],
Cell[66349, 1707, 231, 6, 28, "Input"],
Cell[CellGroupData[{
Cell[66605, 1717, 1704, 43, 80, "Input"],
Cell[68312, 1762, 13707, 281, 195, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[82056, 2048, 660, 18, 46, "Input"],
Cell[82719, 2068, 745, 22, 50, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[83501, 2095, 589, 17, 46, "Input"],
Cell[84093, 2114, 750, 23, 50, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[84880, 2142, 450, 12, 28, "Input"],
Cell[85333, 2156, 783, 24, 50, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[86153, 2185, 470, 13, 46, "Input"],
Cell[86626, 2200, 1241, 37, 91, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[87904, 2242, 3323, 87, 252, "Input"],
Cell[91230, 2331, 2726, 57, 250, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[93993, 2393, 1666, 48, 165, "Input"],
Cell[95662, 2443, 1965, 42, 246, "Output"]
}, Open  ]],
Cell[97642, 2488, 424, 7, 68, "Text"],
Cell[CellGroupData[{
Cell[98091, 2499, 801, 22, 46, "Input"],
Cell[98895, 2523, 1761, 39, 284, "Output"]
}, Open  ]]
}, Open  ]]
}
]
*)

