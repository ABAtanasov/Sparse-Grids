(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.4' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    114678,       2703]
NotebookOptionsPosition[    111491,       2593]
NotebookOutlinePosition[    111848,       2609]
CellTagsIndexPosition[    111805,       2606]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{"NotebookEvaluate", "[", "\[IndentingNewLine]", 
  "\"\<~/Documents/Sparse\\ Grids/Checking\\ SBP/Methods\\ and\\ Functions\\ \
for\\ SBP.nb\>\"", "]"}]], "Input",
 CellChangeTimes->{{3.673957641061926*^9, 3.673957757652383*^9}, {
   3.6743888033693037`*^9, 3.6743888040997467`*^9}, 3.67457147048592*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ListPlot", "[", 
  RowBox[{
   RowBox[{"Flatten", "[", 
    RowBox[{
     RowBox[{"makeSparse", "[", "2", "]"}], ",", "3"}], "]"}], ",", 
   RowBox[{"AspectRatio", "\[Rule]", "1"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.6741854141993227`*^9, 3.674185440287519*^9}, 
   3.674186286677113*^9, {3.674186555611705*^9, 3.6741865770868673`*^9}, {
   3.674186661074711*^9, 3.674186674855205*^9}, {3.674210407351513*^9, 
   3.67421046561594*^9}, {3.674210924717204*^9, 3.674210932749158*^9}, {
   3.674311932406857*^9, 3.674311974657675*^9}, {3.674313200051835*^9, 
   3.67431320377894*^9}, 3.674313998582395*^9, {3.6743888084461117`*^9, 
   3.674388809070002*^9}}],

Cell[BoxData[
 GraphicsBox[{{}, {{}, 
    {RGBColor[0.368417, 0.506779, 0.709798], PointSize[0.012833333333333334`],
      AbsoluteThickness[1.6], 
     PointBox[{{0., 0.}, {0., 1.}, {1., 1.}, {1., 0.}, {0., 0.5}, {1., 0.5}, {
      0.5, 1.}, {0.5, 0.}, {0., 0.25}, {0., 0.75}, {1., 0.25}, {1., 0.75}, {
      0.5, 0.5}, {0.25, 1.}, {0.75, 1.}, {0.25, 0.}, {0.75, 0.}}]}, {}}, {}},
  AspectRatio->1,
  Axes->{True, True},
  AxesLabel->{None, None},
  AxesOrigin->{0, 0},
  DisplayFunction->Identity,
  Frame->{{False, False}, {False, False}},
  FrameLabel->{{None, None}, {None, None}},
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  ImagePadding->All,
  Method->{"CoordinatesToolOptions" -> {"DisplayFunction" -> ({
        (Part[{{Identity, Identity}, {Identity, Identity}}, 1, 2][#]& )[
         Part[#, 1]], 
        (Part[{{Identity, Identity}, {Identity, Identity}}, 2, 2][#]& )[
         Part[#, 2]]}& ), "CopiedValueFunction" -> ({
        (Part[{{Identity, Identity}, {Identity, Identity}}, 1, 2][#]& )[
         Part[#, 1]], 
        (Part[{{Identity, Identity}, {Identity, Identity}}, 2, 2][#]& )[
         Part[#, 2]]}& )}},
  PlotRange->{{0, 1.}, {0, 1.}},
  PlotRangeClipping->True,
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {
     Scaled[0.02], 
     Scaled[0.05]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{
  3.674210466444972*^9, {3.674210925387699*^9, 3.674210933758114*^9}, 
   3.674215419258349*^9, {3.6743119205633802`*^9, 3.674311974871004*^9}, {
   3.6743132003025837`*^9, 3.674313204049065*^9}, 3.674313998823415*^9, 
   3.674388809551668*^9, 3.6745714728338003`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Finding the weights and then integrating", "Subsection",
 CellChangeTimes->{{3.673277052290266*^9, 3.673277061302971*^9}, {
  3.673277119209675*^9, 3.6732771212386723`*^9}, {3.673348508736053*^9, 
  3.673348513701818*^9}, {3.6737269924034224`*^9, 3.6737269925381393`*^9}, {
  3.6739173803011847`*^9, 3.6739173831779957`*^9}, {3.673976589259214*^9, 
  3.673976594082218*^9}, {3.674247233372534*^9, 3.674247236814432*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"Worth", " ", 
   RowBox[{"noting", ":", " ", 
    RowBox[{"it", " ", 
     RowBox[{"isn", "'"}], "t", " ", "necessary", " ", "to", " ", "find", " ",
      "the", " ", "weights", " ", "if", " ", "we", " ", "just", " ", 
     "integrate", " ", "in", " ", "our", " ", "sparse", " ", "coefficient", 
     " ", 
     RowBox[{"space", ".", " ", "This"}], " ", "is", " ", "equivalent", " ", 
     "and", " ", "computationally", " ", 
     RowBox[{"lighter", "."}]}]}]}], " ", "*)"}]], "Input",
 CellChangeTimes->{{3.67431203685369*^9, 3.674312083846321*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"switch3", "[", 
        RowBox[{"kx", ",", "i"}], "]"}], 
       RowBox[{"switch3", "[", 
        RowBox[{"ky", ",", "j"}], "]"}]}], "/.", 
      RowBox[{"kx", "\[Rule]", "3"}]}], "/.", 
     RowBox[{"ky", "\[Rule]", "3"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "0", ",", "8"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"j", ",", "0", ",", "8"}], "}"}]}], "]"}], "//", 
  "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.674210131636984*^9, 3.674210139084852*^9}, {
   3.674210225765791*^9, 3.6742102623055077`*^9}, {3.674210393585724*^9, 
   3.674210404534882*^9}, {3.674210602658564*^9, 3.674210602886882*^9}, 
   3.674212229685669*^9, {3.674212309034522*^9, 3.674212362006608*^9}, {
   3.674212415828302*^9, 3.674212418245373*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      FractionBox["1", "64"], 
      RowBox[{"-", 
       FractionBox["1", "64"]}], 
      FractionBox["1", "64"], 
      RowBox[{"-", 
       FractionBox["1", "64"]}], 
      FractionBox["1", "64"], 
      RowBox[{"-", 
       FractionBox["1", "64"]}], 
      FractionBox["1", "64"], 
      RowBox[{"-", 
       FractionBox["1", "64"]}], 
      FractionBox["1", "64"]},
     {
      RowBox[{"-", 
       FractionBox["1", "64"]}], 
      FractionBox["1", "64"], 
      RowBox[{"-", 
       FractionBox["1", "64"]}], 
      FractionBox["1", "64"], 
      RowBox[{"-", 
       FractionBox["1", "64"]}], 
      FractionBox["1", "64"], 
      RowBox[{"-", 
       FractionBox["1", "64"]}], 
      FractionBox["1", "64"], 
      RowBox[{"-", 
       FractionBox["1", "64"]}]},
     {
      FractionBox["1", "64"], 
      RowBox[{"-", 
       FractionBox["1", "64"]}], 
      FractionBox["1", "64"], 
      RowBox[{"-", 
       FractionBox["1", "64"]}], 
      FractionBox["1", "64"], 
      RowBox[{"-", 
       FractionBox["1", "64"]}], 
      FractionBox["1", "64"], 
      RowBox[{"-", 
       FractionBox["1", "64"]}], 
      FractionBox["1", "64"]},
     {
      RowBox[{"-", 
       FractionBox["1", "64"]}], 
      FractionBox["1", "64"], 
      RowBox[{"-", 
       FractionBox["1", "64"]}], 
      FractionBox["1", "64"], 
      RowBox[{"-", 
       FractionBox["1", "64"]}], 
      FractionBox["1", "64"], 
      RowBox[{"-", 
       FractionBox["1", "64"]}], 
      FractionBox["1", "64"], 
      RowBox[{"-", 
       FractionBox["1", "64"]}]},
     {
      FractionBox["1", "64"], 
      RowBox[{"-", 
       FractionBox["1", "64"]}], 
      FractionBox["1", "64"], 
      RowBox[{"-", 
       FractionBox["1", "64"]}], 
      FractionBox["1", "64"], 
      RowBox[{"-", 
       FractionBox["1", "64"]}], 
      FractionBox["1", "64"], 
      RowBox[{"-", 
       FractionBox["1", "64"]}], 
      FractionBox["1", "64"]},
     {
      RowBox[{"-", 
       FractionBox["1", "64"]}], 
      FractionBox["1", "64"], 
      RowBox[{"-", 
       FractionBox["1", "64"]}], 
      FractionBox["1", "64"], 
      RowBox[{"-", 
       FractionBox["1", "64"]}], 
      FractionBox["1", "64"], 
      RowBox[{"-", 
       FractionBox["1", "64"]}], 
      FractionBox["1", "64"], 
      RowBox[{"-", 
       FractionBox["1", "64"]}]},
     {
      FractionBox["1", "64"], 
      RowBox[{"-", 
       FractionBox["1", "64"]}], 
      FractionBox["1", "64"], 
      RowBox[{"-", 
       FractionBox["1", "64"]}], 
      FractionBox["1", "64"], 
      RowBox[{"-", 
       FractionBox["1", "64"]}], 
      FractionBox["1", "64"], 
      RowBox[{"-", 
       FractionBox["1", "64"]}], 
      FractionBox["1", "64"]},
     {
      RowBox[{"-", 
       FractionBox["1", "64"]}], 
      FractionBox["1", "64"], 
      RowBox[{"-", 
       FractionBox["1", "64"]}], 
      FractionBox["1", "64"], 
      RowBox[{"-", 
       FractionBox["1", "64"]}], 
      FractionBox["1", "64"], 
      RowBox[{"-", 
       FractionBox["1", "64"]}], 
      FractionBox["1", "64"], 
      RowBox[{"-", 
       FractionBox["1", "64"]}]},
     {
      FractionBox["1", "64"], 
      RowBox[{"-", 
       FractionBox["1", "64"]}], 
      FractionBox["1", "64"], 
      RowBox[{"-", 
       FractionBox["1", "64"]}], 
      FractionBox["1", "64"], 
      RowBox[{"-", 
       FractionBox["1", "64"]}], 
      FractionBox["1", "64"], 
      RowBox[{"-", 
       FractionBox["1", "64"]}], 
      FractionBox["1", "64"]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.674210404937331*^9, {3.674212335595639*^9, 3.674212339300922*^9}, 
   3.674212418570814*^9, 3.674215421854609*^9, 3.674247294563992*^9, 
   3.6743119375380096`*^9, 3.674571476570112*^9}]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"showFullWeights", "[", 
    RowBox[{"lx_", ",", "ly_"}], "]"}], ":=", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"weights1D", "[", 
         RowBox[{"i", ",", "kx", ",", "lx"}], "]"}], " ", 
        RowBox[{"weights1D", "[", 
         RowBox[{"j", ",", "ky", ",", "ly"}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "0", ",", 
         SuperscriptBox["2", "lx"]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "0", ",", 
         SuperscriptBox["2", "ly"]}], "}"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"kx", ",", "0", ",", "lx"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"ky", ",", "0", ",", "ly"}], "}"}]}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"showWeights", "[", "n_", "]"}], ":=", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"weights1D", "[", 
           RowBox[{"i", ",", 
            RowBox[{"getrow", "[", 
             RowBox[{"perp", ",", "diag"}], "]"}], ",", "n"}], "]"}], 
          RowBox[{"weights1D", "[", 
           RowBox[{"j", ",", 
            RowBox[{"getcol", "[", 
             RowBox[{"perp", ",", "diag"}], "]"}], ",", "n"}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "0", ",", 
           SuperscriptBox["2", "n"]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "0", ",", 
           SuperscriptBox["2", "n"]}], "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"perp", ",", "0", ",", 
         RowBox[{
          RowBox[{"endperp", "[", "diag", "]"}], "-", "1"}]}], "}"}]}], "]"}],
      ",", 
     RowBox[{"{", 
      RowBox[{"diag", ",", "0", ",", "n"}], "}"}]}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"showWeights", "[", 
   RowBox[{"n_", ",", "i_", ",", "j_"}], "]"}], ":=", 
  RowBox[{"Sum", "[", 
   RowBox[{
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"weights1D", "[", 
        RowBox[{"i", ",", 
         RowBox[{"getrow", "[", 
          RowBox[{"perp", ",", "diag"}], "]"}], ",", "n"}], "]"}], 
       RowBox[{"weights1D", "[", 
        RowBox[{"j", ",", 
         RowBox[{"getcol", "[", 
          RowBox[{"perp", ",", "diag"}], "]"}], ",", "n"}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"perp", ",", "0", ",", 
        RowBox[{
         RowBox[{"endperp", "[", "diag", "]"}], "-", "1"}]}], "}"}]}], "]"}], 
    ",", 
    RowBox[{"{", 
     RowBox[{"diag", ",", "0", ",", "n"}], "}"}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.674212959186309*^9, 3.674213010894856*^9}, {
  3.6742130955292463`*^9, 3.6742131042681503`*^9}, {3.674213634037966*^9, 
  3.674213711623679*^9}, {3.674213754365397*^9, 3.674213783774599*^9}, {
  3.6742139014989977`*^9, 3.6742139871733303`*^9}, {3.674214145516347*^9, 
  3.674214147942408*^9}, {3.674214352140171*^9, 3.674214363832533*^9}, {
  3.674215346088045*^9, 3.674215348790105*^9}, {3.674215528354673*^9, 
  3.674215579048233*^9}, {3.6742156126465273`*^9, 3.674215617679429*^9}, {
  3.674216613075181*^9, 3.674216614893382*^9}, {3.6742171730503607`*^9, 
  3.674217190906061*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"computeSum", "[", "n_", "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"posW", "[", 
        RowBox[{"i", "/", 
         RowBox[{"2", "^", "n"}]}], "]"}], 
       RowBox[{"posW", "[", 
        RowBox[{"j", "/", 
         RowBox[{"2", "^", "n"}]}], "]"}], 
       RowBox[{"#", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{"i", "+", "1"}], ",", 
          RowBox[{"j", "+", "1"}]}], "]"}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "0", ",", 
        RowBox[{"2", "^", "n"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", "0", ",", 
        RowBox[{"2", "^", "n"}]}], "}"}]}], "]"}], "&"}], "@", 
   RowBox[{"showWeights", "[", "n", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.674213002499382*^9, 3.674213073838463*^9}, {
   3.674213107085884*^9, 3.6742131287199783`*^9}, {3.674213609633521*^9, 
   3.6742136101452847`*^9}, {3.674213994156797*^9, 3.6742140114067583`*^9}, {
   3.674214172399877*^9, 3.674214172861906*^9}, {3.6742143684219522`*^9, 
   3.6742143746978283`*^9}, {3.6742144181695013`*^9, 3.674214420676528*^9}, {
   3.674214569720278*^9, 3.674214577434458*^9}, {3.6742148265140247`*^9, 
   3.674214882287836*^9}, {3.674215454514681*^9, 3.6742154548990498`*^9}, {
   3.674215628216836*^9, 3.674215712218191*^9}, {3.674215763741695*^9, 
   3.674215764024597*^9}, {3.674216030932959*^9, 3.674216118597665*^9}, 
   3.674216975299336*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Table", "[", 
  RowBox[{
   RowBox[{"computeSum", "[", "n", "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"n", ",", "0", ",", "6"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.674216120010367*^9, 3.6742161289190607`*^9}, {
  3.6743888292093983`*^9, 3.674388829934353*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1"}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.674216126149612*^9, 3.67421613134554*^9}, 
   3.67424730469333*^9, 3.6743888320533133`*^9, 3.674571483737817*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"weights1D", "[", 
   RowBox[{"i_", ",", "kx_", ",", "lx_"}], "]"}], ":=", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Mod", "[", 
      RowBox[{"i", ",", 
       SuperscriptBox["2", 
        RowBox[{"lx", "-", "kx"}]]}], "]"}], "\[Equal]", "0"}], ",", 
    RowBox[{"switch3", "[", 
     RowBox[{"kx", ",", 
      RowBox[{
       SuperscriptBox["2", 
        RowBox[{"kx", "-", "lx"}]], "i"}]}], "]"}], ",", "0"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.674214215951852*^9, 3.674214236340961*^9}, {
  3.674214267738717*^9, 3.674214293639688*^9}, {3.674214339125592*^9, 
  3.674214342627858*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"showFullWeights", "[", 
  RowBox[{"1", ",", "1"}], "]"}]], "Input",
 CellChangeTimes->{{3.674215596428933*^9, 3.674215600921118*^9}, {
  3.674216602912993*^9, 3.6742166037866077`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     FractionBox["1", "4"], ",", 
     FractionBox["1", "4"], ",", 
     FractionBox["1", "4"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     FractionBox["1", "4"], ",", 
     FractionBox["1", "4"], ",", 
     FractionBox["1", "4"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     FractionBox["1", "4"], ",", 
     FractionBox["1", "4"], ",", 
     FractionBox["1", "4"]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.67421560120735*^9, {3.6742166043062773`*^9, 3.674216617424471*^9}, 
   3.6742473087191887`*^9, 3.674388844343203*^9, 3.674571485801385*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"computeSum2", "[", "n_", "]"}], ":=", 
  RowBox[{"Sum", "[", 
   RowBox[{
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"posW", "[", 
          RowBox[{
           RowBox[{"switch2", "[", 
            RowBox[{"getrow", "[", 
             RowBox[{"perp", ",", "diag"}], "]"}], "]"}], " ", "i"}], "]"}], 
         RowBox[{"posW", "[", 
          RowBox[{
           RowBox[{"switch2", "[", 
            RowBox[{"getcol", "[", 
             RowBox[{"perp", ",", "diag"}], "]"}], "]"}], " ", "j"}], "]"}], 
         " ", 
         RowBox[{"Sum", "[", "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          SuperscriptBox["2", 
           RowBox[{"switch", "[", 
            RowBox[{"getrow", "[", 
             RowBox[{"perp", ",", "diag"}], "]"}], "]"}]], ",", "2"}], "}"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "1", ",", 
          RowBox[{
           SuperscriptBox["2", 
            RowBox[{"switch", "[", 
             RowBox[{"getcol", "[", 
              RowBox[{"perp", ",", "diag"}], "]"}], "]"}]], "-", "1"}], ",", 
          "2"}], "}"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"perp", ",", 
        RowBox[{"-", "1"}], ",", 
        RowBox[{"endperp", "[", "diag", "]"}]}], "}"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"diag", ",", 
      RowBox[{"-", "1"}], ",", "n"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.6742169781811666`*^9, 3.674216982737797*^9}, {
  3.6742170486259727`*^9, 3.674217073679244*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"SparsetoPosition", "[", 
   RowBox[{"coefficients_", ",", "n_"}], "]"}], ":=", 
  RowBox[{"standardCoefficients2D", "[", 
   RowBox[{
    RowBox[{"sparseReconstruct", "[", 
     RowBox[{"reverseFlattenSparse", "[", 
      RowBox[{"coefficients", ",", "n"}], "]"}], "]"}], ",", "n", ",", "n"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.67438804820977*^9, 3.674388097956037*^9}, {
  3.67438834813968*^9, 3.6743884831458807`*^9}, {3.674391824266535*^9, 
  3.674391840837083*^9}, {3.674392240561735*^9, 3.674392305076214*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"SparsetoPosition", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"dxMatrixSparse", "[", "3", "]"}], "[", 
    RowBox[{"[", "4", "]"}], "]"}], ",", "3"}], "]"}]], "Input",
 CellChangeTimes->{{3.674392276972671*^9, 3.674392280494876*^9}, {
  3.674392365781637*^9, 3.674392399685356*^9}, {3.674392442582286*^9, 
  3.674392521662084*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0",
      ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "11"}], ",", 
     RowBox[{"-", "11"}], ",", 
     RowBox[{"-", "11"}], ",", 
     RowBox[{"-", "11"}], ",", 
     RowBox[{"-", "11"}], ",", 
     RowBox[{"-", "11"}], ",", 
     RowBox[{"-", "11"}], ",", 
     RowBox[{"-", "11"}], ",", 
     RowBox[{"-", "11"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "6"}], ",", 
     RowBox[{"-", "6"}], ",", 
     RowBox[{"-", "6"}], ",", 
     RowBox[{"-", "6"}], ",", 
     RowBox[{"-", "6"}], ",", 
     RowBox[{"-", "6"}], ",", 
     RowBox[{"-", "6"}], ",", 
     RowBox[{"-", "6"}], ",", 
     RowBox[{"-", "6"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "5"}], ",", 
     RowBox[{"-", "5"}], ",", 
     RowBox[{"-", "5"}], ",", 
     RowBox[{"-", "5"}], ",", 
     RowBox[{"-", "5"}], ",", 
     RowBox[{"-", "5"}], ",", 
     RowBox[{"-", "5"}], ",", 
     RowBox[{"-", "5"}], ",", 
     RowBox[{"-", "5"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "4"}], ",", 
     RowBox[{"-", "4"}], ",", 
     RowBox[{"-", "4"}], ",", 
     RowBox[{"-", "4"}], ",", 
     RowBox[{"-", "4"}], ",", 
     RowBox[{"-", "4"}], ",", 
     RowBox[{"-", "4"}], ",", 
     RowBox[{"-", "4"}], ",", 
     RowBox[{"-", "4"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "5"}], ",", 
     RowBox[{"-", "5"}], ",", 
     RowBox[{"-", "5"}], ",", 
     RowBox[{"-", "5"}], ",", 
     RowBox[{"-", "5"}], ",", 
     RowBox[{"-", "5"}], ",", 
     RowBox[{"-", "5"}], ",", 
     RowBox[{"-", "5"}], ",", 
     RowBox[{"-", "5"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "6"}], ",", 
     RowBox[{"-", "6"}], ",", 
     RowBox[{"-", "6"}], ",", 
     RowBox[{"-", "6"}], ",", 
     RowBox[{"-", "6"}], ",", 
     RowBox[{"-", "6"}], ",", 
     RowBox[{"-", "6"}], ",", 
     RowBox[{"-", "6"}], ",", 
     RowBox[{"-", "6"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "11"}], ",", 
     RowBox[{"-", "11"}], ",", 
     RowBox[{"-", "11"}], ",", 
     RowBox[{"-", "11"}], ",", 
     RowBox[{"-", "11"}], ",", 
     RowBox[{"-", "11"}], ",", 
     RowBox[{"-", "11"}], ",", 
     RowBox[{"-", "11"}], ",", 
     RowBox[{"-", "11"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0",
      ",", "0"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.674392281311673*^9, 3.674392306452425*^9}, 
   3.674392367991129*^9, 3.674392404749111*^9, {3.674392454735012*^9, 
   3.67439252218386*^9}, 3.674571489954358*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"sparseCoefficients2D", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"Sin", "[", 
     RowBox[{"#1", "+", "#2"}], "]"}], "&"}], ",", "3"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sparseCoefficients2D", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Sin", "[", 
      RowBox[{"#1", "+", "#2"}], "]"}], "&"}], ",", "3"}], "]"}], "//", 
  "Flatten"}], "\[IndentingNewLine]", 
 RowBox[{"reverseFlattenSparse", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"sparseCoefficients2D", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Sin", "[", 
        RowBox[{"#1", "+", "#2"}], "]"}], "&"}], ",", "3"}], "]"}], "//", 
    "Flatten"}], ",", "3"}], "]"}]}], "Input",
 CellChangeTimes->{{3.674391960296603*^9, 3.6743919916574507`*^9}, {
  3.6743921570403214`*^9, 3.6743922232398376`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{"{", "0", "}"}], "}"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"Sin", "[", "1", "]"}], "}"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "2"}], " ", 
         RowBox[{"Sin", "[", "1", "]"}]}], "+", 
        RowBox[{"Sin", "[", "2", "]"}]}], "}"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"Sin", "[", "1", "]"}], "}"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", "0.05869004620025475`", "}"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"{", "0.06342073458701059`", "}"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"{", "0.06342073458701059`", "}"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"{", "0.05869004620025475`", "}"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"0.0076911899524214344`", ",", "0.021190498317284368`"}], 
       "}"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"0.02181044369718932`", ",", "0.009399241841784534`"}], "}"}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"{", "0.012610308710007678`", "}"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "0.021810443697189347`", "}"}], ",", 
       RowBox[{"{", "0.009399241841784534`", "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "0.0076911899524214344`", "}"}], ",", 
       RowBox[{"{", "0.021190498317284368`", "}"}]}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{
       "0.0009727537579662243`", ",", "0.002857780156684586`", ",", 
        "0.004565123626693701`", ",", "0.005988629820411706`"}], "}"}], "}"}],
      ",", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{
       "0.0060670382593875916`", ",", "0.004795473886650803`", ",", 
        "0.0032257501741422834`", ",", "0.0014554649394727948`"}], "}"}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"0.0025940865162683013`", ",", "0.0036115144114340914`"}], 
       "}"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "0.0025940865162682597`", "}"}], ",", 
       RowBox[{"{", "0.003611514411434147`", "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "0.0060670382593876054`", "}"}], ",", 
       RowBox[{"{", "0.004795473886650692`", "}"}], ",", 
       RowBox[{"{", "0.0032257501741422834`", "}"}], ",", 
       RowBox[{"{", "0.0014554649394727948`", "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "0.0009727537579662243`", "}"}], ",", 
       RowBox[{"{", "0.002857780156684586`", "}"}], ",", 
       RowBox[{"{", "0.004565123626693701`", "}"}], ",", 
       RowBox[{"{", "0.005988629820411706`", "}"}]}], "}"}]}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.6743920377918663`*^9, 3.674392163237103*^9, {3.674392202535199*^9, 
   3.674392225166767*^9}, 3.674571491508238*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", 
   RowBox[{"Sin", "[", "1", "]"}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "2"}], " ", 
     RowBox[{"Sin", "[", "1", "]"}]}], "+", 
    RowBox[{"Sin", "[", "2", "]"}]}], ",", 
   RowBox[{"Sin", "[", "1", "]"}], ",", "0.05869004620025475`", ",", 
   "0.06342073458701059`", ",", "0.06342073458701059`", ",", 
   "0.05869004620025475`", ",", "0.0076911899524214344`", ",", 
   "0.021190498317284368`", ",", "0.02181044369718932`", ",", 
   "0.009399241841784534`", ",", "0.012610308710007678`", ",", 
   "0.021810443697189347`", ",", "0.009399241841784534`", ",", 
   "0.0076911899524214344`", ",", "0.021190498317284368`", ",", 
   "0.0009727537579662243`", ",", "0.002857780156684586`", ",", 
   "0.004565123626693701`", ",", "0.005988629820411706`", ",", 
   "0.0060670382593875916`", ",", "0.004795473886650803`", ",", 
   "0.0032257501741422834`", ",", "0.0014554649394727948`", ",", 
   "0.0025940865162683013`", ",", "0.0036115144114340914`", ",", 
   "0.0025940865162682597`", ",", "0.003611514411434147`", ",", 
   "0.0060670382593876054`", ",", "0.004795473886650692`", ",", 
   "0.0032257501741422834`", ",", "0.0014554649394727948`", ",", 
   "0.0009727537579662243`", ",", "0.002857780156684586`", ",", 
   "0.004565123626693701`", ",", "0.005988629820411706`"}], "}"}]], "Output",
 CellChangeTimes->{
  3.6743920377918663`*^9, 3.674392163237103*^9, {3.674392202535199*^9, 
   3.674392225166767*^9}, 3.67457149151608*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{"{", "0", "}"}], "}"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"Sin", "[", "1", "]"}], "}"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "2"}], " ", 
         RowBox[{"Sin", "[", "1", "]"}]}], "+", 
        RowBox[{"Sin", "[", "2", "]"}]}], "}"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"Sin", "[", "1", "]"}], "}"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", "0.05869004620025475`", "}"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"{", "0.06342073458701059`", "}"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"{", "0.06342073458701059`", "}"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"{", "0.05869004620025475`", "}"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"0.0076911899524214344`", ",", "0.021190498317284368`"}], 
       "}"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"0.02181044369718932`", ",", "0.009399241841784534`"}], "}"}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"{", "0.012610308710007678`", "}"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "0.021810443697189347`", "}"}], ",", 
       RowBox[{"{", "0.009399241841784534`", "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "0.0076911899524214344`", "}"}], ",", 
       RowBox[{"{", "0.021190498317284368`", "}"}]}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{
       "0.0009727537579662243`", ",", "0.002857780156684586`", ",", 
        "0.004565123626693701`", ",", "0.005988629820411706`"}], "}"}], "}"}],
      ",", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{
       "0.0060670382593875916`", ",", "0.004795473886650803`", ",", 
        "0.0032257501741422834`", ",", "0.0014554649394727948`"}], "}"}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"0.0025940865162683013`", ",", "0.0036115144114340914`"}], 
       "}"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "0.0025940865162682597`", "}"}], ",", 
       RowBox[{"{", "0.003611514411434147`", "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "0.0060670382593876054`", "}"}], ",", 
       RowBox[{"{", "0.004795473886650692`", "}"}], ",", 
       RowBox[{"{", "0.0032257501741422834`", "}"}], ",", 
       RowBox[{"{", "0.0014554649394727948`", "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "0.0009727537579662243`", "}"}], ",", 
       RowBox[{"{", "0.002857780156684586`", "}"}], ",", 
       RowBox[{"{", "0.004565123626693701`", "}"}], ",", 
       RowBox[{"{", "0.005988629820411706`", "}"}]}], "}"}]}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.6743920377918663`*^9, 3.674392163237103*^9, {3.674392202535199*^9, 
   3.674392225166767*^9}, 3.674571491523962*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Integrating By Coefficients", "Subsection",
 CellChangeTimes->{{3.673277052290266*^9, 3.673277061302971*^9}, {
  3.673277119209675*^9, 3.6732771212386723`*^9}, {3.673348508736053*^9, 
  3.673348513701818*^9}, {3.6737269924034224`*^9, 3.6737269925381393`*^9}, {
  3.6739173803011847`*^9, 3.6739173831779957`*^9}, {3.673976589259214*^9, 
  3.673976594082218*^9}, {3.6742472220539103`*^9, 3.674247225471348*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"sparseIntegrateByCoefficients", "[", 
   RowBox[{"f_", ",", "n_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", 
             RowBox[{
              RowBox[{"diag", "+", "2"}], ",", 
              RowBox[{"perp", "+", "2"}], ",", "i", ",", "j"}], "]"}], "]"}], 
           " ", 
           RowBox[{"area", "[", 
            RowBox[{"getrow", "[", 
             RowBox[{"perp", ",", "diag"}], "]"}], "]"}], " ", 
           RowBox[{"area", "[", 
            RowBox[{"getcol", "[", 
             RowBox[{"perp", ",", "diag"}], "]"}], "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            SuperscriptBox["2", 
             RowBox[{
              RowBox[{"switch", "[", 
               RowBox[{"getrow", "[", 
                RowBox[{"perp", ",", "diag"}], "]"}], "]"}], "-", "1"}]]}], 
           "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "1", ",", 
            SuperscriptBox["2", 
             RowBox[{
              RowBox[{"switch", "[", 
               RowBox[{"getcol", "[", 
                RowBox[{"perp", ",", "diag"}], "]"}], "]"}], "-", "1"}]]}], 
           "}"}]}], "]"}], "\[IndentingNewLine]", ",", 
        RowBox[{"{", 
         RowBox[{"perp", ",", 
          RowBox[{"-", "1"}], ",", 
          RowBox[{"endperp", "[", "diag", "]"}]}], "}"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"diag", ",", 
        RowBox[{"-", "1"}], ",", "n"}], "}"}]}], "]"}], "&"}], "@", 
   RowBox[{"sparseCoefficients2D", "[", 
    RowBox[{"f", ",", "n"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.6742348157765093`*^9, 3.674234852057425*^9}, {
   3.674234892162032*^9, 3.674234982839038*^9}, {3.674235017265462*^9, 
   3.674235019814867*^9}, {3.674235074052116*^9, 3.674235092262163*^9}, {
   3.67423513960469*^9, 3.674235141278442*^9}, {3.674235171494604*^9, 
   3.674235174858081*^9}, 3.674235258641075*^9, {3.674235450862471*^9, 
   3.6742354690892267`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"sparseIntegrateByCoefficients", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Cos", "[", 
      RowBox[{"#1", "+", "#2"}], "]"}], "&"}], ",", "10"}], "]"}], "//", 
  "N"}], "\[IndentingNewLine]", 
 RowBox[{"NIntegrate", "[", 
  RowBox[{
   RowBox[{"Cos", "[", 
    RowBox[{"x", "+", "y"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", "0", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"y", ",", "0", ",", "1"}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.674235097249342*^9, 3.674235127891021*^9}, {
  3.6742351599600697`*^9, 3.674235191927218*^9}, {3.67423561702699*^9, 
  3.674235622575564*^9}}],

Cell[BoxData["0.4967512734739072`"], "Output",
 CellChangeTimes->{{3.674235103404628*^9, 3.674235192277237*^9}, 
   3.674235259959548*^9, 3.6742354703233852`*^9, {3.6742356072184134`*^9, 
   3.674235624076528*^9}, 3.674247322308196*^9, 3.674571496453648*^9}],

Cell[BoxData["0.496751448303659`"], "Output",
 CellChangeTimes->{{3.674235103404628*^9, 3.674235192277237*^9}, 
   3.674235259959548*^9, 3.6742354703233852`*^9, {3.6742356072184134`*^9, 
   3.674235624076528*^9}, 3.674247322308196*^9, 3.6745714964906263`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Out", "[", "283", "]"}], "//", "MatrixPlot"}]], "Input",
 CellChangeTimes->{{3.674235799861292*^9, 3.67423580952064*^9}, {
  3.674235840811994*^9, 3.674235843513061*^9}, {3.674235952363166*^9, 
  3.674235956460215*^9}, {3.674247332279873*^9, 3.6742473331012783`*^9}}],

Cell[BoxData[
 GraphicsBox[RasterBox[CompressedData["
1:eJztnH9MlVUYx+8SoxJcXcnNOWcFEpM1ndoP6trDhl3KLIl0zLRsJJsNyLTC
BmkSUK1RVlurxrTUzdZUaP6gmpmuq0hpy0IGUjG5MBXufe8c003EVRb2D9vD
+s7ndN7z3sPGvnB29uy855zPeZ7z89bCFflFo3w+35Qrv3///dqRHdU7BqNU
1f/6uSw6Q+9931F2R/kJenR+YsKuvQ4998fYwJqsCFU3Lo5sOdZNPzxy35x3
2x2iyePz1m+N0M5Y99aCaA8tW174RVmqQ6vbGgbvcs7QbaWZA2vTfyPfPz9n
/7NmBakmvDxGC0JZu3sPO/RR4tt5HWV9lP1QW0LGtBjtrMysPeREafaHr5xY
dbm8qH3VipaTq2fd3xEvqrr+Ob5Q7kJztxyc64/RyafTXt61LkrJS89N2p96
mhbmf1J1odKhH7/xpSxa2kdTgw+/GPi4Cy5n7rwV1aXnHbope9KyTeOiFE4v
KRxz3SlasvDuUfc/6FBmRX9kVk0vbdj20sXPQ53a2224Wu7cqbr4QvNz5dyX
O+aB0fNiVLV5xqdtTzhU/FPCB+mLe1le0PKbwp3ly53qNr5QO1z5G+e8cGh/
TYzSerKbB2fFqIluTnrn/QgbH6LlMSXOtNzpVVP4QsuPzu+4dLQ8HHdSXKtW
lEe3jSfxpqr5RflC53dcOlpOLs6UimNVq+XOnaqLLzQ/Or/j0tHym8Kd5cud
6ja+UDvo/I5LR8tjSpxpudOrpvDFKbqugq43cva5/Fz/1LUuIRU/oPWv+rtM
Ua/WD8odut7I2efym8Kd5UtW461+UH/E+Tu0f3J8oX5Tqh2l+LI6ssYbX2g9
cFxw/k6KO9RvSvElld/qkFq+RlapfTo0LlW9TmLXPYbU9PUHr6rUPh26DqN6
XyDeuLN8maVS+3S6uLN8Wb5MVKl9Ol1xple5s3x5W7n5L3efDp3foeszUt+F
9itTeERV1/le3d/tduXahbtPh87v0P0Iqe+KN+4sX2Yp114cF+j8TjV3li/L
l4nKtSMXB6LzO9Vxple5s3x5W/eM//XoLzOjtGBd4GKgtYemX2jaXjChGT7H
Utsz/9W08ijdWLv5swOX/Za/YeINU5uOwXa4/qBrHxbtn+i9eK7e/u9+4FaV
anf0nAZqHz03gnKHnp9UbUd1u6PxM2fH8jWyou3rNo6kvpfrVz/ntYRaNzq0
4ffEjOKjfVSwtmXa2d1h2H+h+3q64iLV7zm47d0Yt6lUu6vmVOrcI9cfuHUV
1H9x8ztTuLN8yarUPF0XR6h9NM5E40AuvuL6ITp/1HUeW+oek1fXN6TeFfFq
/Xg1zkT9C8qp7nYbrqaM/17lCFV0POfiTCnu0HtGUnxx+XVxZwpHUvUcb8rF
mWh8KPUetdS9V3T9EB03dLfbcFUdp0lxau/lDSnHHRp3SXGH2pfii8tv+vsS
nKr2d5avkXX988dnBguiVHHLhFDGuC5KPTjlwBuPrYbXW7j8qJ3SyoRtzqYo
XbPySP2+xlO0Mb+ktmJVC22vW1ny1t4IJbfnjL33cJjuqS8+/uy3DWK8c+lS
6zlS9+VNUdXtgq6Ho/Ma9B0S9J0ujguu/7c/XpwzscihS3UDfwb7e+lScuir
N9ecFKtn7h4EVx60ftD2Qs+XSr0/o5ubq1W0XVD/q5o71fZRf8Rxx3HBpXN8
of4C7c9ovUnxq3p8cFu/QjlC60f3uHK1qjrO5OJDjkfUvlfjTNVxjmrubBwu
y53ff/2elO+iFEwqSlqUc5qW+J8JV9a1UtH0a9sCnRG6s+vLgfNPdVPz6M7b
n5zxNRzHquYO7bdSXKjm2vR0tD65ezHcPhd3b5S7x42OS9x9VS6uQ/ni7HD5
0XgVnT+i7cW1C3ceAH1/hrPjtn7ltn6L5je9fjh/x/kvji/V65nofgfnR6Te
y5Xym+j9R6nxVnW/kooHvJr+b7zZVZ5Sn9vVceV/nw+NP7n8qB3UvhTvquNb
1eVUPc9VPV+Lt/L/BaCM9S8=
   "], {{0, 0}, {37, 37}}, {0, 1}],
  Frame->True,
  FrameLabel->{None, None},
  FrameTicks->{{{{36.5, 
       FormBox["1", TraditionalForm]}, {27.5, 
       FormBox["10", TraditionalForm]}, {17.5, 
       FormBox["20", TraditionalForm]}, {7.5, 
       FormBox["30", TraditionalForm]}, {0.5, 
       FormBox["37", TraditionalForm]}}, {{36.5, 
       FormBox["1", TraditionalForm]}, {27.5, 
       FormBox["10", TraditionalForm]}, {17.5, 
       FormBox["20", TraditionalForm]}, {7.5, 
       FormBox["30", TraditionalForm]}, {0.5, 
       FormBox["37", TraditionalForm]}}}, {{{0.5, 
       FormBox["1", TraditionalForm]}, {9.5, 
       FormBox["10", TraditionalForm]}, {19.5, 
       FormBox["20", TraditionalForm]}, {29.5, 
       FormBox["30", TraditionalForm]}, {36.5, 
       FormBox["37", TraditionalForm]}}, {{0.5, 
       FormBox["1", TraditionalForm]}, {9.5, 
       FormBox["10", TraditionalForm]}, {19.5, 
       FormBox["20", TraditionalForm]}, {29.5, 
       FormBox["30", TraditionalForm]}, {36.5, 
       FormBox["37", TraditionalForm]}}}},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  Method->{
   "AxisPadding" -> Scaled[0.02], "DefaultBoundaryStyle" -> Automatic, 
    "DefaultPlotStyle" -> Automatic, "DomainPadding" -> Scaled[0.02], 
    "RangePadding" -> Scaled[0.05]}]], "Output",
 CellChangeTimes->{
  3.674235824723208*^9, {3.6742359533758717`*^9, 3.674235956741428*^9}, 
   3.674247338281554*^9}]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"W3", "=", 
   RowBox[{"sparseW", "[", "3", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dW3", "=", 
   RowBox[{"sparsedW", "[", "3", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"D3", "=", 
   RowBox[{"dxMatrixSparse", "[", "3", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[CapitalDelta]3", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"#", "+", 
       RowBox[{"Transpose", "[", "#", "]"}], "-", "dW3"}], ")"}], "&"}], "@", 
    
    RowBox[{"(", 
     RowBox[{"W3", ".", "D3"}], ")"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.6744039642003508`*^9, 3.674403991619418*^9}, {
   3.674572613282099*^9, 3.674572620593418*^9}, 3.674572669956978*^9, {
   3.67457272673493*^9, 3.674572726924658*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"SparsetoPosition", "[", "dxMatrixSparse", "]"}]], "Input",
 CellChangeTimes->{{3.6743881193716087`*^9, 3.6743881264129877`*^9}}],

Cell[BoxData[
 RowBox[{"standardProject2D", "[", 
  RowBox[{
   RowBox[{
    UnderoverscriptBox["\[Sum]", 
     RowBox[{"diag", "=", 
      RowBox[{"-", "1"}]}], 
     RowBox[{
      RowBox[{"Length", "[", "dxMatrixSparse", "]"}], "-", "2"}]], 
    RowBox[{"(", 
     RowBox[{
      UnderoverscriptBox["\[Sum]", 
       RowBox[{"perp", "=", 
        RowBox[{"-", "1"}]}], 
       RowBox[{"endperp", "[", "diag", "]"}]], 
      RowBox[{
       RowBox[{"dxMatrixSparse", "\[LeftDoubleBracket]", 
        RowBox[{
         RowBox[{"diag", "+", "2"}], ",", 
         RowBox[{"perp", "+", "2"}], ",", 
         RowBox[{"ceil", "[", 
          RowBox[{"#1", ",", 
           RowBox[{"switch", "[", 
            RowBox[{"getrow", "[", 
             RowBox[{"perp", ",", "diag"}], "]"}], "]"}]}], "]"}], ",", 
         RowBox[{"ceil", "[", 
          RowBox[{"#2", ",", 
           RowBox[{"switch", "[", 
            RowBox[{"getcol", "[", 
             RowBox[{"perp", ",", "diag"}], "]"}], "]"}]}], "]"}]}], 
        "\[RightDoubleBracket]"}], " ", 
       RowBox[{
        RowBox[{"\[Phi]", "[", 
         RowBox[{
          RowBox[{"getrow", "[", 
           RowBox[{"perp", ",", "diag"}], "]"}], ",", 
          RowBox[{"getcol", "[", 
           RowBox[{"perp", ",", "diag"}], "]"}], ",", 
          RowBox[{"ceil", "[", 
           RowBox[{"#1", ",", 
            RowBox[{"switch", "[", 
             RowBox[{"getrow", "[", 
              RowBox[{"perp", ",", "diag"}], "]"}], "]"}]}], "]"}], ",", 
          RowBox[{"ceil", "[", 
           RowBox[{"#2", ",", 
            RowBox[{"switch", "[", 
             RowBox[{"getcol", "[", 
              RowBox[{"perp", ",", "diag"}], "]"}], "]"}]}], "]"}]}], "]"}], 
        "[", 
        RowBox[{"#1", ",", "#2"}], "]"}]}]}], ")"}]}], "&"}], "]"}]], "Output",\

 CellChangeTimes->{3.674388127661928*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Chop", "[", 
  RowBox[{"Eigenvalues", "[", "W3", "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.674575816080871*^9, 3.6745758367116756`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "2.8358602803915938`", ",", "0.4526399223946682`", ",", 
   "0.4502770353133574`", ",", "0.3820898896023554`", ",", 
   "0.33729446441022687`", ",", "0.3297022668528758`", ",", 
   "0.17470077914197427`", ",", "0.17406500766572927`", ",", 
   "0.17346401777213633`", ",", "0.16154068152764478`", ",", 
   "0.15617621642191365`", ",", "0.1554327523364206`", ",", 
   RowBox[{"-", "0.14734163140539716`"}], ",", "0.09954194784814785`", ",", 
   "0.09920444133657985`", ",", 
   RowBox[{"-", "0.07236768702053106`"}], ",", "0.04417485041797397`", ",", 
   RowBox[{"-", "0.04058275846694241`"}], ",", "0.03603829539246491`", ",", 
   RowBox[{"-", "0.030853966743537888`"}], ",", 
   RowBox[{"-", "0.030733850979723944`"}], ",", "0.027018309245847232`", ",", 
   "0.026960684521036317`", ",", "0.024913467474884106`", ",", 
   "0.02389974556406434`", ",", 
   RowBox[{"-", "0.011926249896396027`"}], ",", 
   RowBox[{"-", "0.011789533429770717`"}], ",", 
   RowBox[{"-", "0.006899377689596188`"}], ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{{3.674575830210121*^9, 3.674575837017364*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[CapitalDelta]3", "//", "MatrixPlot"}]], "Input",
 CellChangeTimes->{{3.6742360032569838`*^9, 3.674236059673923*^9}, {
  3.674239779997561*^9, 3.6742397921626997`*^9}, {3.674247380665985*^9, 
  3.6742473868503103`*^9}, {3.6745715404045887`*^9, 3.67457155290077*^9}, {
  3.674572694549164*^9, 3.674572784882708*^9}}],

Cell[BoxData[
 GraphicsBox[RasterBox[CompressedData["
1:eJztnH9MlVUYx9mICsNCKGsDJBTEUeI1QyWLZ2lgNa4RJiFCMvCy5gRaAxkW
k4g0E3UgOS+UWEtZFgOKnAOygFF0gUDjYkQBwit4ue8lwFBKctWof1wP2+PO
4b3vvcfNfdjZ2XPf97zne57zPOeHT0JqpM7RwcHB79////w9/W8UZptSUMeK
hooLcPxYYPaaBAmMAU+5lZ01ke0EeOecOvdJOyS4RgdXNXVCt7vv6Zq9MrPy
V65tMS5zkUGS/Z2G/CWICkvt62ys594+vN+Ldzmrdii5Z0flywt/hcUvxufv
0f8M7Y5rM4+4Rs16f7UVstId9l2wckxH1HKl28/aSf0umB3eurY3KuXv5IC5
zwS1tUGH3PzZoYI+SF2wuvbgxDC5XOn2s3ZSv4vwa7NDpfwd1b5SuqO+F+92
4E3h16Y57vzdY1n5FtBC9fiUfhhSK58raVjeD9dyHbzrtBbwiNUuci4yQe3A
4vlOml6y/YdTyza1p0vgUrDt7jV5Jii6+ta+3UtltByzg+n3zs2fTsYsa4MV
Id4JGlM3nNl7ouF6nZlcn/q+rMYTrB3KdEvlwJYfoDo0S6/b1Q8f+oYMecUM
Q0JStmGlx/fgaczZmZLZAyefTDJ4bDXDBb8dh7/yaYdnS2u049FdYGiVart9
8XZmZZ9VP7S3eT61/7OyT+23mC5ya3PKN52QIXh1cvn7jX3wzZWMxnnx6TBy
MD8q2GiB7IX+9aN6MziO7f88t1mCfVOxv99RLkN8UsNrc0YHwVQyp7VrYwdZ
d6zGJbWT+l0wO/Y2z8f6J1ZOtY/pjpV/wfwXdZzH7LPya7ZK6nexN7+GURc5
8VvGGz0Qa3E3VBUNgrx1W3ll8jCY3GNenXhgBCqcCvMlvQz5mqZvQ3VDzHRH
1TWrcRUj1n94+zWqX04yL5fjDpvBz3vwo3fu74eI4vNfXgkvBLekDE3vgAWa
E70m4916oSKtKXGVtF3x/nUz7c2v8SbWf5Saj1HjSqX8GtUvY+XU92VlH/u+
Sn13TNes/Ky15WlZ+TXez8Nq3suKVH+HlSvVzrzn5/amI1sltX9i4z/W/3n3
E95klX/GyGo+j8WPrOIOocdbI++8EGbf2nTHW0dUstId73jcVnWXnFevTwzv
Aqdic+mYzyV4t3BjveGAcvlD36C+CumUCapXfhFZlyXD+gOliVqLBa1f8Ofm
JqnrHKzX+57ctecivO1T83xnKZ4fsLd8AlXXvMcB3uuPatkPoHG5d0lY90Wo
gsflDPfLsO6h9PeOavH1bt7Pg+V1sfqGVgfXzLNGCBw35kWkDECNf93rOheh
u/9I1RE2n2f1PNh+AFb21aK7JefD3oxxHYJEKU9z4zYzjNUd2Zk016Ia3VHr
26ruWPkp3rrjbV8tunvwaGZPSqgMbvt+Scu9aoFj0WciHm0dUc08k1pf6G52
7ChlXy26UwunMmOHiuNkOP5x+teT+y+B87q1TzSebkXjOyx/Yqu6oxLLR2G6
YLUfAIvvWOVJhO7Y8r7dcXelOVjAa9G8VZ4vXIanF6Rdj2jpQuM7obuZia2/
YPNAbH8O9Xex+E7ozjqJndfA4juhu5lJ1R1Wn/q7mH2hO+sktk8Vi++E7mYm
dZ7Jex1W6I4t1XK+gNW5eKXKxb0ZgmrUHat7YJTq5+LejFvjH9neL20IH4EN
IZ4/mrf8HccUtLhMxJmYnQPCSM3Ds7JPXXfjTepzYvkcLL/K2z51Xzfv9sT2
iVnbeIuto2F6ZPW7Suna2nSHtQOWz8Hyq9h6B+/np54zotpXi46sjbz1JTgz
qeMPVs5qfkLVEbWceh5QxLPWSWr/VEtcyZvUvCWr/ZzY/BY7N4TZp+pO5DPZ
EhvnsXJ70x01z89Kd9R1B2r7C90J2jOxc6zUc69YfWz9jnr+TuhO0JZIjQep
9YXuBHmQVb7CVufJ1sb5CQOV6Rkj8IHPIz9N3bCAt1PQdo/b2Z0TVAup+8SU
ft6bia0TYecfsfPI2P0AvJ+fek8dNj4oda+F4MwU6x2zQ6qOqHkYVvc3ivmA
oC3R2u57FBQUFORNtcSPSu1fFZwm1s6s7vlX+v0E/59K7V8VnCa2L4i6Hwbb
76r0+wkKCrLnXzMsxjw=
   "], {{0, 0}, {37, 37}}, {0, 1}],
  Frame->True,
  FrameLabel->{None, None},
  FrameTicks->{{{{36.5, 
       FormBox["1", TraditionalForm]}, {27.5, 
       FormBox["10", TraditionalForm]}, {17.5, 
       FormBox["20", TraditionalForm]}, {7.5, 
       FormBox["30", TraditionalForm]}, {0.5, 
       FormBox["37", TraditionalForm]}}, {{36.5, 
       FormBox["1", TraditionalForm]}, {27.5, 
       FormBox["10", TraditionalForm]}, {17.5, 
       FormBox["20", TraditionalForm]}, {7.5, 
       FormBox["30", TraditionalForm]}, {0.5, 
       FormBox["37", TraditionalForm]}}}, {{{0.5, 
       FormBox["1", TraditionalForm]}, {9.5, 
       FormBox["10", TraditionalForm]}, {19.5, 
       FormBox["20", TraditionalForm]}, {29.5, 
       FormBox["30", TraditionalForm]}, {36.5, 
       FormBox["37", TraditionalForm]}}, {{0.5, 
       FormBox["1", TraditionalForm]}, {9.5, 
       FormBox["10", TraditionalForm]}, {19.5, 
       FormBox["20", TraditionalForm]}, {29.5, 
       FormBox["30", TraditionalForm]}, {36.5, 
       FormBox["37", TraditionalForm]}}}},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  Method->{
   "AxisPadding" -> Scaled[0.02], "DefaultBoundaryStyle" -> Automatic, 
    "DefaultPlotStyle" -> Automatic, "DomainPadding" -> Scaled[0.02], 
    "RangePadding" -> Scaled[0.05]}]], "Output",
 CellChangeTimes->{{3.674572736424117*^9, 3.67457278513728*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{"#", "+", 
     RowBox[{"Transpose", "[", "#", "]"}], "-", "dW3"}], ")"}], "&"}], "@", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"W3", ".", "D3"}], "-", 
    RowBox[{
     RowBox[{"1", "/", "2"}], " ", "\[CapitalDelta]3"}]}], ")"}]}]], "Input",
 CellChangeTimes->{{3.674574673945571*^9, 3.674574693864402*^9}, {
  3.674574741419065*^9, 3.674574769582271*^9}, {3.674574804459531*^9, 
  3.674574816827076*^9}, {3.674574912163681*^9, 3.67457496924765*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
     "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
     "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
     "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
     "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
     "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
     "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
     "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
     "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
     "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
     "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
     "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
     "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
     "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
     "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
     "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
     "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
     "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
     "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
     "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
     "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
     "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
     "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
     "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
     "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
     "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
     "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
     "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
     "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
     "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
     "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
     "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
     "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
     "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
     "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
     "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
     "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
     "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
     "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
     "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
     "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
     "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
     "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
     "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
     "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
     "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
     "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
     "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
     "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
     "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
     "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
     "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
     "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
     "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
     "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
     "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
     "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
     "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
     "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
     "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
     "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
     "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
     "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
     "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
     "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
     "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
     "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
     "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
     "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
     "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
     "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
     "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
     "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
     "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
     "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
     "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
     "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
     "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
     "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
     "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
     "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
     "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
     "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
     "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
     "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
     "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
     "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
     "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
     "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
     "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
     "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
     "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
     "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
     "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
     "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
     "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
     "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
     "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
     "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
     "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
     "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
     "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
     "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
     "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
     "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
     "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
     "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
     "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
     "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
     "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
     "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
     "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
     "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
     "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
     "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
     "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
     "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
     "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
     "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
     "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
     "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
     "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
     "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
     "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
     "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
     "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
     "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
     "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
     "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
     "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
     "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
     "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
     "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
     "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
     "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
     "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
     "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
     "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
     "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
     "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
     "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
     "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
     "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
     "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
     "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
     "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
     "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
     "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
     "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
     "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
     "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
     "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
     "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
     "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
     "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
     "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
     "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
     "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
     "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
     "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
     "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
     "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
     "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
     "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
     "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
     "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
     "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
     "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
     "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
     "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
     "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
     "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
     "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
     "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
     "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
     "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
     "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
     "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
     "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
     "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
     "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
     "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
     "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
     "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
     "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
     "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
     "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
     "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
     "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
     "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
     "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
     "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
     "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
     "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
     "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
     "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
     "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
     "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
     "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
     "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
     "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
     "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
     "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
     "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
     "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
     "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
     "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
     "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
     "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
     "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
     "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
     "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
     "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
     "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
     "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
     "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
     "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
     "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
     "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
     "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
     "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
     "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", 
     "0.`"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.6745746948596277`*^9, {3.674574747499548*^9, 3.674574760955763*^9}, {
   3.67457480919939*^9, 3.674574817321179*^9}, {3.674574913411447*^9, 
   3.674574922963587*^9}, {3.6745749627850924`*^9, 3.674574969892296*^9}}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"sparseBasis", "[", "n_", "]"}], ":=", 
  RowBox[{
   RowBox[{"Flatten", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"sparseCoefficients2D", "[", 
         RowBox[{
          RowBox[{"\[Psi]", "[", 
           RowBox[{"n", ",", "n", ",", "i", ",", "j"}], "]"}], ",", "n"}], 
         "]"}], "//", "Flatten"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "0", ",", 
         SuperscriptBox["2", "n"]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "0", ",", 
         SuperscriptBox["2", "n"]}], "}"}]}], "]"}], ",", "1"}], "]"}], "//", 
   "Transpose"}]}]], "Input",
 CellChangeTimes->{{3.674304556325103*^9, 3.674304649740264*^9}, {
  3.674322331904735*^9, 3.67432233351082*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"sparseBasis", "[", "3", "]"}], "//", "MatrixPlot"}]], "Input",
 CellChangeTimes->{{3.6743045864192047`*^9, 3.674304618448146*^9}, {
  3.674304653257122*^9, 3.6743046553027973`*^9}}],

Cell[BoxData[
 GraphicsBox[RasterBox[CompressedData["
1:eJzt3T9rFEEYB+CA2AYUBRvBP/EzCBpYEYxYKCj4BSIWaiEogohfwEZII2hv
FRA7LWws7AyBFBYKYsgVHhclxM7KiApycHh73uzsvPscHE+uOWZumd/7bm72
9vDizUtXd83MzBzbeV7cef78+9djqyLJrvv8/snlg6/fVbcu3zm3ublR7dm7
vHu2188+rmm5fm/fs7Pr73+//vPIP65JjX68SE7f6Lkh50l23ei5IedJdt3o
uSHnSZIkyfI8/+L405X+oPr68OP2g6WN6uX1G/P7L7zKPq5xHdW3z/W2D505
sVp9f/tk7tTqh2rh7sp8780g+3jrOnyeFfV45R4XGdmouSHn26mcJ5s3am7I
+XYq58nmjZobcr6dynmSJJnLwelHj68tfqm+rd3eOvC5Xy0sHT0ye+XT1N4/
dZ+Tevxts6m+MdV+1K71vVHXV9R5Tev926bcKEvri2TbrLuu6+aM3GCXnbQu
j9t3da2PIv82V/1SN8l0qptkOtWvZhy1r2nUPq7S90GRJGP4r7o/3G/n6qvV
WZJkiaqzJEmmU50lSTKdpdTZ0vU5kySZTnWWJMl0qrMkSaZTnSVJkmQX1MeW
aarfoeV0jbq+os4runKjDK0vkiTbY+nXFXatr4h6f9jc40ll1PUVdV65x5VK
uVGW1hfJuroPHZlO9+Uk06l+TWbd84W654Oln4+QJNtprvvBqZskyRJ1H9XJ
9LmRJDm+6iZJku1R3STT25X952STRq1fpX//G/W4MIauayPTGbV+pZ5X6lwq
/biQJCcz6nWIUec17fGTJNmEUf7PRpLsplG/Zyl1XvoKkuymUfJ/uP5GnVfu
8ZAk+T+qayRJ5vcHSXKm6w==
   "], {{0, 0}, {81, 37}}, {0, 1}],
  Frame->True,
  FrameLabel->{None, None},
  FrameTicks->{{{{36.5, 
       FormBox["1", TraditionalForm]}, {27.5, 
       FormBox["10", TraditionalForm]}, {17.5, 
       FormBox["20", TraditionalForm]}, {7.5, 
       FormBox["30", TraditionalForm]}, {0.5, 
       FormBox["37", TraditionalForm]}}, {{36.5, 
       FormBox["1", TraditionalForm]}, {27.5, 
       FormBox["10", TraditionalForm]}, {17.5, 
       FormBox["20", TraditionalForm]}, {7.5, 
       FormBox["30", TraditionalForm]}, {0.5, 
       FormBox["37", TraditionalForm]}}}, {{{0.5, 
       FormBox["1", TraditionalForm]}, {19.5, 
       FormBox["20", TraditionalForm]}, {39.5, 
       FormBox["40", TraditionalForm]}, {59.5, 
       FormBox["60", TraditionalForm]}, {80.5, 
       FormBox["81", TraditionalForm]}}, {{0.5, 
       FormBox["1", TraditionalForm]}, {19.5, 
       FormBox["20", TraditionalForm]}, {39.5, 
       FormBox["40", TraditionalForm]}, {59.5, 
       FormBox["60", TraditionalForm]}, {80.5, 
       FormBox["81", TraditionalForm]}}}},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  Method->{
   "AxisPadding" -> Scaled[0.02], "DefaultBoundaryStyle" -> Automatic, 
    "DefaultPlotStyle" -> Automatic, "DomainPadding" -> Scaled[0.02], 
    "RangePadding" -> Scaled[0.05]}]], "Output",
 CellChangeTimes->{{3.6743045888902893`*^9, 3.6743046557788754`*^9}, 
   3.674322334730076*^9, 3.674586666727955*^9}]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"sparseWeights", "[", "n_", "]"}], ":=", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"sparseIntegrateByCoefficients", "[", 
     RowBox[{
      RowBox[{"\[Psi]", "[", 
       RowBox[{"n", ",", "n", ",", "i", ",", "j"}], "]"}], ",", "n"}], "]"}], 
    ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "0", ",", 
      SuperscriptBox["2", "n"]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"j", ",", "0", ",", 
      SuperscriptBox["2", "n"]}], "}"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fullWeights", "[", 
   RowBox[{"kx_", ",", "ky_"}], "]"}], ":=", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"fullIntegrate", "[", 
     RowBox[{
      RowBox[{"\[Psi]", "[", 
       RowBox[{"kx", ",", "ky", ",", "i", ",", "j"}], "]"}], ",", "kx", ",", 
      "ky"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "0", ",", 
      SuperscriptBox["2", "kx"]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"j", ",", "0", ",", 
      SuperscriptBox["2", "ky"]}], "}"}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.6743224320356627`*^9, 3.674322473933408*^9}, {
  3.674322615222788*^9, 3.67432264889931*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ListPlot", "[", 
  RowBox[{
   RowBox[{"Flatten", "[", 
    RowBox[{
     RowBox[{"makeSparse", "[", "8", "]"}], ",", "3"}], "]"}], ",", 
   RowBox[{"AspectRatio", "\[Rule]", "1"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.6743837765130653`*^9, 3.674383805878174*^9}, {
  3.6743838855600357`*^9, 3.674383887222248*^9}}],

Cell[BoxData[
 GraphicsBox[{{}, {{}, 
    {RGBColor[0.368417, 0.506779, 0.709798], PointSize[0.004583333333333334], 
     AbsoluteThickness[1.6], PointBox[CompressedData["
1:eJzt282OFccVAOBJNnmNzpO4niFP0IqUdXiEs/SShRdeeNGykIUsZGGMbYwx
Lv6H/78BGhigGZqhGZpJHiGKRLXUn9QoSqQgQd/N1Xcvl5pzq7pO1am+f/7r
3//ytz9ubGz84U8bG/9+fv/jn5+9/9lHx/vdZ+9/3cctXh/43C08LLSz9O/8
f2zHR+b1Fvd4pJ2MW9zjcSGOjjiWXu/+x3b9u8vjP43bx1Fe38RbeBvv4F28
h/eJ4yjexFt4G+/gXbyHS/v2Q3GLe1y+x1sLzwPPS6//t+0Wf6jvzX4rj//X
uPHR8PoJfB5fw3fwffwIP8XP8Qv8Er/Cr/Eb/Bb/g35o8Al8Hl/Dd/B9/Ag/
xc/xC/wSv8Kv8Rv8Fpf4vQ6KN/EW3sY7eBfv4TIOy3WdcYt7XK5j54GBzw98
fuDztrv0//h3+f/6d9rO0t/9ob734k913Hvdl8enMu/5OMjrh/FxfAqfxRfx
FXwD38Z38T38AD/Ej/ET/GzuYJ0e9EuQZ4N+CtaJQb8FeTnox2BdHvRrkMeD
fg7WpUG/B3k/vA4O4sP4OD6Fz+KL+Aq+gW/ju/gefoAf4sf4CX4299T/xcxL
wTovmKeCfUYwbwXrwmAeC/ZtwbwWrCODeS7Y1wTzXrDuDPN/g0/g8/gavoPv
40f4KX6OX+CX+BV+jd/gt7jEX/LyUbyJt/A23sG7eA+X/nAdMND+QPsD7Q+0
P9D+QPsD7eeF5xb3eFz4d+3Cc4/Hhf/Xf9cvPI88L/1dtuPn7PelfnBc2C+O
E/vJcWO/OY7sR8eV/eo4s5+Xxt2net0Xr3lv7k8l77nuKY913Tv3x7ru9RG8
/iU+hI/gY/gnfBKfxmfwOXwBX8KX8VV8Hd/ke7mFGZfBPjcYp0GdMhi3wb44
GMdB3T0Y18E+OhjnQV00GPfBvju4DhLXQcaJ6yLjxHWSceK6yThxHWWcuK4y
TlxnGSeuu4wT12HGiesy48R1mnHius04cR1nnLiuM05c5xknrvtsHgj8JT6E
j+Bj+Cd8Ep/GZ/A5fAFfwpfxVXwd35x7uv6LWZcEdb5gnRKckwTrlqAuGKxj
gnO7YF0T1BGDdU5wLhOse4K6Y7AOSqyDMk6sizJOrJMyTqybMk6sozJOrKsy
TqyzMk6suzJOrMMyTqzLMk6s0zJOrNsyTqzjMk6s6zJOrPMyTlzveWkfUHwY
H8en8Fl8EV/BN/BtfBffww/wQ/wYP8HP5p7WgcXsy4JzhmCfFpyzBvu24Fwi
2MdN68Bi9nXBOUawzwvOdYN9X3DuEdZ/GnwCn8fX8B18Hz/CT/Fz/AK/xK/w
a/wGv8UlfusAA/EPxD8Q/0D8A/EPxD8Q/0D8A/EPxD8Q/0D8A/EPxD8Qf6kb
HcWbeAtv4x28i/dwGY8t7be039J+S/st7be039J+S/s97fe039N+T/s97fe0
39N+T/vW4UbaH2l/pP2R9kfaH2l/pH373X7we1n6Ox039qPfq3E5zux3+8Hv
wXHpOLHf/N4cx44r+9nv2XHvOHRc2C9eJ45bx5H9uHRdOc4dd877S/OgecF5
0TzhPGnecN40jziPmlecV80zzrPmHedd85DzsHnJedk85Txt3nLeNo85j5vX
nNfNc87zS3lvXffN/ams+0rc675/7nXfP39/3ffP3/9Y9v3leljr/nOvdf/5
+2vdf/7+x1L393GA1z/HX+Cv8Nf4G/wt/g5/j3/AP+Kf8S/4V/wb/p3rImPm
peCcO5ingvtkg3krOBcP5rHgdw/BvBacowfzXHBfbjDvBefuwTyYmAczTsyL
GSfmyYwT82bGiXk048S8mnFins04Me9mnJiHM07Myxkn5umME/N2xol5POPE
vJ5xYp7PODHvZ1wx79e4wR2uyAs1bnCHK/JGjRvc4Yq8UuMGd7gi79S4wR2u
yEs1bnCHK/JWjRvc4Yq8VuMGd7gi79W4wR2uyIs1bnCHK/JmjRvc4Yq8WuMG
d7gi79a4wR2uyMs1bnCHK/J2jRvc4Yq8XuMGd+4DDuDP8Rf4K/w1/gZ/i7/D
3+Mf8I/4Z/wL/hX/hn+fe8r/xdQlgvscgzrFlP+LqVsE90UGdYwp/xdT1wju
owzqHFP+L6buEdx3GdRBpvxf9ok4URfJOFEnyThRN8k4UUfJOFFXyThRZ8k4
UXfJOFGHyThRl8k4UafJOFG3yThRx8k4UdfJOFHnyThR98m4ou5T4wZ3uKIu
VOMGd7iiblTjBne4oq5U4wZ3uKLuVOMGd7iiLlXjBne4om5V4wZ3uKKuVeMG
d7ii7lXjBne4oi5W4wZ3uKJuVuMGd7iirlbjBne4ou5W4wZ3uKIuV+MGd7ii
blfjBne4Ip/XuMHd0jlA8Zf4ED6Cj+Gf8El8Gp/B5/AFfAlfxlfxdXxz7qkO
WMy5VPA7j+CcKvidcnBuFfwuJDjHmuqAxZxrBb8jCc65gt9FB+dewe9OgnOw
qQ747jnjxLlYxolzsowT52YZJ87RMk6cq2WcOGfLOHHulnHiHC7jxLlcxolz
uowT53YZJ87xMk6c62WcOOfLOHG9Z8+FD+LD+Dg+hc/ii/gKvoFv47v4Hn6A
H+LH+Al+Nvd0DlzMfQHTOXAx9wVM58DF3BcwnQMXc1/AdA5czH0B0zlwMfcF
TOfAxdwXMJ0DFy/dB1B8GB/Hp/BZfBFfwTfwbXwX38MP8EP8GD/Bz+ae+r+Y
+0Cm/i/mPpCp/4u5D2Tq/2LuA5n6v5j7QKb+L+Y+kKn/i7kPZOr/Yu//a/AJ
fB5fw3fwffwIP8XP8Qv8Er/Cr/Eb/BaX+Fvib4m/Jf6W+Fvib4m/Jf6W+Fvi
b4m/Jf6W+Fvib4m/Jf6W+Hvi74m/J/6e+Hvi74m/J/6e+Hvi74m/J/6e+Hvi
74m/J/6e+L0PbiT+kfhH4h+JfyT+kfhH4h+JfyT+kfhH4h+JfyT+kfhH4j+6
8LyJt/A23sG7eA/vL7SzufC8hbfxDt7Fe3h/IS7b2Vp43sY7eBfv4X3+H79X
47Rdn3fwLt7D+3zOfvR7NU7b9XkX7+F9/p3jxn70ezVO2/V5D+/zuuPUcWM/
+r0ap+36vM/z0nXhOHXc2I9+r8Zpu+Z986B5YWmedN1gHjWvOK+6zjDvmoec
h12XmKfNW87brmPM6+Y553nXPa4DzIvmBddJrhvMo+YR11WuM8y75h3XYa5L
zNPmKddtrmPM6+Y113mue1wHmAddF7pOct1g3nQd6brKdYZ51nWn6zDXJeZl
16mu21zHmMeX1rWu81z3uO9f2gdaF3BfaJ3AfaJ1A/eN1hHcR1pXcF9pncF9
pnUH953WIdyHWpdwX2qdwn2qdQv3rdYx3Mda13Bfa53Dfa51D/e91kHcB1sX
cV9sncR9snUT983WUdxHW1dxX22dxX22dRf33dZh3Idbl3Ffbp3Gfbp1G/ft
1nHcx1vXcV9vncd9/lLdZ637z73W/efvr3X/+fsfS92/9POBd8/vzgXX+37w
et/P/P31vp/5++t9P/PPr/f9zD+/3vcz//x638/88x/qvp+SDw+8ey6P9Xc/
c6+/+5m/v/7uZ/7++ruf+efX3/3MP7/+7mf++fV3P/PPf6jf/Wxs/Av3zhV3

      "]]}, {}}, {}},
  AspectRatio->1,
  Axes->{True, True},
  AxesLabel->{None, None},
  AxesOrigin->{0, 0},
  DisplayFunction->Identity,
  Frame->{{False, False}, {False, False}},
  FrameLabel->{{None, None}, {None, None}},
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  ImagePadding->All,
  Method->{"CoordinatesToolOptions" -> {"DisplayFunction" -> ({
        (Part[{{Identity, Identity}, {Identity, Identity}}, 1, 2][#]& )[
         Part[#, 1]], 
        (Part[{{Identity, Identity}, {Identity, Identity}}, 2, 2][#]& )[
         Part[#, 2]]}& ), "CopiedValueFunction" -> ({
        (Part[{{Identity, Identity}, {Identity, Identity}}, 1, 2][#]& )[
         Part[#, 1]], 
        (Part[{{Identity, Identity}, {Identity, Identity}}, 2, 2][#]& )[
         Part[#, 2]]}& )}},
  PlotRange->{{0, 1.}, {0, 1.}},
  PlotRangeClipping->True,
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {
     Scaled[0.02], 
     Scaled[0.05]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{{3.674383785237936*^9, 3.674383806127042*^9}, 
   3.674383887506331*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"fullWeights", "[", 
   RowBox[{"3", ",", "3"}], "]"}], "//", "MatrixPlot"}]], "Input",
 CellChangeTimes->{{3.674409054990848*^9, 3.674409072415019*^9}}],

Cell[BoxData[
 GraphicsBox[RasterBox[CompressedData["
1:eJxTTMoPSmVmYGDghGIQ26Pxf3NL2lv7HQ+8ReZ8f2n/56deZnr3A/taa07j
NZ9f2yd9PvFo057H9jlRR7dLfN036MRJdT8DGHywf1glss794S0oHwYGjzip
4TDY3D/qr1F/DQb3j/prePtruNZfAMwQxT0=
   "], {{0, 0}, {9, 9}}, {0, 1}],
  Frame->True,
  FrameLabel->{None, None},
  FrameTicks->{{{{8.5, 
       FormBox["1", TraditionalForm]}, {7.5, 
       FormBox["2", TraditionalForm]}, {6.5, 
       FormBox["3", TraditionalForm]}, {5.5, 
       FormBox["4", TraditionalForm]}, {4.5, 
       FormBox["5", TraditionalForm]}, {3.5, 
       FormBox["6", TraditionalForm]}, {2.5, 
       FormBox["7", TraditionalForm]}, {1.5, 
       FormBox["8", TraditionalForm]}, {0.5, 
       FormBox["9", TraditionalForm]}}, {{8.5, 
       FormBox["1", TraditionalForm]}, {7.5, 
       FormBox["2", TraditionalForm]}, {6.5, 
       FormBox["3", TraditionalForm]}, {5.5, 
       FormBox["4", TraditionalForm]}, {4.5, 
       FormBox["5", TraditionalForm]}, {3.5, 
       FormBox["6", TraditionalForm]}, {2.5, 
       FormBox["7", TraditionalForm]}, {1.5, 
       FormBox["8", TraditionalForm]}, {0.5, 
       FormBox["9", TraditionalForm]}}}, {{{0.5, 
       FormBox["1", TraditionalForm]}, {1.5, 
       FormBox["2", TraditionalForm]}, {2.5, 
       FormBox["3", TraditionalForm]}, {3.5, 
       FormBox["4", TraditionalForm]}, {4.5, 
       FormBox["5", TraditionalForm]}, {5.5, 
       FormBox["6", TraditionalForm]}, {6.5, 
       FormBox["7", TraditionalForm]}, {7.5, 
       FormBox["8", TraditionalForm]}, {8.5, 
       FormBox["9", TraditionalForm]}}, {{0.5, 
       FormBox["1", TraditionalForm]}, {1.5, 
       FormBox["2", TraditionalForm]}, {2.5, 
       FormBox["3", TraditionalForm]}, {3.5, 
       FormBox["4", TraditionalForm]}, {4.5, 
       FormBox["5", TraditionalForm]}, {5.5, 
       FormBox["6", TraditionalForm]}, {6.5, 
       FormBox["7", TraditionalForm]}, {7.5, 
       FormBox["8", TraditionalForm]}, {8.5, 
       FormBox["9", TraditionalForm]}}}},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  Method->{
   "AxisPadding" -> Scaled[0.02], "DefaultBoundaryStyle" -> Automatic, 
    "DefaultPlotStyle" -> Automatic, "DomainPadding" -> Scaled[0.02], 
    "RangePadding" -> Scaled[0.05]}]], "Output",
 CellChangeTimes->{{3.674409061257125*^9, 3.6744090729508343`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"sparseWeights", "[", "3", "]"}], "//", "MatrixPlot"}]], "Input",
 CellChangeTimes->{{3.674383757490547*^9, 3.674383760517469*^9}, {
  3.674383819412747*^9, 3.674383840092225*^9}, {3.674408847890128*^9, 
  3.674408900050212*^9}}],

Cell[BoxData[
 GraphicsBox[RasterBox[CompressedData["
1:eJxTTMoPSmVmYGDghGIQe/u2D3tC3ly2f1QYqKvU9cj+qkqFs1ToK/u+l5ze
Nglv7BNcbhuWTn9qPyE4sEle8Jw9Axh8wKBxqR8q5g82eqDd/7BKZJ37w1tQ
PgwMX//Syv240ich82gd/sSaP5q/aEOP5i/quH+o1C+kmg8Aw9PdLg==
   "], {{0, 0}, {9, 
   9}}, {0, 1}],
  Frame->True,
  FrameLabel->{None, None},
  FrameTicks->{{{{8.5, 
       FormBox["1", TraditionalForm]}, {7.5, 
       FormBox["2", TraditionalForm]}, {6.5, 
       FormBox["3", TraditionalForm]}, {5.5, 
       FormBox["4", TraditionalForm]}, {4.5, 
       FormBox["5", TraditionalForm]}, {3.5, 
       FormBox["6", TraditionalForm]}, {2.5, 
       FormBox["7", TraditionalForm]}, {1.5, 
       FormBox["8", TraditionalForm]}, {0.5, 
       FormBox["9", TraditionalForm]}}, {{8.5, 
       FormBox["1", TraditionalForm]}, {7.5, 
       FormBox["2", TraditionalForm]}, {6.5, 
       FormBox["3", TraditionalForm]}, {5.5, 
       FormBox["4", TraditionalForm]}, {4.5, 
       FormBox["5", TraditionalForm]}, {3.5, 
       FormBox["6", TraditionalForm]}, {2.5, 
       FormBox["7", TraditionalForm]}, {1.5, 
       FormBox["8", TraditionalForm]}, {0.5, 
       FormBox["9", TraditionalForm]}}}, {{{0.5, 
       FormBox["1", TraditionalForm]}, {1.5, 
       FormBox["2", TraditionalForm]}, {2.5, 
       FormBox["3", TraditionalForm]}, {3.5, 
       FormBox["4", TraditionalForm]}, {4.5, 
       FormBox["5", TraditionalForm]}, {5.5, 
       FormBox["6", TraditionalForm]}, {6.5, 
       FormBox["7", TraditionalForm]}, {7.5, 
       FormBox["8", TraditionalForm]}, {8.5, 
       FormBox["9", TraditionalForm]}}, {{0.5, 
       FormBox["1", TraditionalForm]}, {1.5, 
       FormBox["2", TraditionalForm]}, {2.5, 
       FormBox["3", TraditionalForm]}, {3.5, 
       FormBox["4", TraditionalForm]}, {4.5, 
       FormBox["5", TraditionalForm]}, {5.5, 
       FormBox["6", TraditionalForm]}, {6.5, 
       FormBox["7", TraditionalForm]}, {7.5, 
       FormBox["8", TraditionalForm]}, {8.5, 
       FormBox["9", TraditionalForm]}}}},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  Method->{
   "AxisPadding" -> Scaled[0.02], "DefaultBoundaryStyle" -> Automatic, 
    "DefaultPlotStyle" -> Automatic, "DomainPadding" -> Scaled[0.02], 
    "RangePadding" -> Scaled[0.05]}]], "Output",
 CellChangeTimes->{{3.674383757849*^9, 3.674383760938149*^9}, {
  3.674383820158531*^9, 3.674383840432247*^9}, {3.674408845768347*^9, 
  3.6744089006160507`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"sparseWeights", "[", "6", "]"}], "//", "MatrixPlot"}]], "Input",
 CellChangeTimes->{{3.674349245661272*^9, 3.674349266149034*^9}, 
   3.674385173331133*^9, 3.6743854322051888`*^9}],

Cell[BoxData[
 GraphicsBox[RasterBox[CompressedData["
1:eJzt3U9ol2UcAPChxy6CgZdGTkps7BaYHuRh5WWkBxWiQ6eBdAmGsIuDivkv
LME6dAhCj4KeZJbhbEeRoOzHMKrhwclkmy4VhAhWRNLhhYdXeuN9fd53z2cw
PjuMd1++fPk+39/e93mfgdGx/QfX9/X1Df/7/c/P4/u2DZ7YcTMcO33qxszQ
nXB368TqyMByCJ98Or26shJeOPfy1NHf74X+w+c+W5pZCH1Pvh5Glv3+ax9M
//XG5YWw6btNH/42vBx+fuu5rya+uF/b9S+suz7f3/9LuPbNK+9+/vxC+Pbk
3qFfjy91Jv5dk5Pzjw70wpntc4uLu2+Hqc3jvStX5f9Zxb9/9L3vh8d+CFOz
s19eungrPPhzz9ir79/rTPxdz7/6Txt/Xf2fJLk21P/J2DdnDx96Z+dKeH1k
/cd/7FkKJx+PXt5y9lbyuMiUWi9IMk+r/v8qdby5aF5lzqr/tNZ1/4IkuTbU
/8lY8yoZa70gyTyt+vxt6nj/q+a9tHY9/+qfOee/rv0XJMm1of5PxnZ93iOb
0HpBknlq/0I7Na8yZ9V/Wu1fIEkW1f/JWPMqGWu9IMk8rfr+87r+btfnsabj
b/r5efl/umXnL3Ql/qZV/2ltOv66zr8gSa4N9X8ytuvzJNmE1guSzFP7F9qp
eZU5q/7Tav8CSbKo/k/GmlfJWOsFSeap8xco/7Hqnznn3/kLJMmi+j8Z2/V5
j2xC6wVJ5qn9C+3UvMqcVf9ptX+BJFlU/ydjzatkrPWCJPO0rP9Xff980/NV
1etXff68bfHLf9r4B188cr534ccwuuHtnZeu/xTmNr709fRH5ffX2hZ/1/Ov
/tuZf58XSDJP9X8y1v0FMtZ6QZJ5av9COzWvMmfVf1rtXyBJFtX/yVjzKhlr
vSDJPHX+AuU/Vv0z5/w7f4EkWVT/J2O7Pu+RTWi9IMk8tX+hnZpXmbPqP632
L5Aki+r/ZKx5lYy1XpBknpb1/12Tk/OPDvTCme1zi4u7b4epzeO9K1eXa/u7
XZ/Hmo6/6efn5f/pVn3/f9vib1r1n9am4y/r/z4vkGSe6v9kbNfnSbIJrRck
maf2L7RT8ypzVv2n1f4FkmRR/Z+MNa+SsdYLksxT5y9Q/mPVP3POv/MXSJJF
9X8ytuvzHtmE1guSzFP7F9qpeZU5q/7Tav8CSbKo/k/GmlfJWOsFSeZpWf8f
37dt8MSOm+HY6VM3ZobuhLtbJ1ZHBqq/f7vq/Yu6rl/X87ep4q/r/efy//+u
X3b+Qlfi73r+1X/a+Mv6/99Goj2O
   "], {{0, 0}, {65, 65}}, {0, 1}],
  Frame->True,
  FrameLabel->{None, None},
  FrameTicks->{{{{64.5, 
       FormBox["1", TraditionalForm]}, {45.5, 
       FormBox["20", TraditionalForm]}, {25.5, 
       FormBox["40", TraditionalForm]}, {0.5, 
       FormBox["65", TraditionalForm]}}, {{64.5, 
       FormBox["1", TraditionalForm]}, {45.5, 
       FormBox["20", TraditionalForm]}, {25.5, 
       FormBox["40", TraditionalForm]}, {0.5, 
       FormBox["65", TraditionalForm]}}}, {{{0.5, 
       FormBox["1", TraditionalForm]}, {19.5, 
       FormBox["20", TraditionalForm]}, {39.5, 
       FormBox["40", TraditionalForm]}, {64.5, 
       FormBox["65", TraditionalForm]}}, {{0.5, 
       FormBox["1", TraditionalForm]}, {19.5, 
       FormBox["20", TraditionalForm]}, {39.5, 
       FormBox["40", TraditionalForm]}, {64.5, 
       FormBox["65", TraditionalForm]}}}},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  ImageSize->{488.48828125, Automatic},
  Method->{
   "AxisPadding" -> Scaled[0.02], "DefaultBoundaryStyle" -> Automatic, 
    "DefaultPlotStyle" -> Automatic, "DomainPadding" -> Scaled[0.02], 
    "RangePadding" -> Scaled[0.05]}]], "Output",
 CellChangeTimes->{{3.674349254915304*^9, 3.674349267002249*^9}, 
   3.674349457487461*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ListPlot", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"n", "+", 
          RowBox[{"Log", "[", "n", "]"}]}], ",", 
         RowBox[{"Log2", "[", 
          RowBox[{"Abs", "[", 
           RowBox[{
            RowBox[{"sparseIntegrateByCoefficients", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"Sin", "[", 
                  RowBox[{"#1", "+", "#2"}], "]"}], "^", "2"}], " ", 
                RowBox[{"Cos", "[", "#2", "]"}]}], "&"}], ",", "n"}], "]"}], 
            "-", 
            RowBox[{"NIntegrate", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"Sin", "[", 
                 RowBox[{"x", "+", "y"}], "]"}], "^", "2"}], " ", 
               RowBox[{"Cos", "[", "y", "]"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"x", ",", "0", ",", "1"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"y", ",", "0", ",", "1"}], "}"}]}], "]"}]}], "]"}], 
          "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"n", ",", "1", ",", "11"}], "}"}]}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"2", "n"}], ",", 
         RowBox[{"Log2", "[", 
          RowBox[{"Abs", "[", 
           RowBox[{
            RowBox[{"fullIntegrate", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"Sin", "[", 
                  RowBox[{"#1", "+", "#2"}], "]"}], "^", "2"}], " ", 
                RowBox[{"Cos", "[", "#2", "]"}]}], "&"}], ",", "n", ",", 
              "n"}], "]"}], "-", 
            RowBox[{"NIntegrate", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"Sin", "[", 
                 RowBox[{"x", "+", "y"}], "]"}], "^", "2"}], " ", 
               RowBox[{"Cos", "[", "y", "]"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"x", ",", "0", ",", "1"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"y", ",", "0", ",", "1"}], "}"}]}], "]"}]}], "]"}], 
          "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"n", ",", "1", ",", "7"}], "}"}]}], "]"}]}], "}"}], ",", 
   RowBox[{"PlotLegends", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"\"\<Sparse\>\"", ",", "\"\<Full\>\""}], "}"}]}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.6743494897935877`*^9, 3.674349615806271*^9}, {
   3.674349687289466*^9, 3.674349828915866*^9}, {3.67434986121902*^9, 
   3.674349861475604*^9}, {3.674349907267458*^9, 3.674349949932585*^9}, {
   3.6743501755787086`*^9, 3.674350178575008*^9}, 3.674350302885648*^9}],

Cell[BoxData[
 TemplateBox[{GraphicsBox[{{}, {{{}, {
        Hue[0.67, 0.6, 0.6], 
        Directive[
         PointSize[0.012833333333333334`], 
         RGBColor[0.368417, 0.506779, 0.709798], 
         AbsoluteThickness[1.6]], 
        PointBox[{{1., -4.1089359451127985`}, {
         2.6931471805599454`, -5.658397994167354}, {
         4.09861228866811, -7.32210118482126}, {
         5.386294361119891, -9.050377660835194}, {
         6.6094379124341005`, -10.821885092258304`}, {
         7.791759469228055, -12.62467695956834}, {
         8.945910149055313, -14.45120605769245}, {
         10.079441541679836`, -16.29636569384718}, {
         11.19722457733622, -18.156527662458057`}, {
         12.302585092994045`, -20.028993591493823`}, {
         13.39789527279837, -21.911600654938496`}}]}, {
        Hue[0.9060679774997897, 0.6, 0.6], 
        Directive[
         PointSize[0.012833333333333334`], 
         RGBColor[0.880722, 0.611041, 0.142051], 
         AbsoluteThickness[1.6]], 
        PointBox[{{2., -4.763611594354826}, {4., -6.739361105137939}, {
         6., -8.73371678946939}, {8., -10.732329941278685`}, {
         10., -12.731984244815957`}, {12., -14.731895992823363`}, {
         14., -16.731866252197882`}}]}, {}}}, {}}, {
    DisplayFunction -> Identity, PlotRangePadding -> {{
        Scaled[0.02], 
        Scaled[0.02]}, {
        Scaled[0.05], 
        Scaled[0.02]}}, AxesOrigin -> {0, 0}, 
     PlotRange -> {{0, 14.}, {-21.911600654938496`, 0}}, PlotRangeClipping -> 
     True, ImagePadding -> All, DisplayFunction -> Identity, AspectRatio -> 
     NCache[GoldenRatio^(-1), 0.6180339887498948], Axes -> {True, True}, 
     AxesLabel -> {None, None}, AxesOrigin -> {0, 0}, DisplayFunction :> 
     Identity, Frame -> {{False, False}, {False, False}}, 
     FrameLabel -> {{None, None}, {None, None}}, 
     FrameTicks -> {{Automatic, Automatic}, {Automatic, Automatic}}, 
     GridLines -> {None, None}, GridLinesStyle -> Directive[
       GrayLevel[0.5, 0.4]], 
     Method -> {"CoordinatesToolOptions" -> {"DisplayFunction" -> ({
           (Part[{{Identity, Identity}, {Identity, Identity}}, 1, 2][#]& )[
            Part[#, 1]], 
           (Part[{{Identity, Identity}, {Identity, Identity}}, 2, 2][#]& )[
            Part[#, 2]]}& ), "CopiedValueFunction" -> ({
           (Part[{{Identity, Identity}, {Identity, Identity}}, 1, 2][#]& )[
            Part[#, 1]], 
           (Part[{{Identity, Identity}, {Identity, Identity}}, 2, 2][#]& )[
            Part[#, 2]]}& )}}, 
     PlotRange -> {{0, 14.}, {-21.911600654938496`, 0}}, PlotRangeClipping -> 
     True, PlotRangePadding -> {{
        Scaled[0.02], 
        Scaled[0.02]}, {
        Scaled[0.05], 
        Scaled[0.02]}}, Ticks -> {Automatic, Automatic}}],FormBox[
    FormBox[
     TemplateBox[{"\"Sparse\"", "\"Full\""}, "PointLegend", 
      DisplayFunction -> (FormBox[
        StyleBox[
         StyleBox[
          PaneBox[
           TagBox[
            GridBox[{{
               TagBox[
                GridBox[{{
                   GraphicsBox[{{}, {
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.462], 
                    RGBColor[0.368417, 0.506779, 0.709798], 
                    AbsoluteThickness[1.6]], {
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.462], 
                    RGBColor[0.368417, 0.506779, 0.709798], 
                    AbsoluteThickness[1.6]], 
                    PointBox[
                    NCache[{
                    Scaled[{
                    Rational[1, 2], 
                    Rational[1, 2]}]}, {
                    Scaled[{0.5, 0.5}]}]]}}}, AspectRatio -> Full, 
                    ImageSize -> {10, 10}, PlotRangePadding -> None, 
                    ImagePadding -> Automatic, 
                    BaselinePosition -> (Scaled[0.1] -> Baseline)], #}, {
                   GraphicsBox[{{}, {
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.462], 
                    RGBColor[0.880722, 0.611041, 0.142051], 
                    AbsoluteThickness[1.6]], {
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.462], 
                    RGBColor[0.880722, 0.611041, 0.142051], 
                    AbsoluteThickness[1.6]], 
                    PointBox[
                    NCache[{
                    Scaled[{
                    Rational[1, 2], 
                    Rational[1, 2]}]}, {
                    Scaled[{0.5, 0.5}]}]]}}}, AspectRatio -> Full, 
                    ImageSize -> {10, 10}, PlotRangePadding -> None, 
                    ImagePadding -> Automatic, 
                    BaselinePosition -> (Scaled[0.1] -> Baseline)], #2}}, 
                 GridBoxAlignment -> {
                  "Columns" -> {Center, Left}, "Rows" -> {{Baseline}}}, 
                 AutoDelete -> False, 
                 GridBoxDividers -> {
                  "Columns" -> {{False}}, "Rows" -> {{False}}}, 
                 GridBoxItemSize -> {"Columns" -> {{All}}, "Rows" -> {{All}}},
                  GridBoxSpacings -> {
                  "Columns" -> {{0.5}}, "Rows" -> {{0.8}}}], "Grid"]}}, 
             GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
             AutoDelete -> False, 
             GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{1}}, "Rows" -> {{0}}}], 
            "Grid"], Alignment -> Left, AppearanceElements -> None, 
           ImageMargins -> {{5, 5}, {5, 5}}, ImageSizeAction -> 
           "ResizeToFit"], LineIndent -> 0, StripOnInput -> False], {
         FontFamily -> "Arial"}, Background -> Automatic, StripOnInput -> 
         False], TraditionalForm]& ), 
      InterpretationFunction :> (RowBox[{"PointLegend", "[", 
         RowBox[{
           RowBox[{"{", 
             RowBox[{
               RowBox[{"Directive", "[", 
                 RowBox[{
                   RowBox[{"PointSize", "[", "0.012833333333333334`", "]"}], 
                   ",", 
                   InterpretationBox[
                    ButtonBox[
                    TooltipBox[
                    GraphicsBox[{{
                    GrayLevel[0], 
                    RectangleBox[{0, 0}]}, {
                    GrayLevel[0], 
                    RectangleBox[{1, -1}]}, {
                    RGBColor[0.368417, 0.506779, 0.709798], 
                    RectangleBox[{0, -1}, {2, 1}]}}, AspectRatio -> 1, Frame -> 
                    True, FrameStyle -> 
                    RGBColor[
                    0.24561133333333335`, 0.3378526666666667, 
                    0.4731986666666667], FrameTicks -> None, PlotRangePadding -> 
                    None, ImageSize -> 
                    Dynamic[{
                    Automatic, 
                    1.35 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                    Magnification])}]], 
                    "RGBColor[0.368417, 0.506779, 0.709798]"], Appearance -> 
                    None, BaseStyle -> {}, BaselinePosition -> Baseline, 
                    DefaultBaseStyle -> {}, ButtonFunction :> 
                    With[{Typeset`box$ = EvaluationBox[]}, 
                    If[
                    Not[
                    AbsoluteCurrentValue["Deployed"]], 
                    SelectionMove[Typeset`box$, All, Expression]; 
                    FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
                    FrontEnd`Private`$ColorSelectorInitialColor = 
                    RGBColor[0.368417, 0.506779, 0.709798]; 
                    FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
                    MathLink`CallFrontEnd[
                    FrontEnd`AttachCell[Typeset`box$, 
                    FrontEndResource["RGBColorValueSelector"], {
                    0, {Left, Bottom}}, {Left, Top}, 
                    "ClosingActions" -> {
                    "SelectionDeparture", "ParentChanged", 
                    "EvaluatorQuit"}]]]], BaseStyle -> Inherited, Evaluator -> 
                    Automatic, Method -> "Preemptive"], 
                    RGBColor[0.368417, 0.506779, 0.709798], Editable -> False,
                     Selectable -> False], ",", 
                   RowBox[{"AbsoluteThickness", "[", "1.6`", "]"}]}], "]"}], 
               ",", 
               RowBox[{"Directive", "[", 
                 RowBox[{
                   RowBox[{"PointSize", "[", "0.012833333333333334`", "]"}], 
                   ",", 
                   InterpretationBox[
                    ButtonBox[
                    TooltipBox[
                    GraphicsBox[{{
                    GrayLevel[0], 
                    RectangleBox[{0, 0}]}, {
                    GrayLevel[0], 
                    RectangleBox[{1, -1}]}, {
                    RGBColor[0.880722, 0.611041, 0.142051], 
                    RectangleBox[{0, -1}, {2, 1}]}}, AspectRatio -> 1, Frame -> 
                    True, FrameStyle -> 
                    RGBColor[
                    0.587148, 0.40736066666666665`, 0.09470066666666668], 
                    FrameTicks -> None, PlotRangePadding -> None, ImageSize -> 
                    Dynamic[{
                    Automatic, 
                    1.35 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                    Magnification])}]], 
                    "RGBColor[0.880722, 0.611041, 0.142051]"], Appearance -> 
                    None, BaseStyle -> {}, BaselinePosition -> Baseline, 
                    DefaultBaseStyle -> {}, ButtonFunction :> 
                    With[{Typeset`box$ = EvaluationBox[]}, 
                    If[
                    Not[
                    AbsoluteCurrentValue["Deployed"]], 
                    SelectionMove[Typeset`box$, All, Expression]; 
                    FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
                    FrontEnd`Private`$ColorSelectorInitialColor = 
                    RGBColor[0.880722, 0.611041, 0.142051]; 
                    FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
                    MathLink`CallFrontEnd[
                    FrontEnd`AttachCell[Typeset`box$, 
                    FrontEndResource["RGBColorValueSelector"], {
                    0, {Left, Bottom}}, {Left, Top}, 
                    "ClosingActions" -> {
                    "SelectionDeparture", "ParentChanged", 
                    "EvaluatorQuit"}]]]], BaseStyle -> Inherited, Evaluator -> 
                    Automatic, Method -> "Preemptive"], 
                    RGBColor[0.880722, 0.611041, 0.142051], Editable -> False,
                     Selectable -> False], ",", 
                   RowBox[{"AbsoluteThickness", "[", "1.6`", "]"}]}], "]"}]}],
              "}"}], ",", 
           RowBox[{"{", 
             RowBox[{#, ",", #2}], "}"}], ",", 
           RowBox[{"LegendMarkers", "\[Rule]", 
             RowBox[{"{", 
               RowBox[{
                 RowBox[{"{", 
                   RowBox[{"False", ",", "Automatic"}], "}"}], ",", 
                 RowBox[{"{", 
                   RowBox[{"False", ",", "Automatic"}], "}"}]}], "}"}]}], ",", 
           RowBox[{"Joined", "\[Rule]", 
             RowBox[{"{", 
               RowBox[{"False", ",", "False"}], "}"}]}], ",", 
           RowBox[{"LabelStyle", "\[Rule]", 
             RowBox[{"{", "}"}]}], ",", 
           RowBox[{"LegendLayout", "\[Rule]", "\"Column\""}]}], "]"}]& ), 
      Editable -> True], TraditionalForm], TraditionalForm]},
  "Legended",
  DisplayFunction->(GridBox[{{
      TagBox[
       ItemBox[
        PaneBox[
         TagBox[#, "SkipImageSizeLevel"], Alignment -> {Center, Baseline}, 
         BaselinePosition -> Baseline], DefaultBaseStyle -> "Labeled"], 
       "SkipImageSizeLevel"], 
      ItemBox[#2, DefaultBaseStyle -> "LabeledLabel"]}}, 
    GridBoxAlignment -> {"Columns" -> {{Center}}, "Rows" -> {{Center}}}, 
    AutoDelete -> False, GridBoxItemSize -> Automatic, 
    BaselinePosition -> {1, 1}]& ),
  Editable->True,
  InterpretationFunction->(RowBox[{"Legended", "[", 
     RowBox[{#, ",", 
       RowBox[{"Placed", "[", 
         RowBox[{#2, ",", "After"}], "]"}]}], "]"}]& )]], "Output",
 CellChangeTimes->{3.6743502165191383`*^9, 3.674350307808806*^9}]
}, Open  ]],

Cell["\<\
The integration for the sparse grid is working just as we want. \
\>", "Text",
 CellChangeTimes->{{3.674349898440906*^9, 3.674349905492669*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"sparseWeights", "[", "5", "]"}], "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.674322477136107*^9, 3.674322498450766*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"-", "0.03125`"}], "0.015625`", "0.`", "0.015625`", 
      RowBox[{"-", "0.015625`"}], "0.015625`", "0.`", "0.015625`", 
      RowBox[{"-", "0.03125`"}], "0.015625`", "0.`", "0.015625`", 
      RowBox[{"-", "0.015625`"}], "0.015625`", "0.`", "0.015625`", 
      RowBox[{"-", "0.046875`"}], "0.015625`", "0.`", "0.015625`", 
      RowBox[{"-", "0.015625`"}], "0.015625`", "0.`", "0.015625`", 
      RowBox[{"-", "0.03125`"}], "0.015625`", "0.`", "0.015625`", 
      RowBox[{"-", "0.015625`"}], "0.015625`", "0.`", "0.015625`", 
      RowBox[{"-", "0.03125`"}]},
     {"0.015625`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.`", "0.`", "0.`", "0.015625`"},
     {"0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.03125`", "0.`", "0.`", 
      "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.`", "0.`", "0.`", "0.`"},
     {"0.015625`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.`", "0.`", "0.`", "0.015625`"},
     {
      RowBox[{"-", "0.015625`"}], "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.`", "0.03125`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.03125`", 
      "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      RowBox[{"-", "0.015625`"}]},
     {"0.015625`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.`", "0.`", "0.`", "0.015625`"},
     {"0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.03125`", "0.`", "0.`", 
      "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.`", "0.`", "0.`", "0.`"},
     {"0.015625`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.`", "0.`", "0.`", "0.015625`"},
     {
      RowBox[{"-", "0.03125`"}], "0.`", "0.`", "0.`", "0.03125`", "0.`", 
      "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.03125`", "0.`", "0.`", 
      "0.`", 
      RowBox[{"-", "0.03125`"}], "0.`", "0.`", "0.`", "0.03125`", "0.`", 
      "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.03125`", "0.`", "0.`", 
      "0.`", 
      RowBox[{"-", "0.03125`"}]},
     {"0.015625`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.`", "0.`", "0.`", "0.015625`"},
     {"0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.03125`", "0.`", "0.`", 
      "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.`", "0.`", "0.`", "0.`"},
     {"0.015625`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.`", "0.`", "0.`", "0.015625`"},
     {
      RowBox[{"-", "0.015625`"}], "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.`", "0.03125`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.03125`", 
      "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      RowBox[{"-", "0.015625`"}]},
     {"0.015625`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.`", "0.`", "0.`", "0.015625`"},
     {"0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.03125`", "0.`", "0.`", 
      "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.`", "0.`", "0.`", "0.`"},
     {"0.015625`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.`", "0.`", "0.`", "0.015625`"},
     {
      RowBox[{"-", "0.046875`"}], "0.`", "0.03125`", "0.`", "0.`", "0.`", 
      "0.03125`", "0.`", 
      RowBox[{"-", "0.03125`"}], "0.`", "0.03125`", "0.`", "0.`", "0.`", 
      "0.03125`", "0.`", 
      RowBox[{"-", "0.0625`"}], "0.`", "0.03125`", "0.`", "0.`", "0.`", 
      "0.03125`", "0.`", 
      RowBox[{"-", "0.03125`"}], "0.`", "0.03125`", "0.`", "0.`", "0.`", 
      "0.03125`", "0.`", 
      RowBox[{"-", "0.046875`"}]},
     {"0.015625`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.`", "0.`", "0.`", "0.015625`"},
     {"0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.03125`", "0.`", "0.`", 
      "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.`", "0.`", "0.`", "0.`"},
     {"0.015625`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.`", "0.`", "0.`", "0.015625`"},
     {
      RowBox[{"-", "0.015625`"}], "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.`", "0.03125`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.03125`", 
      "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      RowBox[{"-", "0.015625`"}]},
     {"0.015625`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.`", "0.`", "0.`", "0.015625`"},
     {"0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.03125`", "0.`", "0.`", 
      "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.`", "0.`", "0.`", "0.`"},
     {"0.015625`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.`", "0.`", "0.`", "0.015625`"},
     {
      RowBox[{"-", "0.03125`"}], "0.`", "0.`", "0.`", "0.03125`", "0.`", 
      "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.03125`", "0.`", "0.`", 
      "0.`", 
      RowBox[{"-", "0.03125`"}], "0.`", "0.`", "0.`", "0.03125`", "0.`", 
      "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.03125`", "0.`", "0.`", 
      "0.`", 
      RowBox[{"-", "0.03125`"}]},
     {"0.015625`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.`", "0.`", "0.`", "0.015625`"},
     {"0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.03125`", "0.`", "0.`", 
      "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.`", "0.`", "0.`", "0.`"},
     {"0.015625`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.`", "0.`", "0.`", "0.015625`"},
     {
      RowBox[{"-", "0.015625`"}], "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.`", "0.03125`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.03125`", 
      "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      RowBox[{"-", "0.015625`"}]},
     {"0.015625`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.`", "0.`", "0.`", "0.015625`"},
     {"0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.03125`", "0.`", "0.`", 
      "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.`", "0.`", "0.`", "0.`"},
     {"0.015625`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.`", "0.`", "0.`", "0.015625`"},
     {
      RowBox[{"-", "0.03125`"}], "0.015625`", "0.`", "0.015625`", 
      RowBox[{"-", "0.015625`"}], "0.015625`", "0.`", "0.015625`", 
      RowBox[{"-", "0.03125`"}], "0.015625`", "0.`", "0.015625`", 
      RowBox[{"-", "0.015625`"}], "0.015625`", "0.`", "0.015625`", 
      RowBox[{"-", "0.046875`"}], "0.015625`", "0.`", "0.015625`", 
      RowBox[{"-", "0.015625`"}], "0.015625`", "0.`", "0.015625`", 
      RowBox[{"-", "0.03125`"}], "0.015625`", "0.`", "0.015625`", 
      RowBox[{"-", "0.015625`"}], "0.015625`", "0.`", "0.015625`", 
      RowBox[{"-", "0.03125`"}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.674322481483715*^9, 3.674322519119117*^9}}]
}, Open  ]]
}, Open  ]]
},
WindowSize->{733, 660},
WindowMargins->{{51, Automatic}, {Automatic, 0}},
FrontEndVersion->"10.4 for Mac OS X x86 (32-bit, 64-bit Kernel) (February 25, \
2016)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 327, 5, 63, "Input"],
Cell[CellGroupData[{
Cell[910, 29, 684, 13, 28, "Input"],
Cell[1597, 44, 1737, 40, 374, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[3371, 89, 426, 5, 44, "Subsection"],
Cell[3800, 96, 592, 12, 80, "Input"],
Cell[CellGroupData[{
Cell[4417, 112, 866, 22, 46, "Input"],
Cell[5286, 136, 4256, 149, 248, "Output"]
}, Open  ]],
Cell[9557, 288, 3327, 88, 258, "Input"],
Cell[12887, 378, 1488, 35, 63, "Input"],
Cell[CellGroupData[{
Cell[14400, 417, 297, 7, 28, "Input"],
Cell[14700, 426, 262, 5, 28, "Output"]
}, Open  ]],
Cell[14977, 434, 653, 19, 35, "Input"],
Cell[CellGroupData[{
Cell[15655, 457, 208, 4, 28, "Input"],
Cell[15866, 463, 640, 20, 47, "Output"]
}, Open  ]],
Cell[16521, 486, 1606, 45, 140, "Input"],
Cell[18130, 533, 561, 12, 63, "Input"],
Cell[CellGroupData[{
Cell[18716, 549, 353, 8, 28, "Input"],
Cell[19072, 559, 2762, 90, 97, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[21871, 654, 810, 24, 80, "Input"],
Cell[22684, 680, 3147, 88, 165, "Output"],
Cell[25834, 770, 1492, 28, 114, "Output"],
Cell[27329, 800, 3147, 88, 165, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[30525, 894, 415, 5, 44, "Subsection"],
Cell[30943, 901, 2161, 55, 119, "Input"],
Cell[CellGroupData[{
Cell[33129, 960, 654, 18, 46, "Input"],
Cell[33786, 980, 258, 3, 28, "Output"],
Cell[34047, 985, 259, 3, 28, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[34343, 993, 302, 5, 28, "Input"],
Cell[34648, 1000, 3526, 68, 378, "Output"]
}, Open  ]],
Cell[38189, 1071, 805, 23, 80, "Input"],
Cell[CellGroupData[{
Cell[39019, 1098, 152, 2, 28, "Input"],
Cell[39174, 1102, 1850, 51, 179, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[41061, 1158, 164, 3, 28, "Input"],
Cell[41228, 1163, 1214, 21, 97, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[42479, 1189, 340, 5, 28, "Input"],
Cell[42822, 1196, 3590, 68, 378, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[46449, 1269, 516, 13, 28, "Input"],
Cell[46968, 1284, 19681, 339, 1270, "Output"]
}, Open  ]],
Cell[66664, 1626, 788, 22, 72, "Input"],
Cell[CellGroupData[{
Cell[67477, 1652, 216, 4, 28, "Input"],
Cell[67696, 1658, 2368, 48, 206, "Output"]
}, Open  ]],
Cell[70079, 1709, 1164, 33, 99, "Input"],
Cell[CellGroupData[{
Cell[71268, 1746, 343, 8, 28, "Input"],
Cell[71614, 1756, 5015, 96, 374, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[76666, 1857, 187, 4, 28, "Input"],
Cell[76856, 1863, 2302, 51, 388, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[79195, 1919, 263, 5, 28, "Input"],
Cell[79461, 1926, 2421, 54, 388, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[81919, 1985, 215, 4, 28, "Input"],
Cell[82137, 1991, 2623, 52, 507, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[84797, 2048, 2859, 76, 182, "Input"],
Cell[87659, 2126, 12737, 266, 339, "Output"]
}, Open  ]],
Cell[100411, 2395, 154, 3, 30, "Text"],
Cell[CellGroupData[{
Cell[100590, 2402, 165, 3, 28, "Input"],
Cell[100758, 2407, 10705, 182, 573, "Output"]
}, Open  ]]
}, Open  ]]
}
]
*)

