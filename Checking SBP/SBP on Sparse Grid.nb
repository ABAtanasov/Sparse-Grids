(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.4' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     78238,       1929]
NotebookOptionsPosition[     75581,       1836]
NotebookOutlinePosition[     75938,       1852]
CellTagsIndexPosition[     75895,       1849]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{"NotebookEvaluate", "[", 
  "\"\<~/Documents/Sparse\\ Grids/Checking\\ SBP/Methods\\ and\\ Functions\\ \
for\\ SBP.nb\>\"", "]"}]], "Input",
 CellChangeTimes->{{3.673957641061926*^9, 3.673957757652383*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ListPlot", "[", 
  RowBox[{
   RowBox[{"Flatten", "[", 
    RowBox[{
     RowBox[{"makeSparse", "[", "2", "]"}], ",", "3"}], "]"}], ",", 
   RowBox[{"AspectRatio", "\[Rule]", "1"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.6741854141993227`*^9, 3.674185440287519*^9}, 
   3.674186286677113*^9, {3.674186555611705*^9, 3.6741865770868673`*^9}, {
   3.674186661074711*^9, 3.674186674855205*^9}, {3.674210407351513*^9, 
   3.67421046561594*^9}, {3.674210924717204*^9, 3.674210932749158*^9}, {
   3.674311932406857*^9, 3.674311974657675*^9}, {3.674313200051835*^9, 
   3.67431320377894*^9}, 3.674313998582395*^9}],

Cell[BoxData[
 GraphicsBox[{{}, {{}, 
    {RGBColor[0.368417, 0.506779, 0.709798], PointSize[0.012833333333333334`],
      AbsoluteThickness[1.6], 
     PointBox[{{0., 0.}, {0., 1.}, {1., 1.}, {1., 0.}, {0., 0.5}, {1., 0.5}, {
      0.5, 1.}, {0.5, 0.}, {0., 0.25}, {0., 0.75}, {1., 0.25}, {1., 0.75}, {
      0.5, 0.5}, {0.25, 1.}, {0.75, 1.}, {0.25, 0.}, {0.75, 0.}}]}, {}}, {}},
  AspectRatio->1,
  Axes->{True, True},
  AxesLabel->{None, None},
  AxesOrigin->{0, 0},
  DisplayFunction->Identity,
  Frame->{{False, False}, {False, False}},
  FrameLabel->{{None, None}, {None, None}},
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  ImagePadding->All,
  Method->{"CoordinatesToolOptions" -> {"DisplayFunction" -> ({
        (Part[{{Identity, Identity}, {Identity, Identity}}, 1, 2][#]& )[
         Part[#, 1]], 
        (Part[{{Identity, Identity}, {Identity, Identity}}, 2, 2][#]& )[
         Part[#, 2]]}& ), "CopiedValueFunction" -> ({
        (Part[{{Identity, Identity}, {Identity, Identity}}, 1, 2][#]& )[
         Part[#, 1]], 
        (Part[{{Identity, Identity}, {Identity, Identity}}, 2, 2][#]& )[
         Part[#, 2]]}& )}},
  PlotRange->{{0, 1.}, {0, 1.}},
  PlotRangeClipping->True,
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {
     Scaled[0.02], 
     Scaled[0.05]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{
  3.674210466444972*^9, {3.674210925387699*^9, 3.674210933758114*^9}, 
   3.674215419258349*^9, {3.6743119205633802`*^9, 3.674311974871004*^9}, {
   3.6743132003025837`*^9, 3.674313204049065*^9}, 3.674313998823415*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Finding the weights and then integrating", "Subsection",
 CellChangeTimes->{{3.673277052290266*^9, 3.673277061302971*^9}, {
  3.673277119209675*^9, 3.6732771212386723`*^9}, {3.673348508736053*^9, 
  3.673348513701818*^9}, {3.6737269924034224`*^9, 3.6737269925381393`*^9}, {
  3.6739173803011847`*^9, 3.6739173831779957`*^9}, {3.673976589259214*^9, 
  3.673976594082218*^9}, {3.674247233372534*^9, 3.674247236814432*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"Worth", " ", 
   RowBox[{"noting", ":", " ", 
    RowBox[{"it", " ", 
     RowBox[{"isn", "'"}], "t", " ", "necessary", " ", "to", " ", "find", " ",
      "the", " ", "weights", " ", "if", " ", "we", " ", "just", " ", 
     "integrate", " ", "in", " ", "our", " ", "sparse", " ", "coefficient", 
     " ", 
     RowBox[{"space", ".", " ", "This"}], " ", "is", " ", "equivalent", " ", 
     "and", " ", "computationally", " ", 
     RowBox[{"lighter", "."}]}]}]}], " ", "*)"}]], "Input",
 CellChangeTimes->{{3.67431203685369*^9, 3.674312083846321*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"switch3", "[", 
        RowBox[{"kx", ",", "i"}], "]"}], 
       RowBox[{"switch3", "[", 
        RowBox[{"ky", ",", "j"}], "]"}]}], "/.", 
      RowBox[{"kx", "\[Rule]", "3"}]}], "/.", 
     RowBox[{"ky", "\[Rule]", "3"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "0", ",", "8"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"j", ",", "0", ",", "8"}], "}"}]}], "]"}], "//", 
  "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.674210131636984*^9, 3.674210139084852*^9}, {
   3.674210225765791*^9, 3.6742102623055077`*^9}, {3.674210393585724*^9, 
   3.674210404534882*^9}, {3.674210602658564*^9, 3.674210602886882*^9}, 
   3.674212229685669*^9, {3.674212309034522*^9, 3.674212362006608*^9}, {
   3.674212415828302*^9, 3.674212418245373*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      FractionBox["1", "64"], 
      RowBox[{"-", 
       FractionBox["1", "64"]}], 
      FractionBox["1", "64"], 
      RowBox[{"-", 
       FractionBox["1", "64"]}], 
      FractionBox["1", "64"], 
      RowBox[{"-", 
       FractionBox["1", "64"]}], 
      FractionBox["1", "64"], 
      RowBox[{"-", 
       FractionBox["1", "64"]}], 
      FractionBox["1", "64"]},
     {
      RowBox[{"-", 
       FractionBox["1", "64"]}], 
      FractionBox["1", "64"], 
      RowBox[{"-", 
       FractionBox["1", "64"]}], 
      FractionBox["1", "64"], 
      RowBox[{"-", 
       FractionBox["1", "64"]}], 
      FractionBox["1", "64"], 
      RowBox[{"-", 
       FractionBox["1", "64"]}], 
      FractionBox["1", "64"], 
      RowBox[{"-", 
       FractionBox["1", "64"]}]},
     {
      FractionBox["1", "64"], 
      RowBox[{"-", 
       FractionBox["1", "64"]}], 
      FractionBox["1", "64"], 
      RowBox[{"-", 
       FractionBox["1", "64"]}], 
      FractionBox["1", "64"], 
      RowBox[{"-", 
       FractionBox["1", "64"]}], 
      FractionBox["1", "64"], 
      RowBox[{"-", 
       FractionBox["1", "64"]}], 
      FractionBox["1", "64"]},
     {
      RowBox[{"-", 
       FractionBox["1", "64"]}], 
      FractionBox["1", "64"], 
      RowBox[{"-", 
       FractionBox["1", "64"]}], 
      FractionBox["1", "64"], 
      RowBox[{"-", 
       FractionBox["1", "64"]}], 
      FractionBox["1", "64"], 
      RowBox[{"-", 
       FractionBox["1", "64"]}], 
      FractionBox["1", "64"], 
      RowBox[{"-", 
       FractionBox["1", "64"]}]},
     {
      FractionBox["1", "64"], 
      RowBox[{"-", 
       FractionBox["1", "64"]}], 
      FractionBox["1", "64"], 
      RowBox[{"-", 
       FractionBox["1", "64"]}], 
      FractionBox["1", "64"], 
      RowBox[{"-", 
       FractionBox["1", "64"]}], 
      FractionBox["1", "64"], 
      RowBox[{"-", 
       FractionBox["1", "64"]}], 
      FractionBox["1", "64"]},
     {
      RowBox[{"-", 
       FractionBox["1", "64"]}], 
      FractionBox["1", "64"], 
      RowBox[{"-", 
       FractionBox["1", "64"]}], 
      FractionBox["1", "64"], 
      RowBox[{"-", 
       FractionBox["1", "64"]}], 
      FractionBox["1", "64"], 
      RowBox[{"-", 
       FractionBox["1", "64"]}], 
      FractionBox["1", "64"], 
      RowBox[{"-", 
       FractionBox["1", "64"]}]},
     {
      FractionBox["1", "64"], 
      RowBox[{"-", 
       FractionBox["1", "64"]}], 
      FractionBox["1", "64"], 
      RowBox[{"-", 
       FractionBox["1", "64"]}], 
      FractionBox["1", "64"], 
      RowBox[{"-", 
       FractionBox["1", "64"]}], 
      FractionBox["1", "64"], 
      RowBox[{"-", 
       FractionBox["1", "64"]}], 
      FractionBox["1", "64"]},
     {
      RowBox[{"-", 
       FractionBox["1", "64"]}], 
      FractionBox["1", "64"], 
      RowBox[{"-", 
       FractionBox["1", "64"]}], 
      FractionBox["1", "64"], 
      RowBox[{"-", 
       FractionBox["1", "64"]}], 
      FractionBox["1", "64"], 
      RowBox[{"-", 
       FractionBox["1", "64"]}], 
      FractionBox["1", "64"], 
      RowBox[{"-", 
       FractionBox["1", "64"]}]},
     {
      FractionBox["1", "64"], 
      RowBox[{"-", 
       FractionBox["1", "64"]}], 
      FractionBox["1", "64"], 
      RowBox[{"-", 
       FractionBox["1", "64"]}], 
      FractionBox["1", "64"], 
      RowBox[{"-", 
       FractionBox["1", "64"]}], 
      FractionBox["1", "64"], 
      RowBox[{"-", 
       FractionBox["1", "64"]}], 
      FractionBox["1", "64"]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.674210404937331*^9, {3.674212335595639*^9, 3.674212339300922*^9}, 
   3.674212418570814*^9, 3.674215421854609*^9, 3.674247294563992*^9, 
   3.6743119375380096`*^9}]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"showFullWeights", "[", 
    RowBox[{"lx_", ",", "ly_"}], "]"}], ":=", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"weights1D", "[", 
         RowBox[{"i", ",", "kx", ",", "lx"}], "]"}], " ", 
        RowBox[{"weights1D", "[", 
         RowBox[{"j", ",", "ky", ",", "ly"}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "0", ",", 
         SuperscriptBox["2", "lx"]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "0", ",", 
         SuperscriptBox["2", "ly"]}], "}"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"kx", ",", "0", ",", "lx"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"ky", ",", "0", ",", "ly"}], "}"}]}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"showWeights", "[", "n_", "]"}], ":=", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"weights1D", "[", 
           RowBox[{"i", ",", 
            RowBox[{"getrow", "[", 
             RowBox[{"perp", ",", "diag"}], "]"}], ",", "n"}], "]"}], 
          RowBox[{"weights1D", "[", 
           RowBox[{"j", ",", 
            RowBox[{"getcol", "[", 
             RowBox[{"perp", ",", "diag"}], "]"}], ",", "n"}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "0", ",", 
           SuperscriptBox["2", "n"]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "0", ",", 
           SuperscriptBox["2", "n"]}], "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"perp", ",", "0", ",", 
         RowBox[{
          RowBox[{"endperp", "[", "diag", "]"}], "-", "1"}]}], "}"}]}], "]"}],
      ",", 
     RowBox[{"{", 
      RowBox[{"diag", ",", "0", ",", "n"}], "}"}]}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"showWeights", "[", 
   RowBox[{"n_", ",", "i_", ",", "j_"}], "]"}], ":=", 
  RowBox[{"Sum", "[", 
   RowBox[{
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"weights1D", "[", 
        RowBox[{"i", ",", 
         RowBox[{"getrow", "[", 
          RowBox[{"perp", ",", "diag"}], "]"}], ",", "n"}], "]"}], 
       RowBox[{"weights1D", "[", 
        RowBox[{"j", ",", 
         RowBox[{"getcol", "[", 
          RowBox[{"perp", ",", "diag"}], "]"}], ",", "n"}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"perp", ",", "0", ",", 
        RowBox[{
         RowBox[{"endperp", "[", "diag", "]"}], "-", "1"}]}], "}"}]}], "]"}], 
    ",", 
    RowBox[{"{", 
     RowBox[{"diag", ",", "0", ",", "n"}], "}"}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.674212959186309*^9, 3.674213010894856*^9}, {
  3.6742130955292463`*^9, 3.6742131042681503`*^9}, {3.674213634037966*^9, 
  3.674213711623679*^9}, {3.674213754365397*^9, 3.674213783774599*^9}, {
  3.6742139014989977`*^9, 3.6742139871733303`*^9}, {3.674214145516347*^9, 
  3.674214147942408*^9}, {3.674214352140171*^9, 3.674214363832533*^9}, {
  3.674215346088045*^9, 3.674215348790105*^9}, {3.674215528354673*^9, 
  3.674215579048233*^9}, {3.6742156126465273`*^9, 3.674215617679429*^9}, {
  3.674216613075181*^9, 3.674216614893382*^9}, {3.6742171730503607`*^9, 
  3.674217190906061*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"computeSum", "[", "n_", "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"posW", "[", 
        RowBox[{"i", "/", 
         RowBox[{"2", "^", "n"}]}], "]"}], 
       RowBox[{"posW", "[", 
        RowBox[{"j", "/", 
         RowBox[{"2", "^", "n"}]}], "]"}], 
       RowBox[{"#", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{"i", "+", "1"}], ",", 
          RowBox[{"j", "+", "1"}]}], "]"}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "0", ",", 
        RowBox[{"2", "^", "n"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", "0", ",", 
        RowBox[{"2", "^", "n"}]}], "}"}]}], "]"}], "&"}], "@", 
   RowBox[{"showWeights", "[", "n", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.674213002499382*^9, 3.674213073838463*^9}, {
   3.674213107085884*^9, 3.6742131287199783`*^9}, {3.674213609633521*^9, 
   3.6742136101452847`*^9}, {3.674213994156797*^9, 3.6742140114067583`*^9}, {
   3.674214172399877*^9, 3.674214172861906*^9}, {3.6742143684219522`*^9, 
   3.6742143746978283`*^9}, {3.6742144181695013`*^9, 3.674214420676528*^9}, {
   3.674214569720278*^9, 3.674214577434458*^9}, {3.6742148265140247`*^9, 
   3.674214882287836*^9}, {3.674215454514681*^9, 3.6742154548990498`*^9}, {
   3.674215628216836*^9, 3.674215712218191*^9}, {3.674215763741695*^9, 
   3.674215764024597*^9}, {3.674216030932959*^9, 3.674216118597665*^9}, 
   3.674216975299336*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Table", "[", 
  RowBox[{
   RowBox[{"computeSum", "[", "n", "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"n", ",", "0", ",", "6"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.674216120010367*^9, 3.6742161289190607`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1"}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.674216126149612*^9, 3.67421613134554*^9}, 
   3.67424730469333*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"weights1D", "[", 
   RowBox[{"i_", ",", "kx_", ",", "lx_"}], "]"}], ":=", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Mod", "[", 
      RowBox[{"i", ",", 
       SuperscriptBox["2", 
        RowBox[{"lx", "-", "kx"}]]}], "]"}], "\[Equal]", "0"}], ",", 
    RowBox[{"switch3", "[", 
     RowBox[{"kx", ",", 
      RowBox[{
       SuperscriptBox["2", 
        RowBox[{"kx", "-", "lx"}]], "i"}]}], "]"}], ",", "0"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.674214215951852*^9, 3.674214236340961*^9}, {
  3.674214267738717*^9, 3.674214293639688*^9}, {3.674214339125592*^9, 
  3.674214342627858*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"showFullWeights", "[", 
  RowBox[{"1", ",", "1"}], "]"}]], "Input",
 CellChangeTimes->{{3.674215596428933*^9, 3.674215600921118*^9}, {
  3.674216602912993*^9, 3.6742166037866077`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     FractionBox["1", "4"], ",", 
     FractionBox["1", "4"], ",", 
     FractionBox["1", "4"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     FractionBox["1", "4"], ",", 
     FractionBox["1", "4"], ",", 
     FractionBox["1", "4"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     FractionBox["1", "4"], ",", 
     FractionBox["1", "4"], ",", 
     FractionBox["1", "4"]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.67421560120735*^9, {3.6742166043062773`*^9, 3.674216617424471*^9}, 
   3.6742473087191887`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"computeSum2", "[", "n_", "]"}], ":=", 
  RowBox[{"Sum", "[", 
   RowBox[{
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"posW", "[", 
          RowBox[{
           RowBox[{"switch2", "[", 
            RowBox[{"getrow", "[", 
             RowBox[{"perp", ",", "diag"}], "]"}], "]"}], " ", "i"}], "]"}], 
         RowBox[{"posW", "[", 
          RowBox[{
           RowBox[{"switch2", "[", 
            RowBox[{"getcol", "[", 
             RowBox[{"perp", ",", "diag"}], "]"}], "]"}], " ", "j"}], "]"}], 
         " ", 
         RowBox[{"Sum", "[", "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          SuperscriptBox["2", 
           RowBox[{"switch", "[", 
            RowBox[{"getrow", "[", 
             RowBox[{"perp", ",", "diag"}], "]"}], "]"}]], ",", "2"}], "}"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "1", ",", 
          RowBox[{
           SuperscriptBox["2", 
            RowBox[{"switch", "[", 
             RowBox[{"getcol", "[", 
              RowBox[{"perp", ",", "diag"}], "]"}], "]"}]], "-", "1"}], ",", 
          "2"}], "}"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"perp", ",", 
        RowBox[{"-", "1"}], ",", 
        RowBox[{"endperp", "[", "diag", "]"}]}], "}"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"diag", ",", 
      RowBox[{"-", "1"}], ",", "n"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.6742169781811666`*^9, 3.674216982737797*^9}, {
  3.6742170486259727`*^9, 3.674217073679244*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Integrating By Coefficients", "Subsection",
 CellChangeTimes->{{3.673277052290266*^9, 3.673277061302971*^9}, {
  3.673277119209675*^9, 3.6732771212386723`*^9}, {3.673348508736053*^9, 
  3.673348513701818*^9}, {3.6737269924034224`*^9, 3.6737269925381393`*^9}, {
  3.6739173803011847`*^9, 3.6739173831779957`*^9}, {3.673976589259214*^9, 
  3.673976594082218*^9}, {3.6742472220539103`*^9, 3.674247225471348*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"sparseIntegrateByCoefficients", "[", 
   RowBox[{"f_", ",", "n_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", 
             RowBox[{
              RowBox[{"diag", "+", "2"}], ",", 
              RowBox[{"perp", "+", "2"}], ",", "i", ",", "j"}], "]"}], "]"}], 
           " ", 
           RowBox[{"area", "[", 
            RowBox[{"getrow", "[", 
             RowBox[{"perp", ",", "diag"}], "]"}], "]"}], " ", 
           RowBox[{"area", "[", 
            RowBox[{"getcol", "[", 
             RowBox[{"perp", ",", "diag"}], "]"}], "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            SuperscriptBox["2", 
             RowBox[{
              RowBox[{"switch", "[", 
               RowBox[{"getrow", "[", 
                RowBox[{"perp", ",", "diag"}], "]"}], "]"}], "-", "1"}]]}], 
           "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "1", ",", 
            SuperscriptBox["2", 
             RowBox[{
              RowBox[{"switch", "[", 
               RowBox[{"getcol", "[", 
                RowBox[{"perp", ",", "diag"}], "]"}], "]"}], "-", "1"}]]}], 
           "}"}]}], "]"}], "\[IndentingNewLine]", ",", 
        RowBox[{"{", 
         RowBox[{"perp", ",", 
          RowBox[{"-", "1"}], ",", 
          RowBox[{"endperp", "[", "diag", "]"}]}], "}"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"diag", ",", 
        RowBox[{"-", "1"}], ",", "n"}], "}"}]}], "]"}], "&"}], "@", 
   RowBox[{"sparseCoefficients2D", "[", 
    RowBox[{"f", ",", "n"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.6742348157765093`*^9, 3.674234852057425*^9}, {
   3.674234892162032*^9, 3.674234982839038*^9}, {3.674235017265462*^9, 
   3.674235019814867*^9}, {3.674235074052116*^9, 3.674235092262163*^9}, {
   3.67423513960469*^9, 3.674235141278442*^9}, {3.674235171494604*^9, 
   3.674235174858081*^9}, 3.674235258641075*^9, {3.674235450862471*^9, 
   3.6742354690892267`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"sparseIntegrateByCoefficients", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Cos", "[", 
      RowBox[{"#1", "+", "#2"}], "]"}], "&"}], ",", "10"}], "]"}], "//", 
  "N"}], "\[IndentingNewLine]", 
 RowBox[{"NIntegrate", "[", 
  RowBox[{
   RowBox[{"Cos", "[", 
    RowBox[{"x", "+", "y"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", "0", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"y", ",", "0", ",", "1"}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.674235097249342*^9, 3.674235127891021*^9}, {
  3.6742351599600697`*^9, 3.674235191927218*^9}, {3.67423561702699*^9, 
  3.674235622575564*^9}}],

Cell[BoxData["0.4967512734739072`"], "Output",
 CellChangeTimes->{{3.674235103404628*^9, 3.674235192277237*^9}, 
   3.674235259959548*^9, 3.6742354703233852`*^9, {3.6742356072184134`*^9, 
   3.674235624076528*^9}, 3.674247322308196*^9}],

Cell[BoxData["0.496751448303659`"], "Output",
 CellChangeTimes->{{3.674235103404628*^9, 3.674235192277237*^9}, 
   3.674235259959548*^9, 3.6742354703233852`*^9, {3.6742356072184134`*^9, 
   3.674235624076528*^9}, 3.6742473223172073`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"sparseW", "[", "3", "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.674235702033537*^9, 3.6742357071269608`*^9}, 
   3.674247450103891*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Out", "[", "283", "]"}], "//", "MatrixPlot"}]], "Input",
 CellChangeTimes->{{3.674235799861292*^9, 3.67423580952064*^9}, {
  3.674235840811994*^9, 3.674235843513061*^9}, {3.674235952363166*^9, 
  3.674235956460215*^9}, {3.674247332279873*^9, 3.6742473331012783`*^9}}],

Cell[BoxData[
 GraphicsBox[RasterBox[CompressedData["
1:eJztnH9MlVUYx+8SoxJcXcnNOWcFEpM1ndoP6trDhl3KLIl0zLRsJJsNyLTC
BmkSUK1RVlurxrTUzdZUaP6gmpmuq0hpy0IGUjG5MBXufe8c003EVRb2D9vD
+s7ndN7z3sPGvnB29uy855zPeZ7z89bCFflFo3w+35Qrv3///dqRHdU7BqNU
1f/6uSw6Q+9931F2R/kJenR+YsKuvQ4998fYwJqsCFU3Lo5sOdZNPzxy35x3
2x2iyePz1m+N0M5Y99aCaA8tW174RVmqQ6vbGgbvcs7QbaWZA2vTfyPfPz9n
/7NmBakmvDxGC0JZu3sPO/RR4tt5HWV9lP1QW0LGtBjtrMysPeREafaHr5xY
dbm8qH3VipaTq2fd3xEvqrr+Ob5Q7kJztxyc64/RyafTXt61LkrJS89N2p96
mhbmf1J1odKhH7/xpSxa2kdTgw+/GPi4Cy5n7rwV1aXnHbope9KyTeOiFE4v
KRxz3SlasvDuUfc/6FBmRX9kVk0vbdj20sXPQ53a2224Wu7cqbr4QvNz5dyX
O+aB0fNiVLV5xqdtTzhU/FPCB+mLe1le0PKbwp3ly53qNr5QO1z5G+e8cGh/
TYzSerKbB2fFqIluTnrn/QgbH6LlMSXOtNzpVVP4QsuPzu+4dLQ8HHdSXKtW
lEe3jSfxpqr5RflC53dcOlpOLs6UimNVq+XOnaqLLzQ/Or/j0tHym8Kd5cud
6ja+UDvo/I5LR8tjSpxpudOrpvDFKbqugq43cva5/Fz/1LUuIRU/oPWv+rtM
Ua/WD8odut7I2efym8Kd5UtW461+UH/E+Tu0f3J8oX5Tqh2l+LI6ssYbX2g9
cFxw/k6KO9RvSvElld/qkFq+RlapfTo0LlW9TmLXPYbU9PUHr6rUPh26DqN6
XyDeuLN8maVS+3S6uLN8Wb5MVKl9Ol1xple5s3x5W7n5L3efDp3foeszUt+F
9itTeERV1/le3d/tduXahbtPh87v0P0Iqe+KN+4sX2Yp114cF+j8TjV3li/L
l4nKtSMXB6LzO9Vxple5s3x5W/eM//XoLzOjtGBd4GKgtYemX2jaXjChGT7H
Utsz/9W08ijdWLv5swOX/Za/YeINU5uOwXa4/qBrHxbtn+i9eK7e/u9+4FaV
anf0nAZqHz03gnKHnp9UbUd1u6PxM2fH8jWyou3rNo6kvpfrVz/ntYRaNzq0
4ffEjOKjfVSwtmXa2d1h2H+h+3q64iLV7zm47d0Yt6lUu6vmVOrcI9cfuHUV
1H9x8ztTuLN8yarUPF0XR6h9NM5E40AuvuL6ITp/1HUeW+oek1fXN6TeFfFq
/Xg1zkT9C8qp7nYbrqaM/17lCFV0POfiTCnu0HtGUnxx+XVxZwpHUvUcb8rF
mWh8KPUetdS9V3T9EB03dLfbcFUdp0lxau/lDSnHHRp3SXGH2pfii8tv+vsS
nKr2d5avkXX988dnBguiVHHLhFDGuC5KPTjlwBuPrYbXW7j8qJ3SyoRtzqYo
XbPySP2+xlO0Mb+ktmJVC22vW1ny1t4IJbfnjL33cJjuqS8+/uy3DWK8c+lS
6zlS9+VNUdXtgq6Ho/Ma9B0S9J0ujguu/7c/XpwzscihS3UDfwb7e+lScuir
N9ecFKtn7h4EVx60ftD2Qs+XSr0/o5ubq1W0XVD/q5o71fZRf8Rxx3HBpXN8
of4C7c9ovUnxq3p8cFu/QjlC60f3uHK1qjrO5OJDjkfUvlfjTNVxjmrubBwu
y53ff/2elO+iFEwqSlqUc5qW+J8JV9a1UtH0a9sCnRG6s+vLgfNPdVPz6M7b
n5zxNRzHquYO7bdSXKjm2vR0tD65ezHcPhd3b5S7x42OS9x9VS6uQ/ni7HD5
0XgVnT+i7cW1C3ceAH1/hrPjtn7ltn6L5je9fjh/x/kvji/V65nofgfnR6Te
y5Xym+j9R6nxVnW/kooHvJr+b7zZVZ5Sn9vVceV/nw+NP7n8qB3UvhTvquNb
1eVUPc9VPV+Lt/L/BaCM9S8=
   "], {{0, 0}, {37, 37}}, {0, 1}],
  Frame->True,
  FrameLabel->{None, None},
  FrameTicks->{{{{36.5, 
       FormBox["1", TraditionalForm]}, {27.5, 
       FormBox["10", TraditionalForm]}, {17.5, 
       FormBox["20", TraditionalForm]}, {7.5, 
       FormBox["30", TraditionalForm]}, {0.5, 
       FormBox["37", TraditionalForm]}}, {{36.5, 
       FormBox["1", TraditionalForm]}, {27.5, 
       FormBox["10", TraditionalForm]}, {17.5, 
       FormBox["20", TraditionalForm]}, {7.5, 
       FormBox["30", TraditionalForm]}, {0.5, 
       FormBox["37", TraditionalForm]}}}, {{{0.5, 
       FormBox["1", TraditionalForm]}, {9.5, 
       FormBox["10", TraditionalForm]}, {19.5, 
       FormBox["20", TraditionalForm]}, {29.5, 
       FormBox["30", TraditionalForm]}, {36.5, 
       FormBox["37", TraditionalForm]}}, {{0.5, 
       FormBox["1", TraditionalForm]}, {9.5, 
       FormBox["10", TraditionalForm]}, {19.5, 
       FormBox["20", TraditionalForm]}, {29.5, 
       FormBox["30", TraditionalForm]}, {36.5, 
       FormBox["37", TraditionalForm]}}}},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  Method->{
   "AxisPadding" -> Scaled[0.02], "DefaultBoundaryStyle" -> Automatic, 
    "DefaultPlotStyle" -> Automatic, "DomainPadding" -> Scaled[0.02], 
    "RangePadding" -> Scaled[0.05]}]], "Output",
 CellChangeTimes->{
  3.674235824723208*^9, {3.6742359533758717`*^9, 3.674235956741428*^9}, 
   3.674247338281554*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"dxMatrixSparse", "[", "3", "]"}], "//", "MatrixPlot"}]], "Input",
 CellChangeTimes->{{3.674235983581699*^9, 3.674235997810317*^9}, {
  3.674247426092428*^9, 3.674247428441162*^9}}],

Cell[BoxData[
 GraphicsBox[RasterBox[CompressedData["
1:eJzt3F1Ik1EYB/BFUlQkUgalYfYhfVx4o2gS4wEJrIwuVkSIUQ1aCIWUXkRq
8FYUVBfRRRSIRVdlH2RFnxIkFl7lVmtEfrQpTN1XqUjGiiKyrjq0xfY+7/O+
/8H4bYONM875n/Oc7WxLnbWOvdNtNlvB1PXn7V+XTwR5zH1eV3O4rY9y7AW3
wruClPGtcUvHphB7u2BybtC+Hz/hitIjf2V28+cR+vqlsGbfGb/yce72Jqrv
gOtKVW+Qys8uuHppKESNWctfxuIR9nYlqt35pvNcRox8YxsnvZsjNLHWddHb
HKSc/bN3XmuL0OJpq6Mn40Fatur8xxmal7298O8mmyPp86pq3HK3K1Ff53X6
W/rf0va81vy5RwcptjL+bs/MkPj5xKxaLV9mVXq9YTVVOUK+jCn6xZiadf+V
KqXUXdivGVPUh/+nlH0c9mu8Il/WFPUJr9h/mVusX/qoqnOk1D8wtaLf9VE1
v2HegxBCCCGEEEIIIYQQQgjliu9ZIES+IJQo8gUh8gV5lX5eCOcPzaHqPLyj
+k6mI/yK3H0jJR9O99IFLbfh8vXwn+cFjmTfrgi8n7r/+8L/fv6l9PGJ84ey
XLPkWKvnhpucWTvK7nf5qGf+igdPT0Woo6J83qHiKC16XD2nvtRPhZVl3Znu
g+J/ByFlHGL9MqZWW49SpZRxi/WLV6utRxCmQ7umDYxu9VBLSc/w8PoA3cuv
9zxpD1HTullFN8fDtHu8a+Bu+yBtq3rxcOHEM/b2QihJVb642wWhGUS+YELj
RMi+Urr4XxprinzpI/IFjSA+N5Clqr+S7Uf0b2pFjnhFLswtPh/Qx2RzxN1e
qUrZZ2Gfoo9Yd4yp9HkP87ksVedhuF4n3UoZh8gRr5bLRZrrQyl1HeoiY4jz
zMgjcmo+05XrH3h+DB0=
   "], {{0, 0}, {37, 37}}, {0, 1}],
  Frame->True,
  FrameLabel->{None, None},
  FrameTicks->{{{{36.5, 
       FormBox["1", TraditionalForm]}, {27.5, 
       FormBox["10", TraditionalForm]}, {17.5, 
       FormBox["20", TraditionalForm]}, {7.5, 
       FormBox["30", TraditionalForm]}, {0.5, 
       FormBox["37", TraditionalForm]}}, {{36.5, 
       FormBox["1", TraditionalForm]}, {27.5, 
       FormBox["10", TraditionalForm]}, {17.5, 
       FormBox["20", TraditionalForm]}, {7.5, 
       FormBox["30", TraditionalForm]}, {0.5, 
       FormBox["37", TraditionalForm]}}}, {{{0.5, 
       FormBox["1", TraditionalForm]}, {9.5, 
       FormBox["10", TraditionalForm]}, {19.5, 
       FormBox["20", TraditionalForm]}, {29.5, 
       FormBox["30", TraditionalForm]}, {36.5, 
       FormBox["37", TraditionalForm]}}, {{0.5, 
       FormBox["1", TraditionalForm]}, {9.5, 
       FormBox["10", TraditionalForm]}, {19.5, 
       FormBox["20", TraditionalForm]}, {29.5, 
       FormBox["30", TraditionalForm]}, {36.5, 
       FormBox["37", TraditionalForm]}}}},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  Method->{
   "AxisPadding" -> Scaled[0.02], "DefaultBoundaryStyle" -> Automatic, 
    "DefaultPlotStyle" -> Automatic, "DomainPadding" -> Scaled[0.02], 
    "RangePadding" -> Scaled[0.05]}]], "Output",
 CellChangeTimes->{3.674247371191977*^9, 3.674247428956891*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"Out", "[", "283", "]"}], ".", 
     RowBox[{"Out", "[", "285", "]"}]}], "+", 
    RowBox[{"Transpose", "[", 
     RowBox[{
      RowBox[{"Out", "[", "283", "]"}], ".", 
      RowBox[{"Out", "[", "285", "]"}]}], "]"}]}], ")"}], "//", 
  "MatrixPlot"}]], "Input",
 CellChangeTimes->{{3.6742360032569838`*^9, 3.674236059673923*^9}, {
  3.674239779997561*^9, 3.6742397921626997`*^9}, {3.674247380665985*^9, 
  3.6742473868503103`*^9}}],

Cell[BoxData[
 GraphicsBox[RasterBox[CompressedData["
1:eJztXXlQlVUUhwhFwlCxBjWSHF6aQo0imLgcM1HRBEczTcMxMxfUwK1hE3FE
xV0UMEtNUWNGMFcmIVNEniRDQ2mguSA7vjURRRuVltG/nPnNdJh7+b7He8ww
Pzhz5/fud7/7u+ecu703ZoZP+NzBzs5O8+z3v7+f/tyhlsaCs66Ruh4VFH7O
s+G9jDoaG5EZccjVwOZJ6GZ/JHhqMa3f1c2hYVk5PcrtszezSS/MPnTLnFGu
2UZaUuS+r6ZbHXVyPJE62a5EevvIfi7ZdlHt8I3Xm6f82xnptJO29MSMCopJ
vpzzZHhUi/fX1oKidIfeC7IjHXHtSref2pH7XhCPbF1bGyrl747HDsrwOFdK
SyctCzIaq6hjpwzHl6t1bLvS7ad25L4Xm19rGVTK33H5ldId97lkt4NstPm1
p+g2tNS34IyJ8pzqU7sHGsgl8EB5rbmK3LPbu78UY6KtmoSCPoF6inScW6SZ
VMHmXxzacfgi+9u0INhNO2KTgTwLA67MnG6CdsSD9BvgOH1ljwGX6e/I0d+F
962kNfMME0IX6dnluc8rajxB7TAtMTr32No/yHtgUcLJfjWU4uTyY+4OHd3P
/eBVz8e/08C6sgc+rlVUNGRsZlZvPcUFhRu9Fv9GWufjHx6bWEHDUjb89eIp
vXR+Uf3Q2uJ8bv8Xxc/tt0gX434YcPAXnYHMm8vurkuqolNh8we/EnyaXM/v
CVn1gpkaDKGz3QKN9HVC+b30xFryj1nhftTTRP4Gv0i3its0suuKnNzG62zd
iRqXLB257wXxWFucj/onsnP5ke5E+Rfkv7jjPOIX5ddaK3Lfi7X5NYR7NncI
9dlWTea2XT95f5eO/Hc37G8zwEjOo+fMp5Fm0hQX+rUNNJF3/mvt5vXgjz+o
/3N1LWpcRYj6j2y/xvXLJe/kd3cON5LL9Zyd/a7WUNpnYa592/5KNZOTl//8
rYHW7o43lI6rpIcXk4Y2XtqreP96Hq3Nr8lG1H+Uise4eaVSfo3rl5Gd+7yi
+NH7Veq9I12L8rNqm6cV5ddk10dU3CsKuf4O2ZVqZ9nxubXpqLUit3+i8R/1
f9n9RDaKmn9GKCqeR/mjqLzDpsfmoex5IcSvNt3J1hEXRelOdj4uSneoPqmP
6jW6XSZ6a0fAEY1WTyM0az5qk1YJ7YgHzcMgu1/PrWEbrlXS0Vm70/P236Zz
bcavn7KfH59w9YXKB3p36pkVYSB9ssvbI+NM5PxgpfPZ1WbIE+Ibu92v6Qo5
tNNmeSVW0/WP9x366jieH5A9nyA7Tubyc3UtexyQvf6IdIraLSk+572D5Saa
Gp0e10VroEuz8sIKBtVAO+JB6+/I7tS4NaQ4qJZ8MlI75CfrKcN3x08nC42K
6Q7N6yKeRodxU/Jqb1Lw8sZBj76opYjBN1KyJuL3KEp3atMXQq6OUDwv6rnQ
fgBR/FzdbXRcFfqpl5k2hXYObq810uwDTXGJJXXQLkp3N/KT+rtl6yizfkuU
drWRUmaU3elwF88ritIXKs/VHbc8V3etVV8IZetONj9Xd4nrx0Z5zDXTmWEr
Pey1JrpXFbA9KFwP7aLizGPbt3WZ3MtEvd9dV3nhSzPFb9J4Lezyp2K648aZ
3PJId5aiL4SidKfUvilR/KL2nXLzO8Qjav1dFHL1GLC64cgto5FKpqVvjG2q
o0zXnb02xlyF+R2aP7H09WJR+kXtj3Qhaj8Ayu9EzU+K0h03v0M8KM7k1kcU
cnU35tDp6DshJnqc3LN4TJqOhiwtz3849RbM7yxdd7L9I1p/QXEg2p/D/VyU
36lNd9z8DvEopTtR6wio/ii/sxTdKbVPgKs7VJ77uYhfbbrj5neIR6k4U5Tu
UP1Rfqc23ant3AQ3zpS9Dqs23Vk6Wsr5AlHn4pWy2+7NsKEl6k7UPTBK9XPb
vRnNQxRPyo4PufPwovi5626ykVtPNJ+D5ldl83P3dctuTxRXq228RetoSI+i
PlcpXatNd6gd0HwOml9F6x2y6889Z8TltxQdqQ3Vtn5nbcgdf5BdVHzC1RHX
zj0PKDufRXbuOS/Eo9T5R248wy3P7Z+y80rZ93KI4ufOW4raz4neLzo3hPi5
uuPeh8xtZ6V0J1tfCNE4j+xc3VmKjrj8qLwo3XHXHbjjnijdcduT6+8Qj9rW
j5TK9y0FZeuUi+gcK/fcKyqP1u+45+9E6Y7r7xCP2vZFyP5ctaHadMRFbj7I
La823dmwdaCo+Qrb/GHL4M3ZURT6b75yLa06dq2vmRp9FhzWbra+dubuE1O6
vs8jWidC5x/ReWR0P4Ds+nPvqUPjg1L3Woj63hzEE3T4fPs9HkYa//rCMs+l
1bSt0D5viYcW2rn1587bcO1KrXdw1++QnXv+URQ/93m5OuLOw4i6v1GpeICr
O8QjSndcVNu9jkqh2nSntvseWworojt/P6ri2rP/7eya+/0yonj+L1r6PkaE
sv24bLtS7WYpiPp//85NtReGGcnbyzOrsn0NxT/Jvl9fehHaRcWr3PyRuw9Q
1L5B2ftXET86/4jOI6P7AWTzy+63qJ1F3fMvu/5c5OoO8SjlX0TpTqn9q6LQ
0nWH9gVx98Oo7d4DhNw4s7k8stBS4kzZaIszlcV/ANCj/7A=
   "], {{0, 0}, {37, 37}}, {
   0, 1}],
  Frame->True,
  FrameLabel->{None, None},
  FrameTicks->{{{{36.5, 
       FormBox["1", TraditionalForm]}, {27.5, 
       FormBox["10", TraditionalForm]}, {17.5, 
       FormBox["20", TraditionalForm]}, {7.5, 
       FormBox["30", TraditionalForm]}, {0.5, 
       FormBox["37", TraditionalForm]}}, {{36.5, 
       FormBox["1", TraditionalForm]}, {27.5, 
       FormBox["10", TraditionalForm]}, {17.5, 
       FormBox["20", TraditionalForm]}, {7.5, 
       FormBox["30", TraditionalForm]}, {0.5, 
       FormBox["37", TraditionalForm]}}}, {{{0.5, 
       FormBox["1", TraditionalForm]}, {9.5, 
       FormBox["10", TraditionalForm]}, {19.5, 
       FormBox["20", TraditionalForm]}, {29.5, 
       FormBox["30", TraditionalForm]}, {36.5, 
       FormBox["37", TraditionalForm]}}, {{0.5, 
       FormBox["1", TraditionalForm]}, {9.5, 
       FormBox["10", TraditionalForm]}, {19.5, 
       FormBox["20", TraditionalForm]}, {29.5, 
       FormBox["30", TraditionalForm]}, {36.5, 
       FormBox["37", TraditionalForm]}}}},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  Method->{
   "AxisPadding" -> Scaled[0.02], "DefaultBoundaryStyle" -> Automatic, 
    "DefaultPlotStyle" -> Automatic, "DomainPadding" -> Scaled[0.02], 
    "RangePadding" -> Scaled[0.05]}]], "Output",
 CellChangeTimes->{{3.674236009302546*^9, 3.674236060207891*^9}, 
   3.674239792509552*^9, 3.674247387492854*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"sparseBasis", "[", "n_", "]"}], ":=", 
  RowBox[{
   RowBox[{"Flatten", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"sparseCoefficients2D", "[", 
         RowBox[{
          RowBox[{"\[Psi]", "[", 
           RowBox[{"n", ",", "n", ",", "i", ",", "j"}], "]"}], ",", "n"}], 
         "]"}], "//", "Flatten"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "0", ",", 
         SuperscriptBox["2", "n"]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "0", ",", 
         SuperscriptBox["2", "n"]}], "}"}]}], "]"}], ",", "1"}], "]"}], "//", 
   "Transpose"}]}]], "Input",
 CellChangeTimes->{{3.674304556325103*^9, 3.674304649740264*^9}, {
  3.674322331904735*^9, 3.67432233351082*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"sparseBasis", "[", "3", "]"}], "//", "MatrixPlot"}]], "Input",
 CellChangeTimes->{{3.6743045864192047`*^9, 3.674304618448146*^9}, {
  3.674304653257122*^9, 3.6743046553027973`*^9}}],

Cell[BoxData[
 GraphicsBox[RasterBox[CompressedData["
1:eJzt3T9rFEEYB+CA2AYUBRvBP/EzCBpYEYxYKCj4BSIWaiEogohfwEZII2hv
FRA7LWws7AyBFBYKYsgVHhclxM7KiApycHh73uzsvPscHE+uOWZumd/7bm72
9vDizUtXd83MzBzbeV7cef78+9djqyLJrvv8/snlg6/fVbcu3zm3ublR7dm7
vHu2188+rmm5fm/fs7Pr73+//vPIP65JjX68SE7f6Lkh50l23ei5IedJdt3o
uSHnSZIkyfI8/+L405X+oPr68OP2g6WN6uX1G/P7L7zKPq5xHdW3z/W2D505
sVp9f/tk7tTqh2rh7sp8780g+3jrOnyeFfV45R4XGdmouSHn26mcJ5s3am7I
+XYq58nmjZobcr6dynmSJJnLwelHj68tfqm+rd3eOvC5Xy0sHT0ye+XT1N4/
dZ+Tevxts6m+MdV+1K71vVHXV9R5Tev926bcKEvri2TbrLuu6+aM3GCXnbQu
j9t3da2PIv82V/1SN8l0qptkOtWvZhy1r2nUPq7S90GRJGP4r7o/3G/n6qvV
WZJkiaqzJEmmU50lSTKdpdTZ0vU5kySZTnWWJMl0qrMkSaZTnSVJkmQX1MeW
aarfoeV0jbq+os4runKjDK0vkiTbY+nXFXatr4h6f9jc40ll1PUVdV65x5VK
uVGW1hfJuroPHZlO9+Uk06l+TWbd84W654Oln4+QJNtprvvBqZskyRJ1H9XJ
9LmRJDm+6iZJku1R3STT25X952STRq1fpX//G/W4MIauayPTGbV+pZ5X6lwq
/biQJCcz6nWIUec17fGTJNmEUf7PRpLsplG/Zyl1XvoKkuymUfJ/uP5GnVfu
8ZAk+T+qayRJ5vcHSXKm6w==
   "], {{0, 0}, {81, 37}}, {0, 1}],
  Frame->True,
  FrameLabel->{None, None},
  FrameTicks->{{{{36.5, 
       FormBox["1", TraditionalForm]}, {27.5, 
       FormBox["10", TraditionalForm]}, {17.5, 
       FormBox["20", TraditionalForm]}, {7.5, 
       FormBox["30", TraditionalForm]}, {0.5, 
       FormBox["37", TraditionalForm]}}, {{36.5, 
       FormBox["1", TraditionalForm]}, {27.5, 
       FormBox["10", TraditionalForm]}, {17.5, 
       FormBox["20", TraditionalForm]}, {7.5, 
       FormBox["30", TraditionalForm]}, {0.5, 
       FormBox["37", TraditionalForm]}}}, {{{0.5, 
       FormBox["1", TraditionalForm]}, {19.5, 
       FormBox["20", TraditionalForm]}, {39.5, 
       FormBox["40", TraditionalForm]}, {59.5, 
       FormBox["60", TraditionalForm]}, {80.5, 
       FormBox["81", TraditionalForm]}}, {{0.5, 
       FormBox["1", TraditionalForm]}, {19.5, 
       FormBox["20", TraditionalForm]}, {39.5, 
       FormBox["40", TraditionalForm]}, {59.5, 
       FormBox["60", TraditionalForm]}, {80.5, 
       FormBox["81", TraditionalForm]}}}},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  Method->{
   "AxisPadding" -> Scaled[0.02], "DefaultBoundaryStyle" -> Automatic, 
    "DefaultPlotStyle" -> Automatic, "DomainPadding" -> Scaled[0.02], 
    "RangePadding" -> Scaled[0.05]}]], "Output",
 CellChangeTimes->{{3.6743045888902893`*^9, 3.6743046557788754`*^9}, 
   3.674322334730076*^9}]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"sparseWeights", "[", "n_", "]"}], ":=", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"sparseIntegrateByCoefficients", "[", 
     RowBox[{
      RowBox[{"\[Psi]", "[", 
       RowBox[{"n", ",", "n", ",", "i", ",", "j"}], "]"}], ",", "n"}], "]"}], 
    ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "0", ",", 
      SuperscriptBox["2", "n"]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"j", ",", "0", ",", 
      SuperscriptBox["2", "n"]}], "}"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fullWeights", "[", 
   RowBox[{"kx_", ",", "ky_"}], "]"}], ":=", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"fullIntegrate", "[", 
     RowBox[{
      RowBox[{"\[Psi]", "[", 
       RowBox[{"kx", ",", "ky", ",", "i", ",", "j"}], "]"}], ",", "kx", ",", 
      "ky"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "0", ",", 
      SuperscriptBox["2", "kx"]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"j", ",", "0", ",", 
      SuperscriptBox["2", "ky"]}], "}"}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.6743224320356627`*^9, 3.674322473933408*^9}, {
  3.674322615222788*^9, 3.67432264889931*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"fullWeights", "[", 
  RowBox[{"3", ",", "3"}], "]"}]], "Input",
 CellChangeTimes->{{3.674322655118281*^9, 3.674322661829513*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     FractionBox["1", "256"], ",", 
     FractionBox["1", "128"], ",", 
     FractionBox["1", "128"], ",", 
     FractionBox["1", "128"], ",", 
     FractionBox["1", "128"], ",", 
     FractionBox["1", "128"], ",", 
     FractionBox["1", "128"], ",", 
     FractionBox["1", "128"], ",", 
     FractionBox["1", "256"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     FractionBox["1", "128"], ",", 
     FractionBox["1", "64"], ",", 
     FractionBox["1", "64"], ",", 
     FractionBox["1", "64"], ",", 
     FractionBox["1", "64"], ",", 
     FractionBox["1", "64"], ",", 
     FractionBox["1", "64"], ",", 
     FractionBox["1", "64"], ",", 
     FractionBox["1", "128"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     FractionBox["1", "128"], ",", 
     FractionBox["1", "64"], ",", 
     FractionBox["1", "64"], ",", 
     FractionBox["1", "64"], ",", 
     FractionBox["1", "64"], ",", 
     FractionBox["1", "64"], ",", 
     FractionBox["1", "64"], ",", 
     FractionBox["1", "64"], ",", 
     FractionBox["1", "128"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     FractionBox["1", "128"], ",", 
     FractionBox["1", "64"], ",", 
     FractionBox["1", "64"], ",", 
     FractionBox["1", "64"], ",", 
     FractionBox["1", "64"], ",", 
     FractionBox["1", "64"], ",", 
     FractionBox["1", "64"], ",", 
     FractionBox["1", "64"], ",", 
     FractionBox["1", "128"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     FractionBox["1", "128"], ",", 
     FractionBox["1", "64"], ",", 
     FractionBox["1", "64"], ",", 
     FractionBox["1", "64"], ",", 
     FractionBox["1", "64"], ",", 
     FractionBox["1", "64"], ",", 
     FractionBox["1", "64"], ",", 
     FractionBox["1", "64"], ",", 
     FractionBox["1", "128"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     FractionBox["1", "128"], ",", 
     FractionBox["1", "64"], ",", 
     FractionBox["1", "64"], ",", 
     FractionBox["1", "64"], ",", 
     FractionBox["1", "64"], ",", 
     FractionBox["1", "64"], ",", 
     FractionBox["1", "64"], ",", 
     FractionBox["1", "64"], ",", 
     FractionBox["1", "128"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     FractionBox["1", "128"], ",", 
     FractionBox["1", "64"], ",", 
     FractionBox["1", "64"], ",", 
     FractionBox["1", "64"], ",", 
     FractionBox["1", "64"], ",", 
     FractionBox["1", "64"], ",", 
     FractionBox["1", "64"], ",", 
     FractionBox["1", "64"], ",", 
     FractionBox["1", "128"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     FractionBox["1", "128"], ",", 
     FractionBox["1", "64"], ",", 
     FractionBox["1", "64"], ",", 
     FractionBox["1", "64"], ",", 
     FractionBox["1", "64"], ",", 
     FractionBox["1", "64"], ",", 
     FractionBox["1", "64"], ",", 
     FractionBox["1", "64"], ",", 
     FractionBox["1", "128"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     FractionBox["1", "256"], ",", 
     FractionBox["1", "128"], ",", 
     FractionBox["1", "128"], ",", 
     FractionBox["1", "128"], ",", 
     FractionBox["1", "128"], ",", 
     FractionBox["1", "128"], ",", 
     FractionBox["1", "128"], ",", 
     FractionBox["1", "128"], ",", 
     FractionBox["1", "256"]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.674322663306793*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Total", "[", 
  RowBox[{
   RowBox[{"Out", "[", "9", "]"}], "//", "Flatten"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Total", "[", 
  RowBox[{
   RowBox[{"Out", "[", "19", "]"}], "//", "Flatten"}], "]"}]}], "Input",
 CellChangeTimes->{{3.67432268982971*^9, 3.6743227330253487`*^9}}],

Cell[BoxData["1.`"], "Output",
 CellChangeTimes->{{3.67432271806879*^9, 3.6743227332350197`*^9}}],

Cell[BoxData["1"], "Output",
 CellChangeTimes->{{3.67432271806879*^9, 3.6743227332430553`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"sparseWeights", "[", "6", "]"}], "//", "MatrixPlot"}]], "Input",
 CellChangeTimes->{{3.674349245661272*^9, 3.674349266149034*^9}}],

Cell[BoxData[
 GraphicsBox[RasterBox[CompressedData["
1:eJzt3U9ol2UcAPChxy6CgZdGTkps7BaYHuRh5WWkBxWiQ6eBdAmGsIuDivkv
LME6dAhCj4KeZJbhbEeRoOzHMKrhwclkmy4VhAhWRNLhhYdXeuN9fd53z2cw
PjuMd1++fPk+39/e93mfgdGx/QfX9/X1Df/7/c/P4/u2DZ7YcTMcO33qxszQ
nXB368TqyMByCJ98Or26shJeOPfy1NHf74X+w+c+W5pZCH1Pvh5Glv3+ax9M
//XG5YWw6btNH/42vBx+fuu5rya+uF/b9S+suz7f3/9LuPbNK+9+/vxC+Pbk
3qFfjy91Jv5dk5Pzjw70wpntc4uLu2+Hqc3jvStX5f9Zxb9/9L3vh8d+CFOz
s19eungrPPhzz9ir79/rTPxdz7/6Txt/Xf2fJLk21P/J2DdnDx96Z+dKeH1k
/cd/7FkKJx+PXt5y9lbyuMiUWi9IMk+r/v8qdby5aF5lzqr/tNZ1/4IkuTbU
/8lY8yoZa70gyTyt+vxt6nj/q+a9tHY9/+qfOee/rv0XJMm1of5PxnZ93iOb
0HpBknlq/0I7Na8yZ9V/Wu1fIEkW1f/JWPMqGWu9IMk8rfr+87r+btfnsabj
b/r5efl/umXnL3Ql/qZV/2ltOv66zr8gSa4N9X8ytuvzJNmE1guSzFP7F9qp
eZU5q/7Tav8CSbKo/k/GmlfJWOsFSeap8xco/7Hqnznn3/kLJMmi+j8Z2/V5
j2xC6wVJ5qn9C+3UvMqcVf9ptX+BJFlU/ydjzatkrPWCJPO0rP9Xff980/NV
1etXff68bfHLf9r4B188cr534ccwuuHtnZeu/xTmNr709fRH5ffX2hZ/1/Ov
/tuZf58XSDJP9X8y1v0FMtZ6QZJ5av9COzWvMmfVf1rtXyBJFtX/yVjzKhlr
vSDJPHX+AuU/Vv0z5/w7f4EkWVT/J2O7Pu+RTWi9IMk8tX+hnZpXmbPqP632
L5Aki+r/ZKx5lYy1XpBknpb1/12Tk/OPDvTCme1zi4u7b4epzeO9K1eXa/u7
XZ/Hmo6/6efn5f/pVn3/f9vib1r1n9am4y/r/z4vkGSe6v9kbNfnSbIJrRck
maf2L7RT8ypzVv2n1f4FkmRR/Z+MNa+SsdYLksxT5y9Q/mPVP3POv/MXSJJF
9X8ytuvzHtmE1guSzFP7F9qpeZU5q/7Tav8CSbKo/k/GmlfJWOsFSeZpWf8f
37dt8MSOm+HY6VM3ZobuhLtbJ1ZHBqq/f7vq/Yu6rl/X87ep4q/r/efy//+u
X3b+Qlfi73r+1X/a+Mv6/99Goj2O
   "], {{0, 0}, {65, 65}}, {0, 1}],
  Frame->True,
  FrameLabel->{None, None},
  FrameTicks->{{{{64.5, 
       FormBox["1", TraditionalForm]}, {45.5, 
       FormBox["20", TraditionalForm]}, {25.5, 
       FormBox["40", TraditionalForm]}, {0.5, 
       FormBox["65", TraditionalForm]}}, {{64.5, 
       FormBox["1", TraditionalForm]}, {45.5, 
       FormBox["20", TraditionalForm]}, {25.5, 
       FormBox["40", TraditionalForm]}, {0.5, 
       FormBox["65", TraditionalForm]}}}, {{{0.5, 
       FormBox["1", TraditionalForm]}, {19.5, 
       FormBox["20", TraditionalForm]}, {39.5, 
       FormBox["40", TraditionalForm]}, {64.5, 
       FormBox["65", TraditionalForm]}}, {{0.5, 
       FormBox["1", TraditionalForm]}, {19.5, 
       FormBox["20", TraditionalForm]}, {39.5, 
       FormBox["40", TraditionalForm]}, {64.5, 
       FormBox["65", TraditionalForm]}}}},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  Method->{
   "AxisPadding" -> Scaled[0.02], "DefaultBoundaryStyle" -> Automatic, 
    "DefaultPlotStyle" -> Automatic, "DomainPadding" -> Scaled[0.02], 
    "RangePadding" -> Scaled[0.05]}]], "Output",
 CellChangeTimes->{{3.674349254915304*^9, 3.674349267002249*^9}, 
   3.674349457487461*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ListPlot", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"n", "+", 
          RowBox[{"Log", "[", "n", "]"}]}], ",", 
         RowBox[{"Log2", "[", 
          RowBox[{"Abs", "[", 
           RowBox[{
            RowBox[{"sparseIntegrateByCoefficients", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"Sin", "[", 
                  RowBox[{"#1", "+", "#2"}], "]"}], "^", "2"}], " ", 
                RowBox[{"Cos", "[", "#2", "]"}]}], "&"}], ",", "n"}], "]"}], 
            "-", 
            RowBox[{"NIntegrate", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"Sin", "[", 
                 RowBox[{"x", "+", "y"}], "]"}], "^", "2"}], " ", 
               RowBox[{"Cos", "[", "y", "]"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"x", ",", "0", ",", "1"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"y", ",", "0", ",", "1"}], "}"}]}], "]"}]}], "]"}], 
          "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"n", ",", "1", ",", "11"}], "}"}]}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"2", "n"}], ",", 
         RowBox[{"Log2", "[", 
          RowBox[{"Abs", "[", 
           RowBox[{
            RowBox[{"fullIntegrate", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"Sin", "[", 
                  RowBox[{"#1", "+", "#2"}], "]"}], "^", "2"}], " ", 
                RowBox[{"Cos", "[", "#2", "]"}]}], "&"}], ",", "n", ",", 
              "n"}], "]"}], "-", 
            RowBox[{"NIntegrate", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"Sin", "[", 
                 RowBox[{"x", "+", "y"}], "]"}], "^", "2"}], " ", 
               RowBox[{"Cos", "[", "y", "]"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"x", ",", "0", ",", "1"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"y", ",", "0", ",", "1"}], "}"}]}], "]"}]}], "]"}], 
          "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"n", ",", "1", ",", "7"}], "}"}]}], "]"}]}], "}"}], ",", 
   RowBox[{"PlotLegends", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"\"\<Sparse\>\"", ",", "\"\<Full\>\""}], "}"}]}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.6743494897935877`*^9, 3.674349615806271*^9}, {
   3.674349687289466*^9, 3.674349828915866*^9}, {3.67434986121902*^9, 
   3.674349861475604*^9}, {3.674349907267458*^9, 3.674349949932585*^9}, {
   3.6743501755787086`*^9, 3.674350178575008*^9}, 3.674350302885648*^9}],

Cell[BoxData[
 TemplateBox[{GraphicsBox[{{}, {{{}, {
        Hue[0.67, 0.6, 0.6], 
        Directive[
         PointSize[0.012833333333333334`], 
         RGBColor[0.368417, 0.506779, 0.709798], 
         AbsoluteThickness[1.6]], 
        PointBox[{{1., -4.1089359451127985`}, {
         2.6931471805599454`, -5.658397994167354}, {
         4.09861228866811, -7.32210118482126}, {
         5.386294361119891, -9.050377660835194}, {
         6.6094379124341005`, -10.821885092258304`}, {
         7.791759469228055, -12.62467695956834}, {
         8.945910149055313, -14.45120605769245}, {
         10.079441541679836`, -16.29636569384718}, {
         11.19722457733622, -18.156527662458057`}, {
         12.302585092994045`, -20.028993591493823`}, {
         13.39789527279837, -21.911600654938496`}}]}, {
        Hue[0.9060679774997897, 0.6, 0.6], 
        Directive[
         PointSize[0.012833333333333334`], 
         RGBColor[0.880722, 0.611041, 0.142051], 
         AbsoluteThickness[1.6]], 
        PointBox[{{2., -4.763611594354826}, {4., -6.739361105137939}, {
         6., -8.73371678946939}, {8., -10.732329941278685`}, {
         10., -12.731984244815957`}, {12., -14.731895992823363`}, {
         14., -16.731866252197882`}}]}, {}}}, {}}, {
    DisplayFunction -> Identity, PlotRangePadding -> {{
        Scaled[0.02], 
        Scaled[0.02]}, {
        Scaled[0.05], 
        Scaled[0.02]}}, AxesOrigin -> {0, 0}, 
     PlotRange -> {{0, 14.}, {-21.911600654938496`, 0}}, PlotRangeClipping -> 
     True, ImagePadding -> All, DisplayFunction -> Identity, AspectRatio -> 
     NCache[GoldenRatio^(-1), 0.6180339887498948], Axes -> {True, True}, 
     AxesLabel -> {None, None}, AxesOrigin -> {0, 0}, DisplayFunction :> 
     Identity, Frame -> {{False, False}, {False, False}}, 
     FrameLabel -> {{None, None}, {None, None}}, 
     FrameTicks -> {{Automatic, Automatic}, {Automatic, Automatic}}, 
     GridLines -> {None, None}, GridLinesStyle -> Directive[
       GrayLevel[0.5, 0.4]], 
     Method -> {"CoordinatesToolOptions" -> {"DisplayFunction" -> ({
           (Part[{{Identity, Identity}, {Identity, Identity}}, 1, 2][#]& )[
            Part[#, 1]], 
           (Part[{{Identity, Identity}, {Identity, Identity}}, 2, 2][#]& )[
            Part[#, 2]]}& ), "CopiedValueFunction" -> ({
           (Part[{{Identity, Identity}, {Identity, Identity}}, 1, 2][#]& )[
            Part[#, 1]], 
           (Part[{{Identity, Identity}, {Identity, Identity}}, 2, 2][#]& )[
            Part[#, 2]]}& )}}, 
     PlotRange -> {{0, 14.}, {-21.911600654938496`, 0}}, PlotRangeClipping -> 
     True, PlotRangePadding -> {{
        Scaled[0.02], 
        Scaled[0.02]}, {
        Scaled[0.05], 
        Scaled[0.02]}}, Ticks -> {Automatic, Automatic}}],FormBox[
    FormBox[
     TemplateBox[{"\"Sparse\"", "\"Full\""}, "PointLegend", 
      DisplayFunction -> (FormBox[
        StyleBox[
         StyleBox[
          PaneBox[
           TagBox[
            GridBox[{{
               TagBox[
                GridBox[{{
                   GraphicsBox[{{}, {
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.462], 
                    RGBColor[0.368417, 0.506779, 0.709798], 
                    AbsoluteThickness[1.6]], {
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.462], 
                    RGBColor[0.368417, 0.506779, 0.709798], 
                    AbsoluteThickness[1.6]], 
                    PointBox[
                    NCache[{
                    Scaled[{
                    Rational[1, 2], 
                    Rational[1, 2]}]}, {
                    Scaled[{0.5, 0.5}]}]]}}}, AspectRatio -> Full, 
                    ImageSize -> {10, 10}, PlotRangePadding -> None, 
                    ImagePadding -> Automatic, 
                    BaselinePosition -> (Scaled[0.1] -> Baseline)], #}, {
                   GraphicsBox[{{}, {
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.462], 
                    RGBColor[0.880722, 0.611041, 0.142051], 
                    AbsoluteThickness[1.6]], {
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.462], 
                    RGBColor[0.880722, 0.611041, 0.142051], 
                    AbsoluteThickness[1.6]], 
                    PointBox[
                    NCache[{
                    Scaled[{
                    Rational[1, 2], 
                    Rational[1, 2]}]}, {
                    Scaled[{0.5, 0.5}]}]]}}}, AspectRatio -> Full, 
                    ImageSize -> {10, 10}, PlotRangePadding -> None, 
                    ImagePadding -> Automatic, 
                    BaselinePosition -> (Scaled[0.1] -> Baseline)], #2}}, 
                 GridBoxAlignment -> {
                  "Columns" -> {Center, Left}, "Rows" -> {{Baseline}}}, 
                 AutoDelete -> False, 
                 GridBoxDividers -> {
                  "Columns" -> {{False}}, "Rows" -> {{False}}}, 
                 GridBoxItemSize -> {"Columns" -> {{All}}, "Rows" -> {{All}}},
                  GridBoxSpacings -> {
                  "Columns" -> {{0.5}}, "Rows" -> {{0.8}}}], "Grid"]}}, 
             GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
             AutoDelete -> False, 
             GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{1}}, "Rows" -> {{0}}}], 
            "Grid"], Alignment -> Left, AppearanceElements -> None, 
           ImageMargins -> {{5, 5}, {5, 5}}, ImageSizeAction -> 
           "ResizeToFit"], LineIndent -> 0, StripOnInput -> False], {
         FontFamily -> "Arial"}, Background -> Automatic, StripOnInput -> 
         False], TraditionalForm]& ), 
      InterpretationFunction :> (RowBox[{"PointLegend", "[", 
         RowBox[{
           RowBox[{"{", 
             RowBox[{
               RowBox[{"Directive", "[", 
                 RowBox[{
                   RowBox[{"PointSize", "[", "0.012833333333333334`", "]"}], 
                   ",", 
                   InterpretationBox[
                    ButtonBox[
                    TooltipBox[
                    GraphicsBox[{{
                    GrayLevel[0], 
                    RectangleBox[{0, 0}]}, {
                    GrayLevel[0], 
                    RectangleBox[{1, -1}]}, {
                    RGBColor[0.368417, 0.506779, 0.709798], 
                    RectangleBox[{0, -1}, {2, 1}]}}, AspectRatio -> 1, Frame -> 
                    True, FrameStyle -> 
                    RGBColor[
                    0.24561133333333335`, 0.3378526666666667, 
                    0.4731986666666667], FrameTicks -> None, PlotRangePadding -> 
                    None, ImageSize -> 
                    Dynamic[{
                    Automatic, 1.35 CurrentValue["FontCapHeight"]/
                    AbsoluteCurrentValue[Magnification]}]], 
                    "RGBColor[0.368417, 0.506779, 0.709798]"], Appearance -> 
                    None, BaseStyle -> {}, BaselinePosition -> Baseline, 
                    DefaultBaseStyle -> {}, ButtonFunction :> 
                    With[{Typeset`box$ = EvaluationBox[]}, 
                    If[
                    Not[
                    AbsoluteCurrentValue["Deployed"]], 
                    SelectionMove[Typeset`box$, All, Expression]; 
                    FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
                    FrontEnd`Private`$ColorSelectorInitialColor = 
                    RGBColor[0.368417, 0.506779, 0.709798]; 
                    FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
                    MathLink`CallFrontEnd[
                    FrontEnd`AttachCell[Typeset`box$, 
                    FrontEndResource["RGBColorValueSelector"], {
                    0, {Left, Bottom}}, {Left, Top}, 
                    "ClosingActions" -> {
                    "SelectionDeparture", "ParentChanged", 
                    "EvaluatorQuit"}]]]], BaseStyle -> Inherited, Evaluator -> 
                    Automatic, Method -> "Preemptive"], 
                    RGBColor[0.368417, 0.506779, 0.709798], Editable -> False,
                     Selectable -> False], ",", 
                   RowBox[{"AbsoluteThickness", "[", "1.6`", "]"}]}], "]"}], 
               ",", 
               RowBox[{"Directive", "[", 
                 RowBox[{
                   RowBox[{"PointSize", "[", "0.012833333333333334`", "]"}], 
                   ",", 
                   InterpretationBox[
                    ButtonBox[
                    TooltipBox[
                    GraphicsBox[{{
                    GrayLevel[0], 
                    RectangleBox[{0, 0}]}, {
                    GrayLevel[0], 
                    RectangleBox[{1, -1}]}, {
                    RGBColor[0.880722, 0.611041, 0.142051], 
                    RectangleBox[{0, -1}, {2, 1}]}}, AspectRatio -> 1, Frame -> 
                    True, FrameStyle -> 
                    RGBColor[
                    0.587148, 0.40736066666666665`, 0.09470066666666668], 
                    FrameTicks -> None, PlotRangePadding -> None, ImageSize -> 
                    Dynamic[{
                    Automatic, 1.35 CurrentValue["FontCapHeight"]/
                    AbsoluteCurrentValue[Magnification]}]], 
                    "RGBColor[0.880722, 0.611041, 0.142051]"], Appearance -> 
                    None, BaseStyle -> {}, BaselinePosition -> Baseline, 
                    DefaultBaseStyle -> {}, ButtonFunction :> 
                    With[{Typeset`box$ = EvaluationBox[]}, 
                    If[
                    Not[
                    AbsoluteCurrentValue["Deployed"]], 
                    SelectionMove[Typeset`box$, All, Expression]; 
                    FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
                    FrontEnd`Private`$ColorSelectorInitialColor = 
                    RGBColor[0.880722, 0.611041, 0.142051]; 
                    FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
                    MathLink`CallFrontEnd[
                    FrontEnd`AttachCell[Typeset`box$, 
                    FrontEndResource["RGBColorValueSelector"], {
                    0, {Left, Bottom}}, {Left, Top}, 
                    "ClosingActions" -> {
                    "SelectionDeparture", "ParentChanged", 
                    "EvaluatorQuit"}]]]], BaseStyle -> Inherited, Evaluator -> 
                    Automatic, Method -> "Preemptive"], 
                    RGBColor[0.880722, 0.611041, 0.142051], Editable -> False,
                     Selectable -> False], ",", 
                   RowBox[{"AbsoluteThickness", "[", "1.6`", "]"}]}], "]"}]}],
              "}"}], ",", 
           RowBox[{"{", 
             RowBox[{#, ",", #2}], "}"}], ",", 
           RowBox[{"LegendMarkers", "\[Rule]", 
             RowBox[{"{", 
               RowBox[{
                 RowBox[{"{", 
                   RowBox[{"False", ",", "Automatic"}], "}"}], ",", 
                 RowBox[{"{", 
                   RowBox[{"False", ",", "Automatic"}], "}"}]}], "}"}]}], ",", 
           RowBox[{"Joined", "\[Rule]", 
             RowBox[{"{", 
               RowBox[{"False", ",", "False"}], "}"}]}], ",", 
           RowBox[{"LabelStyle", "\[Rule]", 
             RowBox[{"{", "}"}]}], ",", 
           RowBox[{"LegendLayout", "\[Rule]", "\"Column\""}]}], "]"}]& ), 
      Editable -> True], TraditionalForm], TraditionalForm]},
  "Legended",
  DisplayFunction->(GridBox[{{
      TagBox[
       ItemBox[
        PaneBox[
         TagBox[#, "SkipImageSizeLevel"], Alignment -> {Center, Baseline}, 
         BaselinePosition -> Baseline], DefaultBaseStyle -> "Labeled"], 
       "SkipImageSizeLevel"], 
      ItemBox[#2, DefaultBaseStyle -> "LabeledLabel"]}}, 
    GridBoxAlignment -> {"Columns" -> {{Center}}, "Rows" -> {{Center}}}, 
    AutoDelete -> False, GridBoxItemSize -> Automatic, 
    BaselinePosition -> {1, 1}]& ),
  Editable->True,
  InterpretationFunction->(RowBox[{"Legended", "[", 
     RowBox[{#, ",", 
       RowBox[{"Placed", "[", 
         RowBox[{#2, ",", "After"}], "]"}]}], "]"}]& )]], "Output",
 CellChangeTimes->{3.6743502165191383`*^9, 3.674350307808806*^9}]
}, Open  ]],

Cell["\<\
The integration for the sparse grid is working just as we want. \
\>", "Text",
 CellChangeTimes->{{3.674349898440906*^9, 3.674349905492669*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Out", "[", "19", "]"}], "//", 
  "MatrixPlot"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Out", "[", "9", "]"}], "//", "MatrixPlot"}]}], "Input",
 CellChangeTimes->{{3.6743225269569483`*^9, 3.674322530662792*^9}, {
  3.6743227363843184`*^9, 3.6743227580699263`*^9}}],

Cell[BoxData[
 GraphicsBox[RasterBox[CompressedData["
1:eJxTTMoPSmVmYGDghGIQ26Pxf3NL2lv7HQ+8ReZ8f2n/56deZnr3A/taa07j
NZ9f2yd9PvFo057H9jlRR7dLfN036MRJdT8DGHywf1glss794S0oHwYGjzip
4TDY3D/qr1F/DQb3j/prePtruNZfAMwQxT0=
   "], {{0, 0}, {9, 9}}, {0, 1}],
  Frame->True,
  FrameLabel->{None, None},
  FrameTicks->{{{{8.5, 
       FormBox["1", TraditionalForm]}, {7.5, 
       FormBox["2", TraditionalForm]}, {6.5, 
       FormBox["3", TraditionalForm]}, {5.5, 
       FormBox["4", TraditionalForm]}, {4.5, 
       FormBox["5", TraditionalForm]}, {3.5, 
       FormBox["6", TraditionalForm]}, {2.5, 
       FormBox["7", TraditionalForm]}, {1.5, 
       FormBox["8", TraditionalForm]}, {0.5, 
       FormBox["9", TraditionalForm]}}, {{8.5, 
       FormBox["1", TraditionalForm]}, {7.5, 
       FormBox["2", TraditionalForm]}, {6.5, 
       FormBox["3", TraditionalForm]}, {5.5, 
       FormBox["4", TraditionalForm]}, {4.5, 
       FormBox["5", TraditionalForm]}, {3.5, 
       FormBox["6", TraditionalForm]}, {2.5, 
       FormBox["7", TraditionalForm]}, {1.5, 
       FormBox["8", TraditionalForm]}, {0.5, 
       FormBox["9", TraditionalForm]}}}, {{{0.5, 
       FormBox["1", TraditionalForm]}, {1.5, 
       FormBox["2", TraditionalForm]}, {2.5, 
       FormBox["3", TraditionalForm]}, {3.5, 
       FormBox["4", TraditionalForm]}, {4.5, 
       FormBox["5", TraditionalForm]}, {5.5, 
       FormBox["6", TraditionalForm]}, {6.5, 
       FormBox["7", TraditionalForm]}, {7.5, 
       FormBox["8", TraditionalForm]}, {8.5, 
       FormBox["9", TraditionalForm]}}, {{0.5, 
       FormBox["1", TraditionalForm]}, {1.5, 
       FormBox["2", TraditionalForm]}, {2.5, 
       FormBox["3", TraditionalForm]}, {3.5, 
       FormBox["4", TraditionalForm]}, {4.5, 
       FormBox["5", TraditionalForm]}, {5.5, 
       FormBox["6", TraditionalForm]}, {6.5, 
       FormBox["7", TraditionalForm]}, {7.5, 
       FormBox["8", TraditionalForm]}, {8.5, 
       FormBox["9", TraditionalForm]}}}},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  Method->{
   "AxisPadding" -> Scaled[0.02], "DefaultBoundaryStyle" -> Automatic, 
    "DefaultPlotStyle" -> Automatic, "DomainPadding" -> Scaled[0.02], 
    "RangePadding" -> Scaled[0.05]}]], "Output",
 CellChangeTimes->{
  3.674322531074081*^9, {3.674322740853015*^9, 3.6743227585546713`*^9}}],

Cell[BoxData[
 GraphicsBox[RasterBox[CompressedData["
1:eJzt3T1IQlEUwHGhqamircUUp6AimoLqIhUNtmgFTRFCW6ANhQ0tQgQNLUUt
0dCYDkViQ0E01VIUUos0JERoRkJzEEXbRejBq3c//oL8HOR6OJxz8L37Hi8Q
T8RmG3w+X+Dn/fX5OF87nagWRGk+2hlcK4m7UGqobbIiRrpXtrIbr6Irtbk7
uFcRB0vZxYHRkvB9v2qS9b5/cdaUKgcfReK8/T2ceRaRZDa53/Ti2vq6xx+L
z12FE9fiqFDYyR0+iLePsUTvsnvrk///iR/RJKl/NV0vN0b6Z6pierjYs7D9
JFbGo2l/y7Xncdku/YI26/T/m9fx/lbmrbfqnn+3jl8QTZL6V1Pd562p0i9o
s07P37r1u7rPw7+On/x7Gz/7F4iy1L+a6j7PTZV+QZtl/wLJvyz7F4iy1L+a
6j5vTZV+QZt1ev1/vXX+er45Xd/p+X/V4u/wp/dvMzci3jzVl7u8F8XWUP5k
tapN/Lrn3637XxBNkvpXU44v1JR+QZtl/wLJvyz7F4iy1L+a6j5vTZV+QZvl
/gs14yf/3sbP/ReIstS/muo+z02VfkGbZf8Cyb8s+xeIstS/muo+b02VfkGb
5fkFasbP8y/UjP8TR/VPaA==
   "], {{0, 0}, {33, 33}}, {0, 1}],
  Frame->True,
  FrameLabel->{None, None},
  FrameTicks->{{{{32.5, 
       FormBox["1", TraditionalForm]}, {23.5, 
       FormBox["10", TraditionalForm]}, {13.5, 
       FormBox["20", TraditionalForm]}, {0.5, 
       FormBox["33", TraditionalForm]}}, {{32.5, 
       FormBox["1", TraditionalForm]}, {23.5, 
       FormBox["10", TraditionalForm]}, {13.5, 
       FormBox["20", TraditionalForm]}, {0.5, 
       FormBox["33", TraditionalForm]}}}, {{{0.5, 
       FormBox["1", TraditionalForm]}, {9.5, 
       FormBox["10", TraditionalForm]}, {19.5, 
       FormBox["20", TraditionalForm]}, {32.5, 
       FormBox["33", TraditionalForm]}}, {{0.5, 
       FormBox["1", TraditionalForm]}, {9.5, 
       FormBox["10", TraditionalForm]}, {19.5, 
       FormBox["20", TraditionalForm]}, {32.5, 
       FormBox["33", TraditionalForm]}}}},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  Method->{
   "AxisPadding" -> Scaled[0.02], "DefaultBoundaryStyle" -> Automatic, 
    "DefaultPlotStyle" -> Automatic, "DomainPadding" -> Scaled[0.02], 
    "RangePadding" -> Scaled[0.05]}]], "Output",
 CellChangeTimes->{
  3.674322531074081*^9, {3.674322740853015*^9, 3.674322758629367*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"sparseWeights", "[", "5", "]"}], "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.674322477136107*^9, 3.674322498450766*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"-", "0.03125`"}], "0.015625`", "0.`", "0.015625`", 
      RowBox[{"-", "0.015625`"}], "0.015625`", "0.`", "0.015625`", 
      RowBox[{"-", "0.03125`"}], "0.015625`", "0.`", "0.015625`", 
      RowBox[{"-", "0.015625`"}], "0.015625`", "0.`", "0.015625`", 
      RowBox[{"-", "0.046875`"}], "0.015625`", "0.`", "0.015625`", 
      RowBox[{"-", "0.015625`"}], "0.015625`", "0.`", "0.015625`", 
      RowBox[{"-", "0.03125`"}], "0.015625`", "0.`", "0.015625`", 
      RowBox[{"-", "0.015625`"}], "0.015625`", "0.`", "0.015625`", 
      RowBox[{"-", "0.03125`"}]},
     {"0.015625`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.`", "0.`", "0.`", "0.015625`"},
     {"0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.03125`", "0.`", "0.`", 
      "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.`", "0.`", "0.`", "0.`"},
     {"0.015625`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.`", "0.`", "0.`", "0.015625`"},
     {
      RowBox[{"-", "0.015625`"}], "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.`", "0.03125`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.03125`", 
      "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      RowBox[{"-", "0.015625`"}]},
     {"0.015625`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.`", "0.`", "0.`", "0.015625`"},
     {"0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.03125`", "0.`", "0.`", 
      "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.`", "0.`", "0.`", "0.`"},
     {"0.015625`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.`", "0.`", "0.`", "0.015625`"},
     {
      RowBox[{"-", "0.03125`"}], "0.`", "0.`", "0.`", "0.03125`", "0.`", 
      "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.03125`", "0.`", "0.`", 
      "0.`", 
      RowBox[{"-", "0.03125`"}], "0.`", "0.`", "0.`", "0.03125`", "0.`", 
      "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.03125`", "0.`", "0.`", 
      "0.`", 
      RowBox[{"-", "0.03125`"}]},
     {"0.015625`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.`", "0.`", "0.`", "0.015625`"},
     {"0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.03125`", "0.`", "0.`", 
      "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.`", "0.`", "0.`", "0.`"},
     {"0.015625`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.`", "0.`", "0.`", "0.015625`"},
     {
      RowBox[{"-", "0.015625`"}], "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.`", "0.03125`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.03125`", 
      "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      RowBox[{"-", "0.015625`"}]},
     {"0.015625`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.`", "0.`", "0.`", "0.015625`"},
     {"0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.03125`", "0.`", "0.`", 
      "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.`", "0.`", "0.`", "0.`"},
     {"0.015625`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.`", "0.`", "0.`", "0.015625`"},
     {
      RowBox[{"-", "0.046875`"}], "0.`", "0.03125`", "0.`", "0.`", "0.`", 
      "0.03125`", "0.`", 
      RowBox[{"-", "0.03125`"}], "0.`", "0.03125`", "0.`", "0.`", "0.`", 
      "0.03125`", "0.`", 
      RowBox[{"-", "0.0625`"}], "0.`", "0.03125`", "0.`", "0.`", "0.`", 
      "0.03125`", "0.`", 
      RowBox[{"-", "0.03125`"}], "0.`", "0.03125`", "0.`", "0.`", "0.`", 
      "0.03125`", "0.`", 
      RowBox[{"-", "0.046875`"}]},
     {"0.015625`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.`", "0.`", "0.`", "0.015625`"},
     {"0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.03125`", "0.`", "0.`", 
      "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.`", "0.`", "0.`", "0.`"},
     {"0.015625`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.`", "0.`", "0.`", "0.015625`"},
     {
      RowBox[{"-", "0.015625`"}], "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.`", "0.03125`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.03125`", 
      "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      RowBox[{"-", "0.015625`"}]},
     {"0.015625`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.`", "0.`", "0.`", "0.015625`"},
     {"0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.03125`", "0.`", "0.`", 
      "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.`", "0.`", "0.`", "0.`"},
     {"0.015625`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.`", "0.`", "0.`", "0.015625`"},
     {
      RowBox[{"-", "0.03125`"}], "0.`", "0.`", "0.`", "0.03125`", "0.`", 
      "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.03125`", "0.`", "0.`", 
      "0.`", 
      RowBox[{"-", "0.03125`"}], "0.`", "0.`", "0.`", "0.03125`", "0.`", 
      "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.03125`", "0.`", "0.`", 
      "0.`", 
      RowBox[{"-", "0.03125`"}]},
     {"0.015625`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.`", "0.`", "0.`", "0.015625`"},
     {"0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.03125`", "0.`", "0.`", 
      "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.`", "0.`", "0.`", "0.`"},
     {"0.015625`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.`", "0.`", "0.`", "0.015625`"},
     {
      RowBox[{"-", "0.015625`"}], "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.`", "0.03125`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.03125`", 
      "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      RowBox[{"-", "0.015625`"}]},
     {"0.015625`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.`", "0.`", "0.`", "0.015625`"},
     {"0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.03125`", "0.`", "0.`", 
      "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.`", "0.`", "0.`", "0.`"},
     {"0.015625`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.`", "0.`", "0.`", "0.015625`"},
     {
      RowBox[{"-", "0.03125`"}], "0.015625`", "0.`", "0.015625`", 
      RowBox[{"-", "0.015625`"}], "0.015625`", "0.`", "0.015625`", 
      RowBox[{"-", "0.03125`"}], "0.015625`", "0.`", "0.015625`", 
      RowBox[{"-", "0.015625`"}], "0.015625`", "0.`", "0.015625`", 
      RowBox[{"-", "0.046875`"}], "0.015625`", "0.`", "0.015625`", 
      RowBox[{"-", "0.015625`"}], "0.015625`", "0.`", "0.015625`", 
      RowBox[{"-", "0.03125`"}], "0.015625`", "0.`", "0.015625`", 
      RowBox[{"-", "0.015625`"}], "0.015625`", "0.`", "0.015625`", 
      RowBox[{"-", "0.03125`"}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.674322481483715*^9, 3.674322519119117*^9}}]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1268, 755},
WindowMargins->{{Automatic, 1}, {Automatic, 3}},
FrontEndVersion->"10.4 for Mac OS X x86 (32-bit, 64-bit Kernel) (February 25, \
2016)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 229, 4, 28, "Input"],
Cell[CellGroupData[{
Cell[812, 28, 632, 12, 28, "Input"],
Cell[1447, 42, 1687, 39, 374, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[3171, 86, 426, 5, 44, "Subsection"],
Cell[3600, 93, 592, 12, 46, "Input"],
Cell[CellGroupData[{
Cell[4217, 109, 866, 22, 28, "Input"],
Cell[5086, 133, 4234, 149, 248, "Output"]
}, Open  ]],
Cell[9335, 285, 3327, 88, 146, "Input"],
Cell[12665, 375, 1488, 35, 28, "Input"],
Cell[CellGroupData[{
Cell[14178, 414, 246, 6, 28, "Input"],
Cell[14427, 422, 216, 5, 28, "Output"]
}, Open  ]],
Cell[14658, 430, 653, 19, 35, "Input"],
Cell[CellGroupData[{
Cell[15336, 453, 208, 4, 28, "Input"],
Cell[15547, 459, 596, 20, 47, "Output"]
}, Open  ]],
Cell[16158, 482, 1606, 45, 77, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[17801, 532, 415, 5, 44, "Subsection"],
Cell[18219, 539, 2161, 55, 98, "Input"],
Cell[CellGroupData[{
Cell[20405, 598, 654, 18, 46, "Input"],
Cell[21062, 618, 236, 3, 28, "Output"],
Cell[21301, 623, 237, 3, 28, "Output"]
}, Open  ]],
Cell[21553, 629, 172, 4, 28, "Input"],
Cell[CellGroupData[{
Cell[21750, 637, 302, 5, 28, "Input"],
Cell[22055, 644, 3526, 68, 378, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[25618, 717, 215, 4, 28, "Input"],
Cell[25836, 723, 2369, 48, 378, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[28242, 776, 510, 14, 28, "Input"],
Cell[28755, 792, 4159, 78, 378, "Output"]
}, Open  ]],
Cell[32929, 873, 788, 22, 35, "Input"],
Cell[CellGroupData[{
Cell[33742, 899, 216, 4, 28, "Input"],
Cell[33961, 905, 2346, 48, 206, "Output"]
}, Open  ]],
Cell[36322, 956, 1164, 33, 57, "Input"],
Cell[CellGroupData[{
Cell[37511, 993, 153, 3, 28, "Input"],
Cell[37667, 998, 3313, 102, 124, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[41017, 1105, 312, 8, 46, "Input"],
Cell[41332, 1115, 97, 1, 28, "Output"],
Cell[41432, 1118, 95, 1, 28, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[41564, 1124, 165, 3, 28, "Input"],
Cell[41732, 1129, 2583, 51, 378, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[44352, 1185, 2859, 76, 97, "Input"],
Cell[47214, 1263, 12691, 264, 268, "Output"]
}, Open  ]],
Cell[59920, 1530, 154, 3, 30, "Text"],
Cell[CellGroupData[{
Cell[60099, 1537, 306, 7, 46, "Input"],
Cell[60408, 1546, 2327, 52, 388, "Output"],
Cell[62738, 1600, 1905, 40, 378, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[64680, 1645, 165, 3, 28, "Input"],
Cell[64848, 1650, 10705, 182, 584, "Output"]
}, Open  ]]
}, Open  ]]
}
]
*)

