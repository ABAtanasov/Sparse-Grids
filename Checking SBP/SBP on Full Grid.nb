(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.4' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     61937,       1612]
NotebookOptionsPosition[     60372,       1554]
NotebookOutlinePosition[     60728,       1570]
CellTagsIndexPosition[     60685,       1567]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Standard Definitions", "Subsection",
 CellChangeTimes->{{3.673277052290266*^9, 3.6732770726158047`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Phi]", "[", "x_", "]"}], ":=", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Abs", "[", "x", "]"}], ">", "1"}], ",", "0", ",", 
    RowBox[{"1", "-", 
     RowBox[{"Abs", "[", "x", "]"}]}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Phi]", "[", 
   RowBox[{"l_", ",", "i_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"l", "\[Equal]", 
      RowBox[{"-", "1"}]}], ",", "1", ",", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"l", "\[Equal]", "0"}], ",", "#", ",", 
       RowBox[{"\[Phi]", "[", 
        RowBox[{
         SuperscriptBox["2", "l"], 
         RowBox[{"(", 
          RowBox[{"#", "-", 
           RowBox[{
            SuperscriptBox["2", 
             RowBox[{"-", "l"}]], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", "i"}], "-", "1"}], ")"}]}]}], ")"}]}], "]"}]}], 
      "]"}]}], "]"}], "&"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Phi]", "[", 
   RowBox[{"lx_", ",", "ly_", ",", "i_", ",", "j_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"\[Phi]", "[", 
      RowBox[{"lx", ",", "i"}], "]"}], "[", "#1", "]"}], 
    RowBox[{
     RowBox[{"\[Phi]", "[", 
      RowBox[{"ly", ",", "j"}], "]"}], "[", "#2", "]"}]}], 
   "&"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Psi]", "[", 
   RowBox[{"lx_", ",", "ly_", ",", "i_", ",", "j_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"\[Phi]", "[", 
     RowBox[{
      SuperscriptBox["2", "lx"], 
      RowBox[{"(", 
       RowBox[{"#1", "-", 
        RowBox[{
         SuperscriptBox["2", 
          RowBox[{"-", "lx"}]], "i"}]}], ")"}]}], "]"}], 
    RowBox[{"\[Phi]", "[", 
     RowBox[{
      SuperscriptBox["2", "ly"], 
      RowBox[{"(", 
       RowBox[{"#2", "-", 
        RowBox[{
         SuperscriptBox["2", 
          RowBox[{"-", "ly"}]], "j"}]}], ")"}]}], "]"}]}], 
   "&"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ceil", "[", 
   RowBox[{"x_", ",", "l_"}], "]"}], ":=", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"x", "\[GreaterEqual]", "1"}], ",", 
    SuperscriptBox["2", 
     RowBox[{"l", "-", "1"}]], ",", 
    RowBox[{"1", "+", 
     RowBox[{"Floor", "[", 
      RowBox[{
       SuperscriptBox["2", 
        RowBox[{"l", "-", "1"}]], "x"}], "]"}]}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"switch", "[", "x_", "]"}], ":=", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"x", "\[GreaterEqual]", "1"}], ",", "x", ",", "1"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"switch2", "[", "x_", "]"}], ":=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"x", "\[Equal]", 
      RowBox[{"-", "1"}]}], ",", "0", ",", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"x", "\[Equal]", "0"}], ",", "1", ",", 
       SuperscriptBox["2", 
        RowBox[{"-", "x"}]]}], "]"}]}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"column2", "[", 
   RowBox[{"diag_", ",", "row_"}], "]"}], ":=", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"diag", "<", "1"}], ",", "diag", ",", " ", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"row", "<", "1"}], ",", "diag", ",", 
      RowBox[{"diag", "-", "row", "+", "1"}]}], "]"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"column1", "[", 
    RowBox[{"diag_", ",", "row_"}], "]"}], ":=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"diag", "\[Equal]", "row"}], ",", 
     RowBox[{"-", "1"}], ",", 
     RowBox[{"column2", "[", 
      RowBox[{"diag", ",", "row"}], "]"}]}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"getrow", "[", 
   RowBox[{"perp_", ",", "diag_"}], "]"}], ":=", 
  RowBox[{"Which", "[", 
   RowBox[{
    RowBox[{"diag", "\[Equal]", 
     RowBox[{"-", "1"}]}], ",", 
    RowBox[{"-", "1"}], ",", 
    RowBox[{"diag", "\[Equal]", "0"}], ",", 
    RowBox[{"Min", "[", 
     RowBox[{"perp", ",", "0"}], "]"}], ",", 
    RowBox[{"perp", "\[LessEqual]", "diag"}], ",", "perp", ",", "True", ",", 
    "diag"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"getcol", "[", 
    RowBox[{"perp_", ",", "diag_"}], "]"}], ":=", 
   RowBox[{"Which", "[", 
    RowBox[{
     RowBox[{"diag", "\[Equal]", 
      RowBox[{"-", "1"}]}], ",", 
     RowBox[{"-", "1"}], ",", 
     RowBox[{"diag", "\[Equal]", "0"}], ",", 
     RowBox[{"Min", "[", 
      RowBox[{
       RowBox[{"diag", "-", "perp"}], ",", "0"}], "]"}], ",", 
     RowBox[{"perp", ">", "0"}], ",", 
     RowBox[{"diag", "-", "perp", "+", "1"}], ",", "True", ",", "diag"}], 
    "]"}]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"endperp", "[", "n_", "]"}], ":=", 
   RowBox[{"Which", "[", 
    RowBox[{
     RowBox[{"n", "\[Equal]", 
      RowBox[{"-", "1"}]}], ",", 
     RowBox[{"-", "1"}], ",", 
     RowBox[{"n", "\[Equal]", "0"}], ",", "1", ",", "True", ",", 
     RowBox[{"n", "+", "2"}]}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"d\[Phi]", "[", "x_", "]"}], ":=", 
   RowBox[{"Which", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Abs", "[", "x", "]"}], ">", "1"}], ",", "0", ",", 
     "\[IndentingNewLine]", "\t\t\t", 
     RowBox[{"x", "\[Equal]", "1"}], " ", ",", 
     RowBox[{
      RowBox[{"-", "1"}], "/", "2"}], ",", "\[IndentingNewLine]", "\t\t\t", 
     RowBox[{"x", "\[Equal]", 
      RowBox[{"-", "1"}]}], ",", 
     RowBox[{"1", "/", "2"}], ",", "\[IndentingNewLine]", "\t\t\t", 
     RowBox[{"x", "\[Equal]", "0"}], ",", "0", ",", "\[IndentingNewLine]", 
     "\t\t\t", 
     RowBox[{"x", ">", "0"}], ",", 
     RowBox[{"-", "1"}], ",", "\[IndentingNewLine]", "\t\t\t", "True", ",", 
     "1"}], "]"}]}], 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Don", "'"}], "t", " ", "think", " ", "I", " ", "need", " ", 
    "this"}], "*)"}]}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.672490224395479*^9, 3.672490298682095*^9}, 
   3.6724944378264093`*^9, {3.672494898687271*^9, 3.672494957647328*^9}, {
   3.672496678860899*^9, 3.6724967092866983`*^9}, 3.672496936925047*^9, {
   3.672497137416025*^9, 3.672497137938712*^9}, {3.672497654192381*^9, 
   3.6724977082489758`*^9}, {3.6724977496958313`*^9, 3.672497762411235*^9}, {
   3.672757291016025*^9, 3.672757331279429*^9}, {3.67275767040593*^9, 
   3.672757682845997*^9}, {3.672757721439649*^9, 3.67275773288477*^9}, {
   3.6731055659610367`*^9, 3.673105573038452*^9}, {3.6731077900913553`*^9, 
   3.673107795441799*^9}, {3.673111144094293*^9, 3.6731111471587067`*^9}, {
   3.67311118676823*^9, 3.673111196955504*^9}, 3.6731132158566*^9, {
   3.673113441846511*^9, 3.673113455170422*^9}, {3.673113485653905*^9, 
   3.6731134966601753`*^9}, 3.673115028551476*^9, {3.6731150643821163`*^9, 
   3.673115123930702*^9}, {3.673115492203158*^9, 3.6731154931966057`*^9}, {
   3.67311562008355*^9, 3.673115670135125*^9}, {3.673115713193399*^9, 
   3.6731157292920856`*^9}, {3.673115828134582*^9, 3.6731158455282593`*^9}, {
   3.673226161112205*^9, 3.673226161339789*^9}, {3.6732267733638697`*^9, 
   3.673226789334585*^9}, 3.673277018076087*^9, {3.67327848391285*^9, 
   3.673278522454027*^9}, {3.673371562946054*^9, 3.6733715810386972`*^9}, {
   3.673625453062598*^9, 3.673625465333948*^9}, {3.67362576703554*^9, 
   3.6736257999170837`*^9}, {3.673626166302894*^9, 3.673626168023837*^9}, {
   3.6736302300216217`*^9, 3.673630328234693*^9}, {3.67363377874596*^9, 
   3.673633778921495*^9}, {3.673707639980641*^9, 3.673707646364229*^9}, {
   3.6737831754221582`*^9, 3.673783209560733*^9}, {3.673785893472739*^9, 
   3.673785988789469*^9}, {3.6737860208897543`*^9, 3.673786028084447*^9}, {
   3.673786230986429*^9, 3.67378624132312*^9}, {3.673786284299685*^9, 
   3.673786305161662*^9}, {3.673786335983499*^9, 3.6737863535520563`*^9}, {
   3.673786406633304*^9, 3.673786408624165*^9}, {3.673787677416293*^9, 
   3.673787713948784*^9}, 3.673787988762076*^9, {3.673798866362308*^9, 
   3.673799013917637*^9}, {3.673799240953815*^9, 3.673799248487845*^9}, {
   3.673799284797557*^9, 3.67379930504216*^9}, {3.673799353720017*^9, 
   3.673799362750903*^9}, {3.673799419915134*^9, 3.67379947974662*^9}, {
   3.6737995547718363`*^9, 3.6737995647953453`*^9}, {3.67379960247902*^9, 
   3.673799673038477*^9}, {3.673799707707058*^9, 3.67379975376333*^9}, {
   3.673801251597981*^9, 3.6738012517052927`*^9}, {3.673801300132337*^9, 
   3.673801300466476*^9}, {3.673801335100066*^9, 3.673801359821342*^9}, {
   3.673801602312234*^9, 3.6738019209687757`*^9}, {3.6738029969809017`*^9, 
   3.6738030314442663`*^9}, {3.673803082532922*^9, 3.673803106762065*^9}, {
   3.673895394546824*^9, 3.6738954211059103`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Standard Basis", "Subsection",
 CellChangeTimes->{{3.673277052290266*^9, 3.673277056255988*^9}, {
   3.673367982176783*^9, 3.6733679845358677`*^9}, 3.673643134677516*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"standardCoefficients2D", "[", 
   RowBox[{"f_", ",", "lx_", ",", "ly_"}], "]"}], ":=", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"f", "[", 
     RowBox[{
      RowBox[{
       SuperscriptBox["2", 
        RowBox[{"-", "lx"}]], " ", "i"}], ",", 
      RowBox[{
       SuperscriptBox["2", 
        RowBox[{"-", "ly"}]], " ", "j"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "0", ",", 
      SuperscriptBox["2", "lx"]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"j", ",", "0", ",", 
      SuperscriptBox["2", "ly"]}], "}"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"standardReconstruct2D", "[", 
    RowBox[{"coefficients_", ",", "lx_", ",", "ly_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"coefficients", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{"i", "+", "1"}], ",", 
          RowBox[{"j", "+", "1"}]}], "]"}], "]"}], " ", 
       RowBox[{
        RowBox[{"\[Psi]", "[", 
         RowBox[{"lx", ",", "ly", ",", "i", ",", "j"}], "]"}], "[", 
        RowBox[{"#1", ",", "#2"}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "0", ",", 
        SuperscriptBox["2", "lx"]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", "0", ",", 
        SuperscriptBox["2", "ly"]}], "}"}]}], "]"}], "&"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"standardProject2D", "[", 
   RowBox[{"f_", ",", "lx_", ",", "ly_"}], "]"}], ":=", 
  RowBox[{"standardReconstruct2D", "[", 
   RowBox[{
    RowBox[{"standardCoefficients2D", "[", 
     RowBox[{"f", ",", "lx", ",", "ly"}], "]"}], ",", "lx", ",", "ly"}], 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.6733680003972816`*^9, 3.6733681189558687`*^9}, {
  3.673370933680094*^9, 3.673370994522457*^9}, {3.673371036059031*^9, 
  3.6733711201950502`*^9}, {3.6733711714335012`*^9, 3.673371175445512*^9}, {
  3.673371413375792*^9, 3.673371423930414*^9}, {3.6733715870924797`*^9, 
  3.673371621567006*^9}, {3.673371658601623*^9, 3.673371665146308*^9}, {
  3.673617918986994*^9, 3.6736179378880987`*^9}, {3.67361801388404*^9, 
  3.6736180150769053`*^9}, {3.67362175928094*^9, 3.673621761032077*^9}, {
  3.673803992943742*^9, 3.673804011118949*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Full Basis", "Subsection",
 CellChangeTimes->{{3.673277052290266*^9, 3.673277056255988*^9}, {
  3.67357648054101*^9, 3.673576481088376*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"getCoefficient", "[", 
    RowBox[{"f_", ",", "x_", ",", "l_"}], "]"}], ":=", 
   RowBox[{"N", "@", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"l", "\[Equal]", 
       RowBox[{"-", "1"}]}], ",", 
      RowBox[{"f", "[", "0", "]"}], ",", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"l", "\[Equal]", "0"}], ",", 
        RowBox[{
         RowBox[{"f", "[", "1", "]"}], "-", 
         RowBox[{"f", "[", "0", "]"}]}], ",", 
        RowBox[{
         RowBox[{"f", "[", "x", "]"}], "-", 
         RowBox[{
          RowBox[{"1", "/", "2."}], " ", 
          RowBox[{"f", "[", 
           RowBox[{"x", "+", 
            RowBox[{"2", "^", 
             RowBox[{"-", "l"}]}]}], "]"}]}], "-", 
         RowBox[{
          RowBox[{"1", "/", "2."}], " ", 
          RowBox[{"f", "[", 
           RowBox[{"x", "-", 
            RowBox[{"2", "^", 
             RowBox[{"-", "l"}]}]}], "]"}]}]}]}], "]"}]}], "]"}]}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"getCoefficient2D", "[", 
    RowBox[{"f_", ",", "x_", ",", "y_", ",", "lx_", ",", "ly_"}], "]"}], ":=", 
   RowBox[{"getCoefficient", "[", 
    RowBox[{
     RowBox[{"Function", "[", 
      RowBox[{"y1", ",", 
       RowBox[{"getCoefficient", "[", 
        RowBox[{
         RowBox[{"Function", "[", 
          RowBox[{"x1", ",", 
           RowBox[{"f", "[", 
            RowBox[{"x1", ",", "y1"}], "]"}]}], "]"}], ",", "x", ",", "lx"}], 
        "]"}]}], "]"}], ",", "y", ",", "ly"}], "]"}]}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Tensor", " ", "product", " ", "construction"}], 
   "\[IndentingNewLine]", "*)"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"fullCoefficients2D", "[", 
    RowBox[{"f_", ",", "lx_", ",", "ly_"}], "]"}], ":=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"getCoefficient2D", "[", 
        RowBox[{"f", ",", 
         RowBox[{
          SuperscriptBox["2", 
           RowBox[{"-", "kx"}]], " ", "i"}], ",", 
         RowBox[{
          SuperscriptBox["2", 
           RowBox[{"-", "ky"}]], " ", "j"}], ",", "kx", ",", "ky"}], "]"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{
          SuperscriptBox["2", 
           RowBox[{"switch", "[", "kx", "]"}]], "-", "1"}], ",", "2"}], "}"}],
        ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", 
         RowBox[{
          SuperscriptBox["2", 
           RowBox[{"switch", "[", "ky", "]"}]], "-", "1"}], ",", "2"}], 
        "}"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"kx", ",", 
       RowBox[{"-", "1"}], ",", "lx"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"ky", ",", 
       RowBox[{"-", "1"}], ",", "ly"}], "}"}]}], "]"}]}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Reconstruct2D", "[", "coefficients_", "]"}], ":=", " ", 
   RowBox[{
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"coefficients", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{"kx", "+", "2"}], ",", 
          RowBox[{"ky", "+", "2"}], ",", 
          RowBox[{"ceil", "[", 
           RowBox[{"#1", ",", 
            RowBox[{"switch", "[", "kx", "]"}]}], "]"}], ",", 
          RowBox[{"ceil", "[", 
           RowBox[{"#2", ",", 
            RowBox[{"switch", "[", "ky", "]"}]}], "]"}]}], "]"}], "]"}], " ", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\[Phi]", "[", 
         RowBox[{"kx", ",", "ky", ",", 
          RowBox[{"ceil", "[", 
           RowBox[{"#1", ",", 
            RowBox[{"switch", "[", "kx", "]"}]}], "]"}], ",", 
          RowBox[{"ceil", "[", 
           RowBox[{"#2", ",", 
            RowBox[{"switch", "[", "ky", "]"}]}], "]"}]}], "]"}], "[", 
        RowBox[{"#1", ",", "#2"}], "]"}]}], "\[IndentingNewLine]", ",", 
      RowBox[{"{", 
       RowBox[{"kx", ",", 
        RowBox[{"-", "1"}], ",", 
        RowBox[{
         RowBox[{"Length", "[", "coefficients", "]"}], "-", "2"}]}], "}"}], 
      ",", 
      RowBox[{"{", 
       RowBox[{"ky", ",", 
        RowBox[{"-", "1"}], ",", 
        RowBox[{
         RowBox[{"Length", "[", "coefficients", "]"}], "-", "2"}]}], "}"}]}], 
     "]"}], "&"}]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"reverseFlatten", "[", 
    RowBox[{"coefficients_", ",", "kx_", ",", "ky_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "k", "}"}], ",", 
     RowBox[{
      RowBox[{"k", "=", "0"}], ";", 
      RowBox[{"Return", "[", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"coefficients", "[", 
            RowBox[{"[", 
             RowBox[{"++", "k"}], "]"}], "]"}], " ", ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", 
             SuperscriptBox["2", 
              RowBox[{
               RowBox[{"switch", "[", "lx", "]"}], "-", "1"}]]}], "}"}], ",", 
           
           RowBox[{"{", 
            RowBox[{"j", ",", "1", ",", 
             SuperscriptBox["2", 
              RowBox[{
               RowBox[{"switch", "[", "ly", "]"}], "-", "1"}]]}], "}"}]}], 
          "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"lx", ",", 
           RowBox[{"-", "1"}], ",", "kx"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"ly", ",", 
           RowBox[{"-", "1"}], ",", "ky"}], "}"}]}], "]"}], "]"}], ";"}]}], 
    "]"}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"project2D", "[", 
   RowBox[{"f_", ",", "lx_", ",", "ly_"}], "]"}], ":=", 
  RowBox[{"Reconstruct2D", "[", 
   RowBox[{"fullCoefficients2D", "[", 
    RowBox[{"f", ",", "lx", ",", "ly"}], "]"}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.672497905249762*^9, 3.6724980460804987`*^9}, {
   3.672498086010971*^9, 3.672498086426568*^9}, {3.672498120610044*^9, 
   3.672498132168372*^9}, {3.6724981933241796`*^9, 3.6724982357720547`*^9}, {
   3.672498276279566*^9, 3.672498326466967*^9}, {3.672498396348793*^9, 
   3.672498474897173*^9}, {3.67249856256668*^9, 3.6724985772347393`*^9}, {
   3.672498885753086*^9, 3.6724988887908688`*^9}, {3.672498973735808*^9, 
   3.6724989750417128`*^9}, {3.672499010376442*^9, 3.672499028840345*^9}, {
   3.672499325454844*^9, 3.672499329989029*^9}, {3.672499410615137*^9, 
   3.672499411943338*^9}, {3.673034778920154*^9, 3.673034779751392*^9}, {
   3.67303878112294*^9, 3.673038789981296*^9}, {3.6730390939721413`*^9, 
   3.673039148248605*^9}, 3.673264987008442*^9, {3.673265302956407*^9, 
   3.673265412069075*^9}, 3.673265484744018*^9, {3.6732655859770203`*^9, 
   3.673265599390531*^9}, {3.673549789331839*^9, 3.673549792474326*^9}, {
   3.673549937783786*^9, 3.673550067559483*^9}, {3.673550130904303*^9, 
   3.673550188655244*^9}, {3.673550222539015*^9, 3.673550263661482*^9}, {
   3.673550377429068*^9, 3.673550605255698*^9}, {3.673550658843258*^9, 
   3.673550674368505*^9}, {3.673550721880124*^9, 3.673550733630953*^9}, {
   3.6735508024880533`*^9, 3.6735508208972387`*^9}, {3.673551354349574*^9, 
   3.673551396733061*^9}, {3.673551464740687*^9, 3.67355147329633*^9}, {
   3.673551584855508*^9, 3.673551634805602*^9}, {3.673551685006486*^9, 
   3.673551707024789*^9}, {3.6735517673505163`*^9, 3.6735517949923353`*^9}, {
   3.6735518410399*^9, 3.673551856586239*^9}, {3.673552424760128*^9, 
   3.673552441686385*^9}, {3.6735528116472397`*^9, 3.673552820772859*^9}, {
   3.673553485545643*^9, 3.673553494259479*^9}, {3.6735535318168592`*^9, 
   3.67355353200189*^9}, {3.673553604649831*^9, 3.673553647805532*^9}, {
   3.673553784064872*^9, 3.673553853609994*^9}, {3.673554166480525*^9, 
   3.6735541678554363`*^9}, {3.673554200527424*^9, 3.673554201829867*^9}, {
   3.673554251115727*^9, 3.673554282927092*^9}, {3.6735543333531923`*^9, 
   3.673554340509158*^9}, {3.6735543940457973`*^9, 3.6735544556685667`*^9}, {
   3.673554497906698*^9, 3.673554498898905*^9}, {3.673576494836705*^9, 
   3.673576499717845*^9}, 3.6735765366015453`*^9, {3.673618128943383*^9, 
   3.673618130973936*^9}, {3.673619092051015*^9, 3.67361912676166*^9}, {
   3.673620420351119*^9, 3.673620496933251*^9}, {3.673620881831188*^9, 
   3.673620882921871*^9}, {3.673620949180478*^9, 3.6736210125382423`*^9}, {
   3.673621431465794*^9, 3.6736214391143417`*^9}, {3.6736215581179047`*^9, 
   3.6736215599219103`*^9}, {3.673621636818694*^9, 3.673621651195643*^9}, {
   3.673622841424548*^9, 3.6736228650698757`*^9}, 3.6736229433901*^9, {
   3.6736232301017036`*^9, 3.6736232463693113`*^9}, {3.673623282681774*^9, 
   3.67362328670819*^9}, 3.673623546299397*^9, {3.673624155189372*^9, 
   3.673624187683448*^9}, {3.673624259831815*^9, 3.673624287992454*^9}, {
   3.673624335560773*^9, 3.6736243654325733`*^9}, {3.673624615790103*^9, 
   3.6736246228422747`*^9}, {3.673624663960896*^9, 3.67362466708747*^9}, {
   3.673624820117755*^9, 3.6736249337957172`*^9}, {3.673625035903747*^9, 
   3.6736251121044083`*^9}, {3.6736253167153788`*^9, 
   3.6736253579904623`*^9}, {3.6736255302697477`*^9, 3.673625587758218*^9}, {
   3.673625691597685*^9, 3.67362571108678*^9}, {3.673625949932444*^9, 
   3.673625970469276*^9}, {3.673626294423847*^9, 3.673626308940868*^9}, {
   3.673626361145555*^9, 3.6736263813442917`*^9}, {3.673626612762067*^9, 
   3.673626642947071*^9}, 3.673627182248803*^9, {3.673627271199099*^9, 
   3.6736273004473343`*^9}, {3.673627575286366*^9, 3.673627582774056*^9}, {
   3.673630558590191*^9, 3.673630594039089*^9}, {3.673630834026103*^9, 
   3.673630835187813*^9}, {3.673634052909828*^9, 3.6736340758783207`*^9}, {
   3.673634114536069*^9, 3.673634152687709*^9}, {3.673641997399588*^9, 
   3.673642095416727*^9}, {3.673642167167782*^9, 3.6736421781509953`*^9}, {
   3.6736422248218727`*^9, 3.673642244356945*^9}, 3.67364312756176*^9, {
   3.6736454537836723`*^9, 3.6736454639501257`*^9}, {3.673784467451808*^9, 
   3.67378450842913*^9}, {3.6738040733758163`*^9, 3.673804077443865*^9}, {
   3.6738041119027452`*^9, 3.673804118531611*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Sparse Basis", "Subsection",
 CellChangeTimes->{{3.673277052290266*^9, 3.673277061302971*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"sparseCoefficients2D", "[", 
    RowBox[{"f_", ",", "n_"}], "]"}], ":=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"getCoefficient2D", "[", 
          RowBox[{"f", ",", 
           RowBox[{
            RowBox[{"switch2", "[", 
             RowBox[{"getrow", "[", 
              RowBox[{"perp", ",", "diag"}], "]"}], "]"}], " ", "i"}], ",", 
           RowBox[{
            RowBox[{"switch2", "[", 
             RowBox[{"getcol", "[", 
              RowBox[{"perp", ",", "diag"}], "]"}], "]"}], " ", "j"}], ",", 
           RowBox[{"getrow", "[", 
            RowBox[{"perp", ",", "diag"}], "]"}], ",", 
           RowBox[{"getcol", "[", 
            RowBox[{"perp", ",", "diag"}], "]"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{
            SuperscriptBox["2", 
             RowBox[{"switch", "[", 
              RowBox[{"getrow", "[", 
               RowBox[{"perp", ",", "diag"}], "]"}], "]"}]], "-", "1"}], ",", 
           "2"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "1", ",", 
           RowBox[{
            SuperscriptBox["2", 
             RowBox[{"switch", "[", 
              RowBox[{"getcol", "[", 
               RowBox[{"perp", ",", "diag"}], "]"}], "]"}]], "-", "1"}], ",", 
           "2"}], "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"perp", ",", 
         RowBox[{"-", "1"}], ",", 
         RowBox[{"endperp", "[", "diag", "]"}]}], "}"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"diag", ",", 
       RowBox[{"-", "1"}], ",", "n"}], "}"}]}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"sparseReconstruct", "[", "coefficients_", "]"}], ":=", 
   RowBox[{
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"coefficients", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{"diag", "+", "2"}], ",", 
            RowBox[{"perp", "+", "2"}], ",", 
            RowBox[{"ceil", "[", 
             RowBox[{"#1", ",", 
              RowBox[{"switch", "[", 
               RowBox[{"getrow", "[", 
                RowBox[{"perp", ",", "diag"}], "]"}], "]"}]}], "]"}], ",", 
            RowBox[{"ceil", "[", 
             RowBox[{"#2", ",", 
              RowBox[{"switch", "[", 
               RowBox[{"getcol", "[", 
                RowBox[{"perp", ",", "diag"}], "]"}], "]"}]}], "]"}]}], "]"}],
           "]"}], " ", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"\[Phi]", "[", 
           RowBox[{
            RowBox[{"getrow", "[", 
             RowBox[{"perp", ",", "diag"}], "]"}], ",", 
            RowBox[{"getcol", "[", 
             RowBox[{"perp", ",", "diag"}], "]"}], ",", 
            RowBox[{"ceil", "[", 
             RowBox[{"#1", ",", 
              RowBox[{"switch", "[", 
               RowBox[{"getrow", "[", 
                RowBox[{"perp", ",", "diag"}], "]"}], "]"}]}], "]"}], ",", 
            RowBox[{"ceil", "[", 
             RowBox[{"#2", ",", 
              RowBox[{"switch", "[", 
               RowBox[{"getcol", "[", 
                RowBox[{"perp", ",", "diag"}], "]"}], "]"}]}], "]"}]}], "]"}],
           "[", 
          RowBox[{"#1", ",", "#2"}], "]"}]}], "\[IndentingNewLine]", ",", 
        RowBox[{"{", 
         RowBox[{"perp", ",", 
          RowBox[{"-", "1"}], ",", 
          RowBox[{"endperp", "[", "diag", "]"}]}], "}"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"diag", ",", 
        RowBox[{"-", "1"}], ",", 
        RowBox[{
         RowBox[{"Length", "[", "coefficients", "]"}], "-", "2"}]}], "}"}]}], 
     "]"}], "&"}]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"sparseProject", "[", 
    RowBox[{"f_", ",", "n_"}], "]"}], ":=", 
   RowBox[{"sparseReconstruct", "[", 
    RowBox[{"sparseCoefficients2D", "[", 
     RowBox[{"f", ",", "n"}], "]"}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sparseIntegrate", "[", 
   RowBox[{"f_", ",", "n_"}], "]"}], ":=", 
  RowBox[{"Sum", "[", 
   RowBox[{
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{"f", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"switch2", "[", 
            RowBox[{"getrow", "[", 
             RowBox[{"perp", ",", "diag"}], "]"}], "]"}], "i"}], ",", 
          RowBox[{
           RowBox[{"switch2", "[", 
            RowBox[{"getcol", "[", 
             RowBox[{"perp", ",", "diag"}], "]"}], "]"}], "j"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{
           SuperscriptBox["2", 
            RowBox[{"switch", "[", 
             RowBox[{"getrow", "[", 
              RowBox[{"perp", ",", "diag"}], "]"}], "]"}]], "-", "1"}], ",", 
          "2"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "1", ",", 
          RowBox[{
           SuperscriptBox["2", 
            RowBox[{"switch", "[", 
             RowBox[{"getcol", "[", 
              RowBox[{"perp", ",", "diag"}], "]"}], "]"}]], "-", "1"}], ",", 
          "2"}], "}"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"perp", ",", 
        RowBox[{"-", "1"}], ",", 
        RowBox[{"endperp", "[", "diag", "]"}]}], "}"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"diag", ",", 
      RowBox[{"-", "1"}], ",", "n"}], "}"}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.672618929348575*^9, 3.6726189300061407`*^9}, {
   3.672618978737381*^9, 3.672619078806769*^9}, {3.672619110725196*^9, 
   3.672619157350065*^9}, {3.672619193438739*^9, 3.67261920365707*^9}, {
   3.672619319494294*^9, 3.672619334232011*^9}, {3.67262008873687*^9, 
   3.672620094647687*^9}, {3.67262015651656*^9, 3.672620440911069*^9}, {
   3.6726205701211433`*^9, 3.67262063754361*^9}, {3.672676267266491*^9, 
   3.672676273622691*^9}, {3.6726763961071568`*^9, 3.672676404788162*^9}, {
   3.6732665910954447`*^9, 3.673266619018859*^9}, {3.673266658674885*^9, 
   3.673266663847871*^9}, {3.673269162063302*^9, 3.673269227835155*^9}, {
   3.6732692710491867`*^9, 3.673269277740987*^9}, {3.673269310322139*^9, 
   3.6732693403785973`*^9}, {3.673277030707767*^9, 3.673277034000938*^9}, {
   3.673627599666712*^9, 3.673627625079471*^9}, {3.673627832142569*^9, 
   3.6736279276961527`*^9}, {3.6736279872590714`*^9, 3.673627987495245*^9}, {
   3.673628028968935*^9, 3.673628098048843*^9}, {3.673628424293537*^9, 
   3.673628424484264*^9}, {3.673628628463648*^9, 3.673628628574724*^9}, {
   3.6736287722368917`*^9, 3.673628812901684*^9}, {3.673628856743156*^9, 
   3.673628899406356*^9}, {3.6736294759345503`*^9, 3.673629483468844*^9}, 
   3.6736295186229763`*^9, {3.673630334859116*^9, 3.6736304022984457`*^9}, {
   3.673630813940319*^9, 3.673630816180293*^9}, 3.67370039301103*^9, {
   3.673782946285776*^9, 3.673782964305489*^9}, {3.6737829947533092`*^9, 
   3.6737830274457273`*^9}, {3.673783160702259*^9, 3.673783172602543*^9}, {
   3.67378326572011*^9, 3.673783308866743*^9}, {3.673783340462134*^9, 
   3.673783419519454*^9}, {3.673784243401146*^9, 3.6737842639124947`*^9}, {
   3.67378452670199*^9, 3.673784566047907*^9}, {3.6737846210423727`*^9, 
   3.67378464273494*^9}, {3.673784738036634*^9, 3.67378476262145*^9}, {
   3.673785866920824*^9, 3.673785886606626*^9}, {3.673786447224745*^9, 
   3.673786477162902*^9}, {3.6737875807216*^9, 3.67378764476019*^9}, {
   3.673787718978281*^9, 3.673787763520397*^9}, {3.673788178123294*^9, 
   3.67378822384226*^9}, {3.6737987403772593`*^9, 3.6737987463428993`*^9}, {
   3.673798833989471*^9, 3.673798854517301*^9}, {3.67379902265583*^9, 
   3.673799153787937*^9}, {3.6738031149029207`*^9, 3.673803117513816*^9}, {
   3.6738032301133327`*^9, 3.67380323901864*^9}, {3.67380351441521*^9, 
   3.6738036175419273`*^9}, {3.673804153635599*^9, 3.673804241715304*^9}, {
   3.6738042961849813`*^9, 3.673804296724662*^9}, {3.673873396311283*^9, 
   3.673873397564124*^9}, {3.673873430072906*^9, 3.673873433691896*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Differentiation", "Subsection",
 CellChangeTimes->{{3.673277052290266*^9, 3.673277061302971*^9}, {
  3.673277119209675*^9, 3.6732771212386723`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"diffx", "[", 
    RowBox[{"f_", ",", "l_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"Which", "[", 
     RowBox[{
      RowBox[{"#1", "<", " ", 
       SuperscriptBox["2", 
        RowBox[{"-", "l"}]]}], ",", 
      FractionBox[
       RowBox[{
        RowBox[{"f", "[", 
         RowBox[{
          RowBox[{"#1", "+", 
           SuperscriptBox["2", 
            RowBox[{"-", "l"}]]}], ",", "#2"}], "]"}], "-", 
        RowBox[{"f", "[", 
         RowBox[{"#1", ",", "#2"}], "]"}]}], 
       SuperscriptBox["2", 
        RowBox[{"-", "l"}]]], ",", 
      RowBox[{"#1", ">", " ", 
       RowBox[{"1", "-", 
        SuperscriptBox["2", 
         RowBox[{"-", "l"}]]}]}], ",", 
      FractionBox[
       RowBox[{
        RowBox[{"f", "[", 
         RowBox[{"#1", ",", "#2"}], "]"}], "-", 
        RowBox[{"f", "[", 
         RowBox[{
          RowBox[{"#1", "-", 
           SuperscriptBox["2", 
            RowBox[{
             RowBox[{"-", "l"}], "-", "1"}]]}], ",", "#2"}], "]"}]}], 
       SuperscriptBox["2", 
        RowBox[{"-", "l"}]]], ",", "True", ",", 
      FractionBox[
       RowBox[{
        RowBox[{"f", "[", 
         RowBox[{
          RowBox[{"#1", "+", 
           SuperscriptBox["2", 
            RowBox[{"-", "l"}]]}], ",", "#2"}], "]"}], "-", 
        RowBox[{"f", "[", 
         RowBox[{
          RowBox[{"#1", "-", 
           SuperscriptBox["2", 
            RowBox[{"-", "l"}]]}], ",", "#2"}], "]"}]}], 
       RowBox[{"2", " ", 
        SuperscriptBox["2", 
         RowBox[{"-", "l"}]]}]]}], " ", "]"}], "&"}]}], "\[IndentingNewLine]",
   "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"diffy", "[", 
   RowBox[{"f_", ",", "l_"}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Which", "[", 
    RowBox[{
     RowBox[{"#1", "<", " ", 
      SuperscriptBox["2", 
       RowBox[{"-", "l"}]]}], ",", 
     FractionBox[
      RowBox[{
       RowBox[{"f", "[", 
        RowBox[{
         RowBox[{"#1", "+", 
          SuperscriptBox["2", 
           RowBox[{"-", "l"}]]}], ",", "#2"}], "]"}], "-", 
       RowBox[{"f", "[", 
        RowBox[{"#1", ",", "#2"}], "]"}]}], 
      SuperscriptBox["2", 
       RowBox[{"-", "l"}]]], ",", 
     RowBox[{"#1", ">", " ", 
      RowBox[{"1", "-", 
       SuperscriptBox["2", 
        RowBox[{"-", "l"}]]}]}], ",", 
     FractionBox[
      RowBox[{
       RowBox[{"f", "[", 
        RowBox[{"#1", ",", "#2"}], "]"}], "-", 
       RowBox[{"f", "[", 
        RowBox[{
         RowBox[{"#1", "-", 
          SuperscriptBox["2", 
           RowBox[{"-", "l"}]]}], ",", "#2"}], "]"}]}], 
      SuperscriptBox["2", 
       RowBox[{"-", "l"}]]], ",", "True", ",", 
     FractionBox[
      RowBox[{
       RowBox[{"f", "[", 
        RowBox[{
         RowBox[{"#1", "+", 
          SuperscriptBox["2", 
           RowBox[{"-", "l"}]]}], ",", "#2"}], "]"}], "-", 
       RowBox[{"f", "[", 
        RowBox[{
         RowBox[{"#1", "-", 
          SuperscriptBox["2", 
           RowBox[{"-", "l"}]]}], ",", "#2"}], "]"}]}], 
      RowBox[{"2", " ", 
       SuperscriptBox["2", 
        RowBox[{"-", "l"}]]}]]}], " ", "]"}], "&"}]}]}], "Input",
 CellChangeTimes->{{3.673194722114348*^9, 3.673194848078546*^9}, {
  3.673195420421319*^9, 3.673195424146777*^9}, {3.67319548233215*^9, 
  3.6731954984431143`*^9}, {3.673195695801755*^9, 3.673195698084182*^9}, {
  3.673195740549865*^9, 3.673195742188155*^9}, {3.673195791828994*^9, 
  3.67319579584198*^9}, {3.673195916950042*^9, 3.673195927075912*^9}, {
  3.673272654000877*^9, 3.673272657649295*^9}, {3.673631402814698*^9, 
  3.673631509795334*^9}, {3.673631572843629*^9, 3.6736315790820503`*^9}, {
  3.6736441006268263`*^9, 3.673644104168631*^9}, {3.673885192542933*^9, 
  3.673885195489036*^9}, {3.673885335765209*^9, 3.673885349630846*^9}, {
  3.6738875582237167`*^9, 3.6738875675630074`*^9}, {3.673895232459442*^9, 
  3.673895244343113*^9}, {3.673895342587188*^9, 3.673895390745644*^9}, {
  3.673895441812624*^9, 3.6738954476883183`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Algorithms to form the D Matrices", "Subsection",
 CellChangeTimes->{{3.673277052290266*^9, 3.673277061302971*^9}, {
  3.673277119209675*^9, 3.6732771212386723`*^9}, {3.673348508736053*^9, 
  3.673348513701818*^9}, {3.673726996709992*^9, 3.673726996814013*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"dxMatrix", "[", 
   RowBox[{"lx_", ",", "ly_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"Flatten", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"fullCoefficients2D", "[", 
           RowBox[{
            RowBox[{"diffx", "[", 
             RowBox[{
              RowBox[{"\[Phi]", "[", 
               RowBox[{"kx", ",", "ky", ",", "i", ",", "j"}], "]"}], ",", 
              "lx"}], "]"}], ",", "lx", ",", "ly"}], "]"}], "//", "Flatten"}],
          ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           SuperscriptBox["2", 
            RowBox[{
             RowBox[{"switch", "[", "kx", "]"}], "-", "1"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "1", ",", 
           SuperscriptBox["2", 
            RowBox[{
             RowBox[{"switch", "[", "ky", "]"}], "-", "1"}]]}], "}"}]}], 
        "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"kx", ",", 
         RowBox[{"-", "1"}], ",", "lx"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"ky", ",", 
         RowBox[{"-", "1"}], ",", "ly"}], "}"}]}], "]"}], ",", "3"}], "]"}], "//",
    "Transpose"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"dyMatrix", "[", 
    RowBox[{"lx_", ",", "ly_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"Flatten", "[", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"fullCoefficients2D", "[", 
            RowBox[{
             RowBox[{"diffy", "[", 
              RowBox[{
               RowBox[{"\[Phi]", "[", 
                RowBox[{"kx", ",", "ky", ",", "i", ",", "j"}], "]"}], ",", 
               "lx"}], "]"}], ",", "lx", ",", "ly"}], "]"}], "//", 
           "Flatten"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            SuperscriptBox["2", 
             RowBox[{
              RowBox[{"switch", "[", "kx", "]"}], "-", "1"}]]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "1", ",", 
            SuperscriptBox["2", 
             RowBox[{
              RowBox[{"switch", "[", "ky", "]"}], "-", "1"}]]}], "}"}]}], 
         "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"kx", ",", 
          RowBox[{"-", "1"}], ",", "lx"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"ky", ",", 
          RowBox[{"-", "1"}], ",", "ly"}], "}"}]}], "]"}], ",", "3"}], "]"}], 
    "//", "Transpose"}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dxMatrixStandard", "[", 
   RowBox[{"lx_", ",", "ly_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"Flatten", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"standardCoefficients2D", "[", 
         RowBox[{
          RowBox[{"diffx", "[", 
           RowBox[{
            RowBox[{"\[Psi]", "[", 
             RowBox[{"lx", ",", "ly", ",", "i", ",", "j"}], "]"}], ",", 
            "lx"}], "]"}], ",", "lx", ",", "ly"}], "]"}], "//", "Flatten"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "0", ",", 
         SuperscriptBox["2", "lx"]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "0", ",", 
         SuperscriptBox["2", "ly"]}], "}"}]}], "]"}], ",", "1"}], "]"}], "//",
    "Transpose"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"dyMatrixStandard", "[", 
    RowBox[{"lx_", ",", "ly_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"Flatten", "[", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"standardCoefficients2D", "[", 
          RowBox[{
           RowBox[{"diffy", "[", 
            RowBox[{
             RowBox[{"\[Psi]", "[", 
              RowBox[{"lx", ",", "ly", ",", "i", ",", "j"}], "]"}], ",", 
             "lx"}], "]"}], ",", "lx", ",", "ly"}], "]"}], "//", "Flatten"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "0", ",", 
          SuperscriptBox["2", "lx"]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "0", ",", 
          SuperscriptBox["2", "ly"]}], "}"}]}], "]"}], ",", "1"}], "]"}], "//",
     "Transpose"}]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "SPARSE", " ", "MATRICES", " ", "HAVENT", " ", "BEEN", " ", "MADE", " ", 
    "YET"}], " ", "*)"}]}]}], "Input",
 CellChangeTimes->{{3.673277867319282*^9, 3.6732779300785646`*^9}, {
   3.673277978146747*^9, 3.6732780613417473`*^9}, {3.673278163936036*^9, 
   3.673278194240142*^9}, {3.6732783469534073`*^9, 3.6732783674885817`*^9}, {
   3.673278532659255*^9, 3.673278558822431*^9}, {3.673278639088067*^9, 
   3.673278640005465*^9}, {3.673290353189601*^9, 3.6732903560928698`*^9}, {
   3.673290433654249*^9, 3.673290460510437*^9}, {3.673314006761815*^9, 
   3.6733140253354063`*^9}, {3.673347895510769*^9, 3.673347979542997*^9}, {
   3.67334800955755*^9, 3.673348010890189*^9}, {3.673348519527342*^9, 
   3.6733485396519337`*^9}, {3.6733720182152987`*^9, 3.673372091710594*^9}, {
   3.673372138253531*^9, 3.673372155572139*^9}, {3.673373040842484*^9, 
   3.6733730522313433`*^9}, {3.673576517299284*^9, 3.6735765213924427`*^9}, {
   3.6735777990523787`*^9, 3.6735778022107058`*^9}, {3.6735779933788157`*^9, 
   3.673577993517743*^9}, {3.6735782590440693`*^9, 3.673578266240716*^9}, {
   3.6735783990495977`*^9, 3.6735784109048443`*^9}, {3.673578875313389*^9, 
   3.673578905089498*^9}, 3.673579073462871*^9, {3.67357912109041*^9, 
   3.6735791212321453`*^9}, {3.6736291034321833`*^9, 3.67362913050037*^9}, {
   3.6736296430613728`*^9, 3.673629730192254*^9}, {3.6737828651909122`*^9, 
   3.673782876276456*^9}, {3.673783015579423*^9, 3.6737830232833347`*^9}, {
   3.673875729211529*^9, 3.6738757646233187`*^9}, 3.67387604992782*^9, {
   3.673895478819028*^9, 3.6738955391636343`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Integration on the Grids", "Subsection",
 CellChangeTimes->{{3.673277052290266*^9, 3.673277061302971*^9}, {
  3.673277119209675*^9, 3.6732771212386723`*^9}, {3.673348508736053*^9, 
  3.673348513701818*^9}, {3.6737269924034224`*^9, 3.6737269925381393`*^9}, {
  3.6739173803011847`*^9, 3.6739173831779957`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"fullIntegrate", "[", 
   RowBox[{"f_", ",", "kx_", ",", "ky_"}], "]"}], ":=", 
  RowBox[{"Sum", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"2", "^", 
      RowBox[{"-", "kx"}]}], " ", 
     RowBox[{"2", "^", 
      RowBox[{"-", "ky"}]}], "  ", 
     RowBox[{"posW", "[", 
      RowBox[{"i", ",", "j"}], "]"}], " ", 
     RowBox[{"f", "[", 
      RowBox[{"i", ",", "j"}], "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "0", ",", "1", ",", 
      SuperscriptBox["2", 
       RowBox[{"-", "kx"}]]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"j", ",", "0", ",", "1", ",", 
      SuperscriptBox["2", 
       RowBox[{"-", "ky"}]]}], "}"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fullIntegrate", "[", 
   RowBox[{"f_", ",", "kx_"}], "]"}], ":=", 
  RowBox[{"Sum", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"2", "^", 
      RowBox[{"-", "kx"}]}], " ", "2", " ", 
     RowBox[{"posW", "[", 
      RowBox[{"i", ",", "0"}], "]"}], 
     RowBox[{"f", "[", "i", "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "0", ",", "1", ",", 
      RowBox[{"2", "^", 
       RowBox[{"-", "kx"}]}]}], "}"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sparseIntegrate", "[", 
   RowBox[{"f_", ",", "n_"}], "]"}], ":=", 
  RowBox[{"Sum", "[", 
   RowBox[{
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"posW", "[", 
        RowBox[{"i", ",", "j"}], "]"}], " ", 
       RowBox[{"1", "/", 
        RowBox[{"GCD", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"2", "^", "n"}], " ", "i"}], ",", 
          RowBox[{"2", "^", 
           RowBox[{"(", "n", ")"}]}]}], "]"}]}], " ", 
       RowBox[{"1", "/", 
        RowBox[{"2", "^", "n"}]}], " ", 
       RowBox[{"f", "[", 
        RowBox[{"i", ",", " ", "j"}], " ", "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", "0", ",", "1", ",", 
        RowBox[{"1", "/", 
         RowBox[{"GCD", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"2", "^", "n"}], " ", "i"}], ",", 
           RowBox[{"2", "^", 
            RowBox[{"(", "n", ")"}]}]}], "]"}]}]}], "}"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "0", ",", "1", ",", 
      RowBox[{"2", "^", 
       RowBox[{"(", 
        RowBox[{"-", "n"}], ")"}]}]}], "}"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"The", " ", "area", " ", "weights"}], ",", " ", 
    RowBox[{"although", " ", "they", " ", "sum", " ", "to", " ", "1"}], ",", 
    " ", 
    RowBox[{
    "are", " ", "not", " ", "totally", " ", "right", " ", "for", " ", 
     "sparse", " ", "grids"}]}], "*)"}]}]}], "Input",
 CellChangeTimes->{{3.673913112737192*^9, 3.673913190086637*^9}, {
  3.6739132722211037`*^9, 3.673913412083212*^9}, {3.673913492566742*^9, 
  3.673913513414613*^9}, {3.673913586167919*^9, 3.673913593994001*^9}, {
  3.673913672965742*^9, 3.67391369223491*^9}, {3.67391377872025*^9, 
  3.6739137973109007`*^9}, {3.673913924793683*^9, 3.673914027240034*^9}, {
  3.673914160114106*^9, 3.673914221895009*^9}, {3.6739143916895742`*^9, 
  3.6739145331206093`*^9}, {3.673914594090477*^9, 3.673914610210465*^9}, {
  3.673914675219448*^9, 3.673914688962699*^9}, {3.673914833997225*^9, 
  3.673914867610242*^9}, {3.673914976578474*^9, 3.6739149854145193`*^9}, {
  3.673915022645698*^9, 3.6739150543556957`*^9}, {3.673915117319284*^9, 
  3.673915132081748*^9}, {3.673915279550877*^9, 3.673915293701923*^9}, {
  3.6739169166314077`*^9, 3.6739169534174833`*^9}, {3.673917107616473*^9, 
  3.673917107978497*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Algorithms to form the W Matrices", "Subsection",
 CellChangeTimes->{{3.673277052290266*^9, 3.673277061302971*^9}, {
  3.673277119209675*^9, 3.6732771212386723`*^9}, {3.673348508736053*^9, 
  3.673348513701818*^9}, {3.6737269924034224`*^9, 3.6737269925381393`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"lagrangeW", "[", 
    RowBox[{"lx_", ",", "ly_"}], "]"}], ":=", 
   RowBox[{"Flatten", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"fullIntegrate", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"\[Psi]", "[", 
                RowBox[{"lx", ",", "ly", ",", "i1", ",", "j1"}], "]"}], "[", 
               RowBox[{"#1", ",", "#2"}], "]"}], " ", 
              RowBox[{
               RowBox[{"\[Psi]", "[", 
                RowBox[{"lx", ",", "ly", ",", "i2", ",", "j2"}], "]"}], "[", 
               RowBox[{"#1", ",", "#2"}], "]"}]}], "&"}], ",", "lx", ",", 
            "ly"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i2", ",", "0", ",", 
            SuperscriptBox["2", "lx"]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"j2", ",", "0", ",", 
            SuperscriptBox["2", "ly"]}], "}"}]}], "]"}], "//", "Flatten"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"i1", ",", "0", ",", 
         SuperscriptBox["2", "lx"]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j1", ",", "0", ",", 
         SuperscriptBox["2", "lx"]}], "}"}]}], "]"}], ",", "1"}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"fullW", "[", 
    RowBox[{"lx_", ",", "ly_"}], "]"}], ":=", 
   RowBox[{"Flatten", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"fullIntegrate", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"\[Phi]", "[", 
                    RowBox[{"kx1", ",", "ky1", ",", "i1", ",", "j1"}], "]"}], 
                   "[", 
                   RowBox[{"#1", ",", "#2"}], "]"}], " ", 
                  RowBox[{
                   RowBox[{"\[Phi]", "[", 
                    RowBox[{"kx2", ",", "ky2", ",", "i2", ",", "j2"}], "]"}], 
                   "[", 
                   RowBox[{"#1", ",", "#2"}], "]"}]}], "&"}], ",", "lx", ",", 
                "ly"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"i2", ",", "1", ",", 
                SuperscriptBox["2", 
                 RowBox[{
                  RowBox[{"switch", "[", "kx2", "]"}], "-", "1"}]]}], "}"}], 
              ",", 
              RowBox[{"{", 
               RowBox[{"j2", ",", "1", ",", 
                SuperscriptBox["2", 
                 RowBox[{
                  RowBox[{"switch", "[", "ky2", "]"}], "-", "1"}]]}], "}"}]}],
              "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"kx2", ",", 
              RowBox[{"-", "1"}], ",", "lx"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"ky2", ",", 
              RowBox[{"-", "1"}], ",", "ly"}], "}"}]}], "]"}], "//", 
          "Flatten"}], ",", 
         RowBox[{"{", 
          RowBox[{"i1", ",", "1", ",", 
           SuperscriptBox["2", 
            RowBox[{
             RowBox[{"switch", "[", "kx1", "]"}], "-", "1"}]]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j1", ",", "1", ",", 
           SuperscriptBox["2", 
            RowBox[{
             RowBox[{"switch", "[", "ky1", "]"}], "-", "1"}]]}], "}"}]}], 
        "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"kx1", ",", 
         RowBox[{"-", "1"}], ",", "lx"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"ky1", ",", 
         RowBox[{"-", "1"}], ",", "ly"}], "}"}]}], "]"}], ",", "3"}], "]"}]}],
   "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fulldW", "[", 
   RowBox[{"lx_", ",", "ly_"}], "]"}], ":=", 
  RowBox[{"Flatten", "[", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"fullIntegrate", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"\[Phi]", "[", 
                    RowBox[{"kx1", ",", "ky1", ",", "i1", ",", "j1"}], "]"}], 
                   "[", 
                   RowBox[{"1", ",", "#"}], "]"}], " ", 
                  RowBox[{
                   RowBox[{"\[Phi]", "[", 
                    RowBox[{"kx2", ",", "ky2", ",", "i2", ",", "j2"}], "]"}], 
                   "[", 
                   RowBox[{"1", ",", "#"}], "]"}]}], "-", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"\[Phi]", "[", 
                    RowBox[{"kx1", ",", "ky1", ",", "i1", ",", "j1"}], "]"}], 
                   "[", 
                   RowBox[{"0", ",", "#"}], "]"}], " ", 
                  RowBox[{
                   RowBox[{"\[Phi]", "[", 
                    RowBox[{"kx2", ",", "ky2", ",", "i2", ",", "j2"}], "]"}], 
                   "[", 
                   RowBox[{"0", ",", "#"}], "]"}]}]}], "&"}], ",", "ly"}], 
              "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"i2", ",", "1", ",", 
               SuperscriptBox["2", 
                RowBox[{
                 RowBox[{"switch", "[", "kx2", "]"}], "-", "1"}]]}], "}"}], 
             ",", 
             RowBox[{"{", 
              RowBox[{"j2", ",", "1", ",", 
               SuperscriptBox["2", 
                RowBox[{
                 RowBox[{"switch", "[", "ky2", "]"}], "-", "1"}]]}], "}"}]}], 
            "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"kx2", ",", 
             RowBox[{"-", "1"}], ",", "lx"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"ky2", ",", 
             RowBox[{"-", "1"}], ",", "ly"}], "}"}]}], "]"}], "//", 
         "Flatten"}], ",", 
        RowBox[{"{", 
         RowBox[{"i1", ",", "1", ",", 
          SuperscriptBox["2", 
           RowBox[{
            RowBox[{"switch", "[", "kx1", "]"}], "-", "1"}]]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j1", ",", "1", ",", 
          SuperscriptBox["2", 
           RowBox[{
            RowBox[{"switch", "[", "ky1", "]"}], "-", "1"}]]}], "}"}]}], 
       "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"kx1", ",", 
        RowBox[{"-", "1"}], ",", "lx"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"ky1", ",", 
        RowBox[{"-", "1"}], ",", "ly"}], "}"}]}], "]"}], ",", "3"}], 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.67391540187792*^9, 3.673915430987019*^9}, {
  3.673916702154879*^9, 3.673916743203536*^9}, {3.6739168769210157`*^9, 
  3.673916877399384*^9}, {3.673916961162126*^9, 3.673916982587229*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"#", "[", 
      RowBox[{"[", 
       RowBox[{"i", ",", "i"}], "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "81"}], "}"}]}], "]"}], "&"}], "@", 
  RowBox[{"lagrangeW", "[", 
   RowBox[{"3", ",", "3"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.673915465616274*^9, 3.673915517652071*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ListPlot", "[", 
  RowBox[{"Flatten", "[", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"i", ",", " ", "j"}], " ", "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "0", ",", "1", ",", 
          RowBox[{"1", "/", 
           RowBox[{"GCD", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"2", "^", "5"}], " ", "i"}], ",", 
             RowBox[{"2", "^", 
              RowBox[{"(", "5", ")"}]}]}], "]"}]}]}], "}"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "0", ",", "1", ",", 
        RowBox[{"2", "^", 
         RowBox[{"(", 
          RowBox[{"-", "5"}], ")"}]}]}], "}"}]}], "]"}], ",", "1"}], "]"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.673914706220759*^9, 3.6739147549248867`*^9}, {
  3.67391482217739*^9, 3.673914823884624*^9}}],

Cell[BoxData[
 GraphicsBox[{{}, {{}, 
    {RGBColor[0.368417, 0.506779, 0.709798], PointSize[0.009166666666666668], 
     AbsoluteThickness[1.6], PointBox[CompressedData["
1:eJx91UFqwkAYxfHQm3iS3qFHKLjulXqEdueyCxdZuAgSJEiQMcY4xhg9Qlvo
UPqDtFDCnzeMM8l775s9vzzNH7Ise//6/37+//f6+Jff4AX8AS/hHF7BBbyG
S3gDV/AWruEdHOA93MAHuIWPcAef4Aif4R6+wAN8hUf4Bt9/2O+eOOn6IHFA
T+v1yQJd3yQu0AMc4bSfvlui68Oc/XPW69MVur713MXEs4ID3MIRHuB0HnOz
RjdHJb9fst6cbdDNnfeq2L/iPhX7mdstujmu2b9mvTnfoZt7fazv9Infzffo
vT1nmHg2cAt3cIR7eIBHOL0Pe2+Pbg96zob19uQB3d7U99675b4t+9m7R3R7
2PfYsd6ePqHb2/aSudX3fjfvFSeeA5zO49w4oztH9EnPeufMBd25Yy/pO889
sJ9z64ruHNPHI+udczf0O7pz0LnnXHOOOYecO84V54g9bm/by/awPWpv2ov2
oD1g7s21OTaH5s5cmSN9rG/1pT7UR/pGX/z64BN430S+
      "]]}, {}}, {}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{True, True},
  AxesLabel->{None, None},
  AxesOrigin->{0, 0},
  DisplayFunction->Identity,
  Frame->{{False, False}, {False, False}},
  FrameLabel->{{None, None}, {None, None}},
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  ImagePadding->All,
  Method->{"CoordinatesToolOptions" -> {"DisplayFunction" -> ({
        (Part[{{Identity, Identity}, {Identity, Identity}}, 1, 2][#]& )[
         Part[#, 1]], 
        (Part[{{Identity, Identity}, {Identity, Identity}}, 2, 2][#]& )[
         Part[#, 2]]}& ), "CopiedValueFunction" -> ({
        (Part[{{Identity, Identity}, {Identity, Identity}}, 1, 2][#]& )[
         Part[#, 1]], 
        (Part[{{Identity, Identity}, {Identity, Identity}}, 2, 2][#]& )[
         Part[#, 2]]}& )}},
  PlotRange->{{0, 1.}, {0, 1.}},
  PlotRangeClipping->True,
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {
     Scaled[0.02], 
     Scaled[0.05]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{{3.673914737086714*^9, 3.673914755241023*^9}, 
   3.673914826823433*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{"#", "+", 
      RowBox[{"Transpose", "@", "#"}]}], ")"}], "&"}], "@", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"dxMatrixStandard", "[", 
      RowBox[{"3", ",", "3"}], "]"}], ".", 
     RowBox[{"lagrangeW", "[", 
      RowBox[{"3", ",", "3"}], "]"}]}], ")"}]}], "//", 
  "MatrixPlot"}]], "Input",
 CellChangeTimes->{{3.673915645072382*^9, 3.673915649816988*^9}, {
  3.6739171700604353`*^9, 3.6739171720052032`*^9}}],

Cell[BoxData[
 GraphicsBox[RasterBox[CompressedData["
1:eJzt26FKQ1EYwPELJpuiyTKUJcFgFIQTFAymqw5MIoNlMQhiHIhgsPoOCiaZ
QR/AJA7R4NIGBuWGPYKI8w3ku3L9HTj8zmlf+6dvtrm30RrLsiwf3a/39xkm
kiQZ59n7+PrybpF2VnuLB+dv6Xgzb9cmH0qfiyTJ/2D/aPpqrf86+v+c8uci
SbLK6i9JkvHqL0mS8eovSZLx6i9JkvHqL0mS8eovSZJx2v8lSZIkSZIkSZIk
SZIkSZIkSZIkSZIkSZIkSZIkSZIkSZIkSZIkSZIkSZIkSZIkSZIkSZIkSZIk
SZIkSZIkSZIkSZIkSZIkSZIkSZIkSZIkSZIkSZIkSZIkSZIkSZIkSZIkSZIk
SZIkSZIkSZIkSZIkSZIkSZIkSZIkSZIkSZIkSZIkSZIkSZIkSZIkSZIkSZIk
SZIkSZIkSZIkSZIkSZIkSZIkSZIkSZIkSZIkSZIkSZIk+VvedIZ3W8VTGuzn
C3Ong/RcP1yZaXyUPhdJklV2vta+6F4+pubE9tL1/UvqTdU7tydF6XORJFll
9ZckyXj1lyTJePWXJMl49ZckyXj1lyTJePWXJMl47f+SJPl3/AT9LW8e
   "], {{0, 0}, {81, 
   81}}, {0, 1}],
  Frame->True,
  FrameLabel->{None, None},
  FrameTicks->{{{{80.5, 
       FormBox["1", TraditionalForm]}, {61.5, 
       FormBox["20", TraditionalForm]}, {41.5, 
       FormBox["40", TraditionalForm]}, {21.5, 
       FormBox["60", TraditionalForm]}, {0.5, 
       FormBox["81", TraditionalForm]}}, {{80.5, 
       FormBox["1", TraditionalForm]}, {61.5, 
       FormBox["20", TraditionalForm]}, {41.5, 
       FormBox["40", TraditionalForm]}, {21.5, 
       FormBox["60", TraditionalForm]}, {0.5, 
       FormBox["81", TraditionalForm]}}}, {{{0.5, 
       FormBox["1", TraditionalForm]}, {19.5, 
       FormBox["20", TraditionalForm]}, {39.5, 
       FormBox["40", TraditionalForm]}, {59.5, 
       FormBox["60", TraditionalForm]}, {80.5, 
       FormBox["81", TraditionalForm]}}, {{0.5, 
       FormBox["1", TraditionalForm]}, {19.5, 
       FormBox["20", TraditionalForm]}, {39.5, 
       FormBox["40", TraditionalForm]}, {59.5, 
       FormBox["60", TraditionalForm]}, {80.5, 
       FormBox["81", TraditionalForm]}}}},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  Method->{
   "AxisPadding" -> Scaled[0.02], "DefaultBoundaryStyle" -> Automatic, 
    "DefaultPlotStyle" -> Automatic, "DomainPadding" -> Scaled[0.02], 
    "RangePadding" -> Scaled[0.05]}]], "Output",
 CellChangeTimes->{3.673917187833446*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{"#", "+", 
      RowBox[{"Transpose", "@", "#"}], "-", 
      RowBox[{"fulldW", "[", 
       RowBox[{"3", ",", "3"}], "]"}]}], ")"}], "&"}], "@", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"dxMatrix", "[", 
      RowBox[{"3", ",", "3"}], "]"}], ".", 
     RowBox[{"fullW", "[", 
      RowBox[{"3", ",", "3"}], "]"}]}], ")"}]}], "//", 
  "MatrixPlot"}]], "Input",
 CellChangeTimes->{{3.673916770763542*^9, 3.673916777372099*^9}, {
  3.673916993877161*^9, 3.6739169946485558`*^9}, {3.673917154875722*^9, 
  3.673917162181484*^9}}],

Cell[BoxData[
 GraphicsBox[
  RasterBox[SparseArray[
   Automatic, {81, 81}, 1., {
    1, {{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
      0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
      0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
      0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}, {}}, Pattern}], {{0, 0}, {81, 81}}, {
   0, 1}],
  Frame->True,
  FrameLabel->{None, None},
  FrameTicks->{{{{80.5, 
       FormBox["1", TraditionalForm]}, {61.5, 
       FormBox["20", TraditionalForm]}, {41.5, 
       FormBox["40", TraditionalForm]}, {21.5, 
       FormBox["60", TraditionalForm]}, {0.5, 
       FormBox["81", TraditionalForm]}}, {{80.5, 
       FormBox["1", TraditionalForm]}, {61.5, 
       FormBox["20", TraditionalForm]}, {41.5, 
       FormBox["40", TraditionalForm]}, {21.5, 
       FormBox["60", TraditionalForm]}, {0.5, 
       FormBox["81", TraditionalForm]}}}, {{{0.5, 
       FormBox["1", TraditionalForm]}, {19.5, 
       FormBox["20", TraditionalForm]}, {39.5, 
       FormBox["40", TraditionalForm]}, {59.5, 
       FormBox["60", TraditionalForm]}, {80.5, 
       FormBox["81", TraditionalForm]}}, {{0.5, 
       FormBox["1", TraditionalForm]}, {19.5, 
       FormBox["20", TraditionalForm]}, {39.5, 
       FormBox["40", TraditionalForm]}, {59.5, 
       FormBox["60", TraditionalForm]}, {80.5, 
       FormBox["81", TraditionalForm]}}}},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  Method->{
   "AxisPadding" -> Scaled[0.02], "DefaultBoundaryStyle" -> Automatic, 
    "DefaultPlotStyle" -> Automatic, "DomainPadding" -> Scaled[0.02], 
    "RangePadding" -> Scaled[0.05]}]], "Output",
 CellChangeTimes->{3.673917231793943*^9}]
}, Open  ]]
}, Open  ]]
},
WindowSize->{808, 651},
WindowMargins->{{4, Automatic}, {Automatic, 4}},
FrontEndVersion->"10.4 for Mac OS X x86 (32-bit, 64-bit Kernel) (February 25, \
2016)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 110, 1, 44, "Subsection"],
Cell[693, 25, 8727, 221, 458, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[9457, 251, 176, 2, 44, "Subsection"],
Cell[9636, 255, 2290, 59, 127, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[11963, 319, 146, 2, 44, "Subsection"],
Cell[12112, 323, 10165, 228, 448, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[22314, 556, 100, 1, 44, "Subsection"],
Cell[22417, 559, 8142, 187, 402, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[30596, 751, 154, 2, 44, "Subsection"],
Cell[30753, 755, 4020, 115, 259, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[34810, 875, 267, 3, 44, "Subsection"],
Cell[35080, 880, 5944, 150, 326, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[41061, 1035, 315, 4, 44, "Subsection"],
Cell[41379, 1041, 3564, 95, 154, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[44980, 1141, 271, 3, 44, "Subsection"],
Cell[45254, 1146, 6876, 186, 484, "Input"],
Cell[52133, 1334, 401, 12, 28, "Input"],
Cell[CellGroupData[{
Cell[52559, 1350, 911, 26, 46, "Input"],
Cell[53473, 1378, 1930, 44, 244, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[55440, 1427, 497, 15, 28, "Input"],
Cell[55940, 1444, 2025, 43, 378, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[58002, 1492, 607, 18, 28, "Input"],
Cell[58612, 1512, 1732, 38, 412, "Output"]
}, Open  ]]
}, Open  ]]
}
]
*)

(* End of internal cache information *)

