(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.4' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     87169,       2317]
NotebookOptionsPosition[     84767,       2236]
NotebookOutlinePosition[     85124,       2252]
CellTagsIndexPosition[     85081,       2249]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"switch", "[", "x_", "]"}], ":=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"x", ">", "0"}], ",", "x", ",", "0"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ceil", "[", 
   RowBox[{"x_", ",", "l_Integer"}], "]"}], ":=", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"x", "\[GreaterEqual]", "1"}], ",", 
    SuperscriptBox["2", 
     RowBox[{"l", "-", "1"}]], ",", 
    RowBox[{"1", "+", 
     RowBox[{"Floor", "[", 
      RowBox[{
       SuperscriptBox["2", 
        RowBox[{"l", "-", "1"}]], "x"}], "]"}]}]}], "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.675530697996972*^9, 3.675530709604784*^9}, {
  3.675530784757474*^9, 3.6755307854699507`*^9}, {3.675557179959766*^9, 
  3.675557180440319*^9}, {3.675598722564789*^9, 3.675598722754263*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Lambda]", "[", 
   RowBox[{"f_", ",", "a_", ",", "g_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"f", "[", "#", "]"}], "+", 
    RowBox[{"a", " ", 
     RowBox[{"g", "[", "#", "]"}]}]}], "&"}]}]], "Input",
 CellChangeTimes->{{3.6757060305371532`*^9, 3.6757060700827723`*^9}, {
  3.6757072978799334`*^9, 3.675707302108508*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"legendre", "[", 
   RowBox[{"n_", ",", "x_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"LegendreP", "[", 
    RowBox[{
     RowBox[{"n", "-", "1"}], ",", 
     RowBox[{
      RowBox[{"2", " ", "x"}], "-", "1"}]}], "]"}], " ", 
   SqrtBox[
    RowBox[{
     RowBox[{"2", " ", 
      RowBox[{"(", 
       RowBox[{"n", "-", "1"}], ")"}]}], "+", 
     "1"}]]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"h", "[", 
   RowBox[{"1", ",", "1", ",", "x_"}], "]"}], ":=", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Abs", "[", "x", "]"}], ">", "1"}], ",", "0", ",", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"x", "\[GreaterEqual]", "0"}], ",", 
      FractionBox["1", 
       SqrtBox["2"]], ",", 
      RowBox[{"-", 
       FractionBox["1", 
        SqrtBox["2"]]}]}], "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"h", "[", 
   RowBox[{"2", ",", "1", ",", "x_"}], "]"}], ":=", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Abs", "[", "x", "]"}], ">", "1"}], ",", "0", ",", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"x", "\[GreaterEqual]", "0"}], ",", 
      RowBox[{
       SqrtBox[
        FractionBox["3", "2"]], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         RowBox[{"2", " ", "x"}]}], ")"}]}], ",", 
      RowBox[{"h", "[", 
       RowBox[{"2", ",", "1", ",", 
        RowBox[{"-", "x"}]}], "]"}]}], "]"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"h", "[", 
   RowBox[{"2", ",", "2", ",", "x_"}], "]"}], ":=", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Abs", "[", "x", "]"}], ">", "1"}], ",", "0", ",", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"x", "\[GreaterEqual]", "0"}], ",", 
      RowBox[{
       SqrtBox[
        FractionBox["1", "2"]], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "2"}], "+", 
         RowBox[{"3", " ", "x"}]}], ")"}]}], ",", 
      RowBox[{"-", 
       RowBox[{"h", "[", 
        RowBox[{"2", ",", "2", ",", 
         RowBox[{"-", "x"}]}], "]"}]}]}], "]"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"h", "[", 
   RowBox[{"3", ",", "1", ",", "x_"}], "]"}], ":=", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Abs", "[", "x", "]"}], ">", "1"}], ",", "0", ",", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"x", "\[GreaterEqual]", "0"}], ",", 
      RowBox[{
       FractionBox["1", "3"], " ", 
       SqrtBox[
        FractionBox["1", "2"]], " ", 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"24", " ", "x"}], "+", 
         RowBox[{"30", " ", 
          SuperscriptBox["x", "2"]}]}], ")"}]}], ",", 
      RowBox[{"-", 
       RowBox[{"h", "[", 
        RowBox[{"3", ",", "1", ",", 
         RowBox[{"-", "x"}]}], "]"}]}]}], "]"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"h", "[", 
   RowBox[{"3", ",", "2", ",", "x_"}], "]"}], ":=", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Abs", "[", "x", "]"}], ">", "1"}], ",", "0", ",", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"x", "\[GreaterEqual]", "0"}], ",", 
      RowBox[{
       FractionBox["1", "2"], " ", 
       SqrtBox[
        FractionBox["3", "2"]], " ", 
       RowBox[{"(", 
        RowBox[{"3", "-", 
         RowBox[{"16", " ", "x"}], "+", 
         RowBox[{"15", " ", 
          SuperscriptBox["x", "2"]}]}], ")"}]}], ",", 
      RowBox[{"h", "[", 
       RowBox[{"3", ",", "2", ",", 
        RowBox[{"-", "x"}]}], "]"}]}], "]"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"h", "[", 
   RowBox[{"3", ",", "3", ",", "x_"}], "]"}], ":=", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Abs", "[", "x", "]"}], ">", "1"}], ",", "0", ",", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"x", "\[GreaterEqual]", "0"}], ",", 
      RowBox[{
       FractionBox["1", "3"], " ", 
       SqrtBox[
        FractionBox["5", "2"]], " ", 
       RowBox[{"(", 
        RowBox[{"4", "-", 
         RowBox[{"15", " ", "x"}], "+", 
         RowBox[{"12", " ", 
          SuperscriptBox["x", "2"]}]}], ")"}]}], ",", 
      RowBox[{"-", 
       RowBox[{"h", "[", 
        RowBox[{"3", ",", "3", ",", 
         RowBox[{"-", "x"}]}], "]"}]}]}], "]"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"h", "[", 
   RowBox[{"4", ",", "1", ",", "x_"}], "]"}], ":=", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Abs", "[", "x", "]"}], ">", "1"}], ",", "0", ",", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"x", "\[GreaterEqual]", "0"}], ",", " ", 
      RowBox[{
       SqrtBox[
        FractionBox["15", "34"]], " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", 
         RowBox[{"4", "x"}], "-", 
         RowBox[{"30", 
          SuperscriptBox["x", "2"]}], "+", 
         RowBox[{"28", " ", 
          SuperscriptBox["x", "3"]}]}], ")"}]}], ",", 
      RowBox[{"h", "[", 
       RowBox[{"4", ",", "1", ",", 
        RowBox[{"-", "x"}]}], "]"}]}], "]"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"h", "[", 
   RowBox[{"4", ",", "2", ",", "x_"}], "]"}], ":=", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Abs", "[", "x", "]"}], ">", "1"}], ",", "0", ",", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"x", "\[GreaterEqual]", "0"}], ",", " ", 
      RowBox[{
       SqrtBox[
        FractionBox["1", "42"]], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "4"}], "+", 
         RowBox[{"105", "x"}], "-", 
         RowBox[{"300", 
          SuperscriptBox["x", "2"]}], "+", 
         RowBox[{"210", " ", 
          SuperscriptBox["x", "3"]}]}], ")"}]}], ",", 
      RowBox[{"-", 
       RowBox[{"h", "[", 
        RowBox[{"4", ",", "2", ",", 
         RowBox[{"-", "x"}]}], "]"}]}]}], "]"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"h", "[", 
   RowBox[{"4", ",", "3", ",", "x_"}], "]"}], ":=", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Abs", "[", "x", "]"}], ">", "1"}], ",", "0", ",", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"x", "\[GreaterEqual]", "0"}], ",", 
      RowBox[{
       FractionBox["1", "2"], " ", 
       SqrtBox[
        FractionBox["35", "34"]], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "5"}], "+", 
         RowBox[{"48", "x"}], "-", 
         RowBox[{"105", 
          SuperscriptBox["x", "2"]}], "+", 
         RowBox[{"64", " ", 
          SuperscriptBox["x", "3"]}]}], ")"}]}], ",", 
      RowBox[{"h", "[", 
       RowBox[{"4", ",", "3", ",", 
        RowBox[{"-", "x"}]}], "]"}]}], "]"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"h", "[", 
   RowBox[{"4", ",", "4", ",", "x_"}], "]"}], ":=", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Abs", "[", "x", "]"}], ">", "1"}], ",", "0", ",", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"x", "\[GreaterEqual]", "0"}], ",", " ", 
      RowBox[{
       FractionBox["1", "2"], 
       SqrtBox[
        FractionBox["5", "42"]], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "16"}], "+", 
         RowBox[{"105", "x"}], "-", 
         RowBox[{"192", 
          SuperscriptBox["x", "2"]}], "+", 
         RowBox[{"105", " ", 
          SuperscriptBox["x", "3"]}]}], ")"}]}], ",", 
      RowBox[{"-", 
       RowBox[{"h", "[", 
        RowBox[{"4", ",", "4", ",", 
         RowBox[{"-", "x"}]}], "]"}]}]}], "]"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"h", "[", 
   RowBox[{"5", ",", "1", ",", "x_"}], "]"}], ":=", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Abs", "[", "x", "]"}], ">", "1"}], ",", "0", ",", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"x", "\[GreaterEqual]", "0"}], ",", 
      RowBox[{
       SqrtBox[
        FractionBox["1", "186"]], " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", 
         RowBox[{"30", "x"}], "+", 
         RowBox[{"210", 
          SuperscriptBox["x", "2"]}], "-", 
         RowBox[{"840", " ", 
          SuperscriptBox["x", "3"]}], "+", 
         RowBox[{"630", 
          SuperscriptBox["x", "4"]}]}], ")"}]}], ",", 
      RowBox[{"-", 
       RowBox[{"h", "[", 
        RowBox[{"5", ",", "1", ",", 
         RowBox[{"-", "x"}]}], "]"}]}]}], "]"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"h", "[", 
   RowBox[{"5", ",", "2", ",", "x_"}], "]"}], ":=", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Abs", "[", "x", "]"}], ">", "1"}], ",", "0", ",", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"x", "\[GreaterEqual]", "0"}], ",", 
      RowBox[{
       FractionBox["1", "2"], 
       SqrtBox[
        FractionBox["1", "38"]], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "5"}], "-", 
         RowBox[{"144", "x"}], "+", 
         RowBox[{"1155", 
          SuperscriptBox["x", "2"]}], "-", 
         RowBox[{"2240", " ", 
          SuperscriptBox["x", "3"]}], "+", 
         RowBox[{"1260", 
          SuperscriptBox["x", "4"]}]}], ")"}]}], ",", 
      RowBox[{"h", "[", 
       RowBox[{"5", ",", "2", ",", 
        RowBox[{"-", "x"}]}], "]"}]}], "]"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"h", "[", 
   RowBox[{"5", ",", "3", ",", "x_"}], "]"}], ":=", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Abs", "[", "x", "]"}], ">", "1"}], ",", "0", ",", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"x", "\[GreaterEqual]", "0"}], ",", 
      RowBox[{
       SqrtBox[
        FractionBox["35", "14694"]], " ", 
       RowBox[{"(", 
        RowBox[{"22", "-", 
         RowBox[{"735", "x"}], "+", 
         RowBox[{"3504", 
          SuperscriptBox["x", "2"]}], "-", 
         RowBox[{"5460", " ", 
          SuperscriptBox["x", "3"]}], "+", 
         RowBox[{"2700", 
          SuperscriptBox["x", "4"]}]}], ")"}]}], ",", 
      RowBox[{"-", 
       RowBox[{"h", "[", 
        RowBox[{"5", ",", "3", ",", 
         RowBox[{"-", "x"}]}], "]"}]}]}], "]"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"h", "[", 
   RowBox[{"5", ",", "4", ",", "x_"}], "]"}], ":=", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Abs", "[", "x", "]"}], ">", "1"}], ",", "0", ",", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"x", "\[GreaterEqual]", "0"}], ",", 
      RowBox[{
       FractionBox["1", "8"], 
       SqrtBox[
        FractionBox["21", "38"]], " ", 
       RowBox[{"(", 
        RowBox[{"35", "-", 
         RowBox[{"512", "x"}], "+", 
         RowBox[{"1890", 
          SuperscriptBox["x", "2"]}], "-", 
         RowBox[{"2560", " ", 
          SuperscriptBox["x", "3"]}], "+", 
         RowBox[{"1155", 
          SuperscriptBox["x", "4"]}]}], ")"}]}], ",", 
      RowBox[{"h", "[", 
       RowBox[{"5", ",", "4", ",", 
        RowBox[{"-", "x"}]}], "]"}]}], "]"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"h", "[", 
   RowBox[{"5", ",", "5", ",", "x_"}], "]"}], ":=", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Abs", "[", "x", "]"}], ">", "1"}], ",", "0", ",", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"x", "\[GreaterEqual]", "0"}], ",", 
      RowBox[{
       FractionBox["1", "2"], 
       SqrtBox[
        FractionBox["7", "158"]], " ", 
       RowBox[{"(", 
        RowBox[{"32", "-", 
         RowBox[{"315", "x"}], "+", 
         RowBox[{"960", 
          SuperscriptBox["x", "2"]}], "-", 
         RowBox[{"1155", " ", 
          SuperscriptBox["x", "3"]}], "+", 
         RowBox[{"480", 
          SuperscriptBox["x", "4"]}]}], ")"}]}], ",", 
      RowBox[{"-", 
       RowBox[{"h", "[", 
        RowBox[{"5", ",", "5", ",", 
         RowBox[{"-", "x"}]}], "]"}]}]}], "]"}]}], "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.675447334184072*^9, 3.675447464213695*^9}, {
  3.675447544245944*^9, 3.675447615694927*^9}, {3.6754476549568033`*^9, 
  3.675447686386791*^9}, {3.675447716966317*^9, 3.6754477235600357`*^9}, {
  3.675448007387443*^9, 3.675448016070777*^9}, {3.675528282866611*^9, 
  3.675528320546008*^9}, {3.67552914761718*^9, 3.675529155105283*^9}, {
  3.675529368119573*^9, 3.675529374163878*^9}, {3.675529643493765*^9, 
  3.6755296881587057`*^9}, {3.675541707759493*^9, 3.675541762689043*^9}, {
  3.675549367860647*^9, 3.675549463685646*^9}, {3.675550177804304*^9, 
  3.675550301656516*^9}, {3.6755503385854197`*^9, 3.675550625933754*^9}, {
  3.675550703098613*^9, 3.675550841347681*^9}, {3.675550884121045*^9, 
  3.675550895381874*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"fk", "[", 
   RowBox[{"k_", ",", "fnumber_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"h", "[", 
    RowBox[{"k", ",", "fnumber", ",", "#"}], "]"}], "&"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.675551380531869*^9, 3.675551421155471*^9}, {
  3.6755516845361967`*^9, 3.675551688590851*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"vk", "[", 
   RowBox[{"k_", ",", "fnumber_", ",", "level_", ",", "place_"}], "]"}], ":=", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"level", "\[Equal]", "0"}], ",", 
    RowBox[{
     RowBox[{"legendre", "[", 
      RowBox[{"fnumber", ",", "#1"}], "]"}], "&"}], ",", 
    RowBox[{
     RowBox[{
      SuperscriptBox["2", 
       RowBox[{"level", "/", "2"}]], " ", 
      RowBox[{
       RowBox[{"fk", "[", 
        RowBox[{"k", ",", "fnumber"}], "]"}], "[", 
       RowBox[{
        RowBox[{
         SuperscriptBox["2", "level"], " ", "#1"}], "-", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", " ", "place"}], "-", "1"}], ")"}]}], "]"}]}], "&"}]}], 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.675551428128154*^9, 3.6755514522251177`*^9}, {
  3.675551689944075*^9, 3.6755516941769648`*^9}, {3.675555714578012*^9, 
  3.675555719849732*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Vk", "[", 
   RowBox[{"k_", ",", "fnumber_List", ",", "level_List", ",", "place_List"}], 
   "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"vk", "[", 
      RowBox[{"k", ",", 
       RowBox[{
       "fnumber", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], ",", 
       RowBox[{
       "level", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], ",", 
       RowBox[{
       "place", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
      "]"}], "[", 
     RowBox[{"#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
     "]"}], 
    RowBox[{
     RowBox[{"vk", "[", 
      RowBox[{"k", ",", 
       RowBox[{
       "fnumber", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], ",", 
       RowBox[{
       "level", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], ",", 
       RowBox[{
       "place", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
      "]"}], "[", 
     RowBox[{"#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
     "]"}]}], "&"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Tensor", " ", "Product", " ", "Construction"}], 
   "*)"}]}]}], "Input",
 CellChangeTimes->{{3.6755574008683023`*^9, 3.6755574772125063`*^9}, {
   3.675596297284898*^9, 3.6755963117338247`*^9}, {3.675597944503475*^9, 
   3.6755979562005568`*^9}, 3.675604234073991*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"innerProduct", "[", 
    RowBox[{
    "f_", ",", "g_", ",", "level_List", ",", "place_List", ",", 
     "\[Epsilon]_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["\[Epsilon]", "2"], " ", 
      SuperscriptBox["2", 
       RowBox[{"-", 
        RowBox[{"switch", "[", 
         RowBox[{
          RowBox[{
          "level", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
          "-", "1"}], "]"}]}]], 
      SuperscriptBox["2", 
       RowBox[{"-", 
        RowBox[{"switch", "[", 
         RowBox[{
          RowBox[{
          "level", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
          "-", "1"}], "]"}]}]]}], ")"}], 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"f", "[", 
        RowBox[{"{", 
         RowBox[{"x", ",", "y"}], "}"}], "]"}], " ", 
       RowBox[{"g", "[", 
        RowBox[{"{", 
         RowBox[{"x", ",", "y"}], "}"}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"x", ",", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
           "place", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
           "-", "1"}], ")"}], " ", 
         SuperscriptBox["2", 
          RowBox[{"-", 
           RowBox[{"switch", "[", 
            RowBox[{
             RowBox[{
             "level", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
             "-", "1"}], "]"}]}]]}], ",", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
          "place", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
          ")"}], " ", 
         SuperscriptBox["2", 
          RowBox[{"-", 
           RowBox[{"switch", "[", 
            RowBox[{
             RowBox[{
             "level", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
             "-", "1"}], "]"}]}]]}], ",", "\[IndentingNewLine]", 
        RowBox[{"\[Epsilon]", " ", 
         SuperscriptBox["2", 
          RowBox[{"-", 
           RowBox[{"switch", "[", 
            RowBox[{
             RowBox[{
             "level", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
             "-", "1"}], "]"}]}]]}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"y", ",", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
           "place", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
           "-", "1"}], ")"}], " ", 
         SuperscriptBox["2", 
          RowBox[{"-", 
           RowBox[{"switch", "[", 
            RowBox[{
             RowBox[{
             "level", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
             "-", "1"}], "]"}]}]]}], ",", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
          "place", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
          ")"}], " ", 
         SuperscriptBox["2", 
          RowBox[{"-", 
           RowBox[{"switch", "[", 
            RowBox[{
             RowBox[{
             "level", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
             "-", "1"}], "]"}]}]]}], ",", 
        RowBox[{"\[Epsilon]", " ", 
         SuperscriptBox["2", 
          RowBox[{"-", 
           RowBox[{"switch", "[", 
            RowBox[{
             RowBox[{
             "level", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
             "-", "1"}], "]"}]}]]}]}], "}"}]}], "]"}]}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"innerProduct", "[", 
   RowBox[{"f_", ",", "g_", ",", "level_List", ",", "place_List"}], "]"}], ":=", 
  RowBox[{"NIntegrate", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"f", "[", 
      RowBox[{"{", 
       RowBox[{"x", ",", "y"}], "}"}], "]"}], " ", 
     RowBox[{"g", "[", 
      RowBox[{"{", 
       RowBox[{"x", ",", "y"}], "}"}], "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"x", ",", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
         "place", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "-",
          "1"}], ")"}], " ", 
       SuperscriptBox["2", 
        RowBox[{"-", 
         RowBox[{"switch", "[", 
          RowBox[{
           RowBox[{
           "level", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
           "-", "1"}], "]"}]}]]}], ",", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
        "place", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
        ")"}], " ", 
       SuperscriptBox["2", 
        RowBox[{"-", 
         RowBox[{"switch", "[", 
          RowBox[{
           RowBox[{
           "level", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
           "-", "1"}], "]"}]}]]}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"y", ",", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
         "place", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], "-",
          "1"}], ")"}], " ", 
       SuperscriptBox["2", 
        RowBox[{"-", 
         RowBox[{"switch", "[", 
          RowBox[{
           RowBox[{
           "level", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
           "-", "1"}], "]"}]}]]}], ",", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
        "place", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
        ")"}], " ", 
       SuperscriptBox["2", 
        RowBox[{"-", 
         RowBox[{"switch", "[", 
          RowBox[{
           RowBox[{
           "level", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
           "-", "1"}], "]"}]}]]}]}], "}"}], ",", 
    RowBox[{"AccuracyGoal", "\[Rule]", "5"}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.67555751405438*^9, 3.6755576031180077`*^9}, {
   3.675557651394096*^9, 3.675557691767502*^9}, {3.675595807015128*^9, 
   3.675595863687018*^9}, {3.6755979021319017`*^9, 3.675597904575652*^9}, {
   3.675598149255072*^9, 3.675598249439992*^9}, {3.6755983007145233`*^9, 
   3.675598312965866*^9}, {3.675598414743586*^9, 3.675598457517686*^9}, 
   3.675604682498172*^9, {3.675604892236114*^9, 3.675604892597993*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"hierIterate", "[", 
    RowBox[{"k_", ",", "n_List", ",", "lp_List"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "fnumber", ",", "level", ",", "place", ",", "hashMap", ",", "count"}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"hashMap", "=", 
       RowBox[{"Table", "[", 
        RowBox[{"0", ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"k", " ", 
            SuperscriptBox["2", 
             RowBox[{
             "n", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]]}]}],
           "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"count", "=", "1"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "n", "]"}], "\[Equal]", "1"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"For", "[", 
          RowBox[{
           RowBox[{"level", "=", "0"}], ",", 
           RowBox[{"level", "\[LessEqual]", 
            RowBox[{
            "n", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
           ",", 
           RowBox[{"level", "++"}], ",", "\[IndentingNewLine]", 
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{"place", "=", "1"}], ",", 
             RowBox[{"place", "\[LessEqual]", 
              SuperscriptBox["2", 
               RowBox[{"switch", "[", 
                RowBox[{"level", "-", "1"}], "]"}]]}], ",", 
             RowBox[{"place", "++"}], ",", "\[IndentingNewLine]", 
             RowBox[{"For", "[", 
              RowBox[{
               RowBox[{"fnumber", "=", "1"}], ",", 
               RowBox[{"fnumber", "\[LessEqual]", "k"}], ",", 
               RowBox[{"fnumber", "++"}], ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{
                 RowBox[{"hashMap", "\[LeftDoubleBracket]", 
                  RowBox[{"count", "++"}], "\[RightDoubleBracket]"}], "=", 
                 RowBox[{"Join", "[", 
                  RowBox[{"lp", ",", 
                   RowBox[{"{", 
                    RowBox[{"fnumber", ",", 
                    RowBox[{"level", "+", "1"}], ",", "place"}], "}"}]}], 
                  "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}]}], "]"}]}], 
          "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"Return", "[", 
          RowBox[{"Partition", "[", 
           RowBox[{
            RowBox[{"Flatten", "[", "hashMap", "]"}], ",", 
            RowBox[{"3", " ", 
             RowBox[{"Length", "[", "n", "]"}]}]}], "]"}], "]"}], ";"}], 
        "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"For", "[", 
          RowBox[{
           RowBox[{"level", "=", "0"}], ",", 
           RowBox[{"level", "\[LessEqual]", 
            RowBox[{
            "n", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
           ",", 
           RowBox[{"level", "++"}], ",", "\[IndentingNewLine]", 
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{"place", "=", "1"}], ",", 
             RowBox[{"place", "\[LessEqual]", 
              SuperscriptBox["2", 
               RowBox[{"switch", "[", 
                RowBox[{"level", "-", "1"}], "]"}]]}], ",", 
             RowBox[{"place", "++"}], ",", "\[IndentingNewLine]", 
             RowBox[{"For", "[", 
              RowBox[{
               RowBox[{"fnumber", "=", "1"}], ",", 
               RowBox[{"fnumber", "\[LessEqual]", "k"}], ",", 
               RowBox[{"fnumber", "++"}], ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{
                 RowBox[{"hashMap", "\[LeftDoubleBracket]", 
                  RowBox[{"count", "++"}], "\[RightDoubleBracket]"}], "=", 
                 RowBox[{"hierIterate", "[", 
                  RowBox[{"k", ",", 
                   RowBox[{"n", "\[LeftDoubleBracket]", 
                    RowBox[{"2", ";;"}], "\[RightDoubleBracket]"}], ",", 
                   RowBox[{"Join", "[", 
                    RowBox[{"lp", ",", 
                    RowBox[{"{", 
                    RowBox[{"fnumber", ",", 
                    RowBox[{"level", "+", "1"}], ",", "place"}], "}"}]}], 
                    "]"}]}], "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}]}],
             "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"Return", "[", 
          RowBox[{"Partition", "[", 
           RowBox[{
            RowBox[{"Flatten", "[", "hashMap", "]"}], ",", 
            RowBox[{"3", " ", 
             RowBox[{"Length", "[", "n", "]"}]}]}], "]"}], "]"}], ";"}]}], 
       "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"hierIterate", "[", 
    RowBox[{"k_", ",", "n_List"}], "]"}], ":=", 
   RowBox[{"hierIterate", "[", 
    RowBox[{"k", ",", "n", ",", 
     RowBox[{"{", "}"}]}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"hierLevFuncIterate", "[", 
    RowBox[{"k_", ",", "n_List", ",", "l_List"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"count", ",", "level", ",", "fnumber", ",", "hashMap"}], "}"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "n", "]"}], "\[Equal]", "1"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"count", "=", "1"}], ";", "\[IndentingNewLine]", 
        RowBox[{"hashMap", "=", 
         RowBox[{"Table", "[", 
          RowBox[{"0", ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", 
             RowBox[{"k", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "n", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
                "+", "1"}], ")"}]}]}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"level", "=", "0"}], ",", 
          RowBox[{"level", "\[LessEqual]", 
           RowBox[{
           "n", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], ",", 
          RowBox[{"level", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"fnumber", "=", "1"}], ",", 
            RowBox[{"fnumber", "\[LessEqual]", "k"}], ",", 
            RowBox[{"fnumber", "++"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"hashMap", "\[LeftDoubleBracket]", 
               RowBox[{"count", "++"}], "\[RightDoubleBracket]"}], "=", 
              RowBox[{"Join", "[", 
               RowBox[{"l", ",", 
                RowBox[{"{", 
                 RowBox[{"fnumber", ",", 
                  RowBox[{"level", "+", "1"}]}], "}"}]}], "]"}]}], ";"}]}], 
           "\[IndentingNewLine]", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
        
        RowBox[{"Return", "[", "hashMap", "]"}], ";"}], "\[IndentingNewLine]",
        ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"count", "=", "1"}], ";", "\[IndentingNewLine]", 
        RowBox[{"hashMap", "=", 
         RowBox[{"Table", "[", 
          RowBox[{"0", ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", 
             RowBox[{"k", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "n", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
                "+", "1"}], ")"}]}]}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"level", "=", "0"}], ",", 
          RowBox[{"level", "\[LessEqual]", 
           RowBox[{
           "n", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], ",", 
          RowBox[{"level", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"fnumber", "=", "1"}], ",", 
            RowBox[{"fnumber", "\[LessEqual]", "k"}], ",", 
            RowBox[{"fnumber", "++"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"hashMap", "\[LeftDoubleBracket]", 
               RowBox[{"count", "++"}], "\[RightDoubleBracket]"}], "=", 
              RowBox[{"hierLevFuncIterate", "[", 
               RowBox[{"k", ",", 
                RowBox[{"n", "\[LeftDoubleBracket]", 
                 RowBox[{"2", ";;"}], "\[RightDoubleBracket]"}], ",", 
                RowBox[{"Join", "[", 
                 RowBox[{"l", ",", 
                  RowBox[{"{", 
                   RowBox[{"fnumber", ",", 
                    RowBox[{"level", "+", "1"}]}], "}"}]}], "]"}]}], "]"}]}], 
             ";"}]}], "\[IndentingNewLine]", "]"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "hashMap", "]"}]}]}], "\[IndentingNewLine]", 
      "]"}]}], "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"hierLevFuncIterate", "[", 
   RowBox[{"k_", ",", "n_List"}], "]"}], ":=", 
  RowBox[{"Partition", "[", 
   RowBox[{
    RowBox[{"Flatten", "[", 
     RowBox[{"hierLevFuncIterate", "[", 
      RowBox[{"k", ",", "n", ",", 
       RowBox[{"{", "}"}]}], "]"}], "]"}], ",", 
    RowBox[{"2", " ", 
     RowBox[{"Length", "[", "n", "]"}]}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.6755963454668493`*^9, 3.675596349361437*^9}, {
   3.675596435030635*^9, 3.6755965372829933`*^9}, {3.675596570077107*^9, 
   3.675596601346223*^9}, {3.675596709773736*^9, 3.675596765698435*^9}, {
   3.67559680310684*^9, 3.675596949178554*^9}, {3.67559698907086*^9, 
   3.675596998515541*^9}, {3.675597063444777*^9, 3.675597063693513*^9}, {
   3.675597113600189*^9, 3.675597113855936*^9}, 3.6755973082648993`*^9, 
   3.675597354395906*^9, {3.675600547518127*^9, 3.6756009595883827`*^9}, {
   3.675601010639557*^9, 3.67560101844876*^9}, {3.6756010528958883`*^9, 
   3.675601070303954*^9}, {3.67560116211063*^9, 3.675601231424816*^9}, {
   3.6756013090034513`*^9, 3.675601310985058*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"pointIndex", "[", 
   RowBox[{"x_", ",", "l_Integer"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"k", "\[LessEqual]", "1"}], ",", "1", ",", 
        RowBox[{"ceil", "[", 
         RowBox[{"x", ",", "k"}], "]"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"k", ",", "0", ",", "l"}], "}"}]}], "]"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pointIndex", "[", 
   RowBox[{"x_List", ",", "l_List"}], "]"}], ":=", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"pointIndex", "[", 
     RowBox[{
      RowBox[{"x", "[", 
       RowBox[{"[", "i", "]"}], "]"}], ",", 
      RowBox[{"l", "[", 
       RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "1", ",", 
      RowBox[{"Length", "[", "l", "]"}]}], "}"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"spointIndex", "[", 
   RowBox[{"x_List", ",", "n_Integer"}], "]"}], ":=", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"pointIndex", "[", 
     RowBox[{
      RowBox[{"x", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
      ",", "n"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "1", ",", 
      RowBox[{"Length", "[", "x", "]"}]}], "}"}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.675699981315504*^9, 3.6756999840303307`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"getCoefficientsk", "[", 
    RowBox[{
    "k_", ",", "f_", ",", "fnumber_List", ",", "level_List", ",", 
     "place_List"}], "]"}], ":=", 
   RowBox[{"innerProduct", "[", 
    RowBox[{"f", ",", 
     RowBox[{"Vk", "[", 
      RowBox[{"k", ",", "fnumber", ",", "level", ",", "place"}], "]"}], ",", 
     "level", ",", "place"}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"fullCoefficientsk", "[", 
    RowBox[{"k_", ",", "f_", ",", "n_List"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"iters", ",", "i", ",", "hash", ",", "count", ",", "coeff"}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"iters", "=", 
       RowBox[{"hierIterate", "[", 
        RowBox[{"k", ",", "n"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"hash", "=", 
       RowBox[{"Table", "[", 
        RowBox[{"0", ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "[", "iters", "]"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"i", "=", "1"}], ",", 
        RowBox[{"i", "\[LessEqual]", 
         RowBox[{"Length", "[", "iters", "]"}]}], ",", 
        RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"coeff", "=", 
          RowBox[{"getCoefficientsk", "[", 
           RowBox[{"k", ",", "f", ",", 
            RowBox[{
             RowBox[{
             "iters", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
             "\[LeftDoubleBracket]", 
             RowBox[{"1", ";;", ";;", "3"}], "\[RightDoubleBracket]"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{
              "iters", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}],
               "\[LeftDoubleBracket]", 
              RowBox[{"2", ";;", ";;", "3"}], "\[RightDoubleBracket]"}], "-", 
             "1"}], ",", 
            RowBox[{
             RowBox[{
             "iters", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
             "\[LeftDoubleBracket]", 
             RowBox[{"3", ";;", ";;", "3"}], "\[RightDoubleBracket]"}]}], 
           "]"}]}], ";", 
         RowBox[{
          RowBox[{
          "hash", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], "=", 
          RowBox[{
           RowBox[{
           "iters", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
           "\[Rule]", "coeff"}]}], ";"}]}], "]"}], ";", 
      RowBox[{"Return", "[", 
       RowBox[{"SparseArray", "[", 
        RowBox[{"Chop", "[", "hash", "]"}], "]"}], "]"}]}]}], "]"}]}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Seems", " ", "to", " ", "be", " ", "working"}], "*)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"reconstructk", "[", 
    RowBox[{"k_", ",", "coeffs_", ",", "x_List", ",", "n_List"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "i", ",", "place", ",", "value", ",", "d", ",", "indices", ",", "iters",
        ",", "lp", ",", "arraySpot"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"value", "=", "0"}], ";", "\[IndentingNewLine]", 
      RowBox[{"d", "=", 
       RowBox[{"Length", "[", "x", "]"}]}], ";", "  ", 
      RowBox[{"(*", "dimension", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"indices", "=", 
       RowBox[{"pointIndex", "[", 
        RowBox[{"x", ",", "n"}], "]"}]}], ";", " ", 
      RowBox[{"(*", 
       RowBox[{
       "Corresponding", " ", "place", " ", "of", " ", "a", " ", "given", " ", 
        "multidim", " ", "point"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"iters", "=", 
       RowBox[{"hierLevFuncIterate", "[", 
        RowBox[{"k", ",", "n"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"i", "=", "1"}], ",", 
        RowBox[{"i", "\[LessEqual]", 
         RowBox[{"Length", "[", "iters", "]"}]}], ",", 
        RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"lp", "=", 
          RowBox[{"Flatten", "[", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"iters", "\[LeftDoubleBracket]", 
                RowBox[{"i", ",", 
                 RowBox[{
                  RowBox[{"2", "a"}], "-", "1"}]}], "\[RightDoubleBracket]"}],
                ",", 
               RowBox[{"iters", "\[LeftDoubleBracket]", 
                RowBox[{"i", ",", 
                 RowBox[{"2", "a"}]}], "\[RightDoubleBracket]"}], ",", 
               RowBox[{"indices", "\[LeftDoubleBracket]", 
                RowBox[{"a", ",", 
                 RowBox[{"iters", "\[LeftDoubleBracket]", 
                  RowBox[{"i", ",", 
                   RowBox[{"2", "a"}]}], "\[RightDoubleBracket]"}]}], 
                "\[RightDoubleBracket]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"a", ",", "1", ",", "d"}], "}"}]}], "]"}], "]"}]}], ";",
          "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"Print", "[", 
            RowBox[{
             RowBox[{
             "iters", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
             ",", "\"\< and \>\"", ",", 
             RowBox[{"indices", "\[LeftDoubleBracket]", 
              RowBox[{"1", ",", 
               RowBox[{"iters", "\[LeftDoubleBracket]", 
                RowBox[{"i", ",", "2"}], "\[RightDoubleBracket]"}]}], 
              "\[RightDoubleBracket]"}], ",", "\"\<,\>\"", ",", 
             RowBox[{"indices", "\[LeftDoubleBracket]", 
              RowBox[{"2", ",", 
               RowBox[{"iters", "\[LeftDoubleBracket]", 
                RowBox[{"i", ",", "4"}], "\[RightDoubleBracket]"}]}], 
              "\[RightDoubleBracket]"}]}], "]"}], ";"}], "*)"}], 
         RowBox[{"value", "+=", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{
              "coeffs", "\[LeftDoubleBracket]", "##", 
               "\[RightDoubleBracket]"}], "&"}], "@@", 
             RowBox[{"Sequence", "[", "lp", "]"}]}], ")"}], 
           RowBox[{
            RowBox[{"Vk", "[", 
             RowBox[{"k", ",", 
              RowBox[{"lp", "\[LeftDoubleBracket]", 
               RowBox[{"1", ";;", ";;", "3"}], "\[RightDoubleBracket]"}], ",", 
              RowBox[{
               RowBox[{"lp", "\[LeftDoubleBracket]", 
                RowBox[{"2", ";;", ";;", "3"}], "\[RightDoubleBracket]"}], 
               "-", "1"}], ",", 
              RowBox[{"lp", "\[LeftDoubleBracket]", 
               RowBox[{"3", ";;", ";;", "3"}], "\[RightDoubleBracket]"}]}], 
             "]"}], "[", "x", "]"}]}]}]}]}], "\[IndentingNewLine]", "]"}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "value", "]"}], ";"}]}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"reconstructk", "[", 
   RowBox[{"k_", ",", "coeffs_", ",", "n_List"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "i", ",", "place", ",", "d", ",", "indices", ",", "iters", ",", "keys", 
      ",", "value"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"value", "=", 
      RowBox[{"Function", "[", 
       RowBox[{"x", ",", "0"}], "]"}]}], ";", "  ", "\[IndentingNewLine]", 
     RowBox[{"keys", "=", 
      RowBox[{"Keys", "[", 
       RowBox[{"ArrayRules", "[", "coeffs", "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "1"}], ",", 
       RowBox[{"i", "\[LessEqual]", 
        RowBox[{
         RowBox[{"Length", "[", "keys", "]"}], "-", "1"}]}], ",", 
       RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"value", "=", 
         RowBox[{"\[Lambda]", "[", 
          RowBox[{"value", ",", 
           RowBox[{
            RowBox[{
             RowBox[{
             "coeffs", "\[LeftDoubleBracket]", "##", 
              "\[RightDoubleBracket]"}], "&"}], "@@", 
            RowBox[{"Sequence", "[", 
             RowBox[{
             "keys", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
             "]"}]}], ",", 
           RowBox[{"Vk", "[", 
            RowBox[{"k", ",", 
             RowBox[{
              RowBox[{
              "keys", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
              "\[LeftDoubleBracket]", 
              RowBox[{"1", ";;", ";;", "3"}], "\[RightDoubleBracket]"}], ",", 
             
             RowBox[{
              RowBox[{
               RowBox[{
               "keys", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}],
                "\[LeftDoubleBracket]", 
               RowBox[{"2", ";;", ";;", "3"}], "\[RightDoubleBracket]"}], "-",
               "1"}], ",", 
             RowBox[{
              RowBox[{
              "keys", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
              "\[LeftDoubleBracket]", 
              RowBox[{"3", ";;", ";;", "3"}], "\[RightDoubleBracket]"}]}], 
            "]"}]}], "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Return", "[", "value", "]"}], ";"}]}], 
   "]"}]}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.675597360522213*^9, 3.6755973940359087`*^9}, {
   3.675597432372115*^9, 3.675597437915703*^9}, {3.675597472944252*^9, 
   3.675597489740184*^9}, {3.675597531424239*^9, 3.675597551359826*^9}, {
   3.6755975814451723`*^9, 3.675597589829194*^9}, {3.675598647392295*^9, 
   3.675598686706406*^9}, {3.675598731369802*^9, 3.6755987482706823`*^9}, {
   3.675598783771076*^9, 3.67559883059925*^9}, {3.675598870500681*^9, 
   3.6755989146616573`*^9}, {3.675599448030251*^9, 3.6755994497147923`*^9}, {
   3.6755994924921417`*^9, 3.6755995787658787`*^9}, {3.675599645193185*^9, 
   3.6755997192686567`*^9}, {3.6755997615548*^9, 3.67559995086664*^9}, {
   3.6756001879164257`*^9, 3.675600235028776*^9}, {3.6756002676617002`*^9, 
   3.675600297792323*^9}, {3.675600340117649*^9, 3.675600342589993*^9}, {
   3.675601392759037*^9, 3.675601462346682*^9}, {3.675603109469727*^9, 
   3.675603143704265*^9}, {3.6756031917452374`*^9, 3.675603352261416*^9}, {
   3.675603382715767*^9, 3.675603402416751*^9}, {3.675603525915292*^9, 
   3.675603528587769*^9}, {3.675604002514846*^9, 3.6756040042446337`*^9}, {
   3.6756040797483587`*^9, 3.675604083594962*^9}, {3.675604136721023*^9, 
   3.6756041373759937`*^9}, {3.675604176232501*^9, 3.675604224950152*^9}, {
   3.6756962634794283`*^9, 3.675696272556808*^9}, {3.675696346115384*^9, 
   3.6756963481769238`*^9}, {3.6756963817777653`*^9, 
   3.6756964239347677`*^9}, {3.675697714112986*^9, 3.675697725128151*^9}, {
   3.675697970247283*^9, 3.675698068057447*^9}, 3.675698112171318*^9, {
   3.6756983990984297`*^9, 3.67569847612304*^9}, 3.675698538465384*^9, {
   3.6756986001934147`*^9, 3.675698642885778*^9}, {3.6756986849613028`*^9, 
   3.675698686288095*^9}, 3.675699147601448*^9, {3.675699178715358*^9, 
   3.675699192645464*^9}, {3.6756992618858633`*^9, 3.675699269241186*^9}, {
   3.675699320328209*^9, 3.675699324236122*^9}, {3.675699403328292*^9, 
   3.675699405075326*^9}, 3.675699509215411*^9, {3.675699552038303*^9, 
   3.675699555961108*^9}, {3.675699652749856*^9, 3.675699739262806*^9}, {
   3.675699927489901*^9, 3.675699934375901*^9}, 3.6756999994890842`*^9, {
   3.675706096606361*^9, 3.675706107789859*^9}, 3.675706141313574*^9, {
   3.675706306452052*^9, 3.6757063101231737`*^9}, {3.675706409027636*^9, 
   3.675706410019198*^9}, {3.6757072112536173`*^9, 3.675707228606868*^9}, {
   3.675707314213451*^9, 3.675707339023728*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"I", " ", "think", " ", "its", " ", "working", " ", "now"}], 
  "*)"}]], "Input",
 CellChangeTimes->{{3.675605163835569*^9, 3.6756051691615057`*^9}, {
  3.675700019408016*^9, 3.67570002476779*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[Lambda]", "[", 
  RowBox[{
   RowBox[{"Function", "[", 
    RowBox[{"x", ",", "0"}], "]"}], ",", 
   RowBox[{"Vk", "[", 
    RowBox[{"3", ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "1"}], "}"}]}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.675707112706443*^9, 3.675707139881577*^9}, {
  3.675707177206295*^9, 3.675707203830724*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Function", "[", 
     RowBox[{"x", ",", "0"}], "]"}], "[", "#1", "]"}], "+", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"vk", "[", 
         RowBox[{"3", ",", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"1", ",", "1"}], "}"}], "\[LeftDoubleBracket]", "1", 
           "\[RightDoubleBracket]"}], ",", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"1", ",", "1"}], "}"}], "\[LeftDoubleBracket]", "1", 
           "\[RightDoubleBracket]"}], ",", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"1", ",", "1"}], "}"}], "\[LeftDoubleBracket]", "1", 
           "\[RightDoubleBracket]"}]}], "]"}], "[", 
        RowBox[{"#1", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
        "]"}], " ", 
       RowBox[{
        RowBox[{"vk", "[", 
         RowBox[{"3", ",", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"1", ",", "1"}], "}"}], "\[LeftDoubleBracket]", "2", 
           "\[RightDoubleBracket]"}], ",", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"1", ",", "1"}], "}"}], "\[LeftDoubleBracket]", "2", 
           "\[RightDoubleBracket]"}], ",", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"1", ",", "1"}], "}"}], "\[LeftDoubleBracket]", "2", 
           "\[RightDoubleBracket]"}]}], "]"}], "[", 
        RowBox[{"#1", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
        "]"}]}], "&"}], ")"}], "[", "#1", "]"}]}], "&"}]], "Output",
 CellChangeTimes->{3.675707204097251*^9, 3.675707377517812*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"f", "=", 
   RowBox[{"reconstructk", "[", 
    RowBox[{"3", ",", "coeffs", ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "2"}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.675707663052886*^9, 3.675707664694302*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"f", "[", 
   RowBox[{"{", 
    RowBox[{".0", ",", ".0"}], "}"}], "]"}], "//", "Timing"}]], "Input",
 CellChangeTimes->{{3.675707682325762*^9, 3.675707737248289*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.002893`", ",", 
   RowBox[{"-", "0.0037751690708572546`"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.6757076855630493`*^9, 3.67570773750247*^9}}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"Plot3D", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"reconstructk", "[", 
      RowBox[{"3", ",", "coeffs", ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", "y"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"2", ",", "2"}], "}"}]}], "]"}], "-", 
     RowBox[{"Sin", "[", 
      RowBox[{"Pi", " ", "x"}], "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"x", ",", "0", ",", "1"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"y", ",", "0", ",", "1"}], "}"}]}], "]"}], "//", 
  "Timing"}]], "Input",
 CellChangeTimes->{{3.675707440377675*^9, 3.6757074449307413`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"coeffs", "=", 
  RowBox[{"fullCoefficientsk", "[", 
   RowBox[{"3", ",", 
    RowBox[{
     RowBox[{"Sin", "[", 
      RowBox[{"Pi", " ", 
       RowBox[{"#", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "&"}], ",", 
    RowBox[{"{", 
     RowBox[{"2", ",", "2"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.6756892896631527`*^9, 3.67568928969866*^9}, {
  3.675690136854253*^9, 3.675690138341751*^9}}],

Cell[BoxData[
 TagBox[
  TemplateBox[{RowBox[{
      StyleBox[
       TagBox["SparseArray", "SummaryHead"], "NonInterpretableSummary"], 
      StyleBox["[", "NonInterpretableSummary"], 
      DynamicModuleBox[{Typeset`open$$ = False}, 
       PanelBox[
        PaneSelectorBox[{False -> GridBox[{{
              PaneBox[
               ButtonBox[
                DynamicBox[
                 FEPrivate`FrontEndResource[
                 "FEBitmaps", "SquarePlusIconMedium"]], 
                ButtonFunction :> (Typeset`open$$ = True), Appearance -> None,
                 Evaluator -> Automatic, Method -> "Preemptive"], 
               Alignment -> {Center, Center}, ImageSize -> 
               Dynamic[{
                 Automatic, 3.5 CurrentValue["FontCapHeight"]/
                  AbsoluteCurrentValue[Magnification]}]], 
              GraphicsBox[
               RasterBox[
               SparseArray[
                Automatic, {10, 10}, 0.93, {
                 1, {{0, 1, 1, 4, 4, 5, 6, 6, 8, 10, 13}, {{4}, {6}, {7}, {
                   10}, {5}, {9}, {3}, {8}, {5}, {7}, {2}, {3}, {7}}}, {0., 
                  0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.}}], {{0, 
                0}, {10, 10}}, {0, 1}], Frame -> False, Axes -> False, 
               AspectRatio -> 1, ImageSize -> 
               Dynamic[{
                 Automatic, 3.5 CurrentValue["FontCapHeight"]/
                  AbsoluteCurrentValue[Magnification]}], Frame -> True, 
               FrameTicks -> None, FrameStyle -> Directive[
                 Opacity[0.5], 
                 Thickness[Tiny], 
                 RGBColor[0.368417, 0.506779, 0.709798]], 
               FrameLabel -> {None, None}, 
               FrameTicks -> {{None, None}, {None, None}}], 
              GridBox[{{
                 RowBox[{
                   TagBox[
                   "\"Specified elements: \"", "SummaryItemAnnotation"], 
                   "\[InvisibleSpace]", 
                   TagBox["70", "SummaryItem"]}]}, {
                 RowBox[{
                   TagBox["\"Dimensions: \"", "SummaryItemAnnotation"], 
                   "\[InvisibleSpace]", 
                   TagBox[
                    RowBox[{"{", 
                    
                    RowBox[{
                    "3", ",", "3", ",", "2", ",", "3", ",", "3", ",", "2"}], 
                    "}"}], "SummaryItem"]}]}}, 
               GridBoxAlignment -> {
                "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
               False, GridBoxItemSize -> {
                "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
               GridBoxSpacings -> {
                "Columns" -> {{2}}, "Rows" -> {{Automatic}}}, 
               BaseStyle -> {
                ShowStringCharacters -> False, NumberMarks -> False, 
                 PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
            GridBoxAlignment -> {"Rows" -> {{Top}}}, AutoDelete -> False, 
            GridBoxItemSize -> {
             "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
            BaselinePosition -> {1, 1}], True -> GridBox[{{
              PaneBox[
               ButtonBox[
                DynamicBox[
                 FEPrivate`FrontEndResource[
                 "FEBitmaps", "SquareMinusIconMedium"]], 
                ButtonFunction :> (Typeset`open$$ = False), Appearance -> 
                None, Evaluator -> Automatic, Method -> "Preemptive"], 
               Alignment -> {Center, Center}, ImageSize -> 
               Dynamic[{
                 Automatic, 3.5 CurrentValue["FontCapHeight"]/
                  AbsoluteCurrentValue[Magnification]}]], 
              GraphicsBox[
               RasterBox[
               SparseArray[
                Automatic, {10, 10}, 0.93, {
                 1, {{0, 1, 1, 4, 4, 5, 6, 6, 8, 10, 13}, {{4}, {6}, {7}, {
                   10}, {5}, {9}, {3}, {8}, {5}, {7}, {2}, {3}, {7}}}, {0., 
                  0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.}}], {{0, 
                0}, {10, 10}}, {0, 1}], Frame -> False, Axes -> False, 
               AspectRatio -> 1, ImageSize -> 
               Dynamic[{
                 Automatic, 3.5 CurrentValue["FontCapHeight"]/
                  AbsoluteCurrentValue[Magnification]}], Frame -> True, 
               FrameTicks -> None, FrameStyle -> Directive[
                 Opacity[0.5], 
                 Thickness[Tiny], 
                 RGBColor[0.368417, 0.506779, 0.709798]], 
               FrameLabel -> {None, None}, 
               FrameTicks -> {{None, None}, {None, None}}], 
              GridBox[{{
                 RowBox[{
                   TagBox[
                   "\"Specified elements: \"", "SummaryItemAnnotation"], 
                   "\[InvisibleSpace]", 
                   TagBox["70", "SummaryItem"]}]}, {
                 RowBox[{
                   TagBox["\"Dimensions: \"", "SummaryItemAnnotation"], 
                   "\[InvisibleSpace]", 
                   TagBox[
                    RowBox[{"{", 
                    
                    RowBox[{
                    "3", ",", "3", ",", "2", ",", "3", ",", "3", ",", "2"}], 
                    "}"}], "SummaryItem"]}]}, {
                 RowBox[{
                   TagBox["\"Default: \"", "SummaryItemAnnotation"], 
                   "\[InvisibleSpace]", 
                   TagBox["0", "SummaryItem"]}]}, {
                 RowBox[{
                   TagBox["\"Density: \"", "SummaryItemAnnotation"], 
                   "\[InvisibleSpace]", 
                   TagBox["0.21604938271604937`", "SummaryItem"]}]}, {
                 RowBox[{
                   TagBox["\"Elements:\"", "SummaryItemAnnotation"], 
                   "\[InvisibleSpace]", 
                   TagBox["\"\"", "SummaryItem"]}]}, {
                 TagBox[
                  TagBox[
                   GridBox[{{
                    RowBox[{
                    RowBox[{"{", 
                    
                    RowBox[{
                    "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1"}], 
                    "}"}], "\[Rule]", 
                    StyleBox[
                    PaneBox[
                    "0.6366197753212547`", ContentPadding -> False, 
                    FrameMargins -> 0, StripOnInput -> True, BaselinePosition -> 
                    Baseline, ImageSize -> {{1, 300}, Automatic}], 
                    LineBreakWithin -> False]}]}, {
                    RowBox[{
                    RowBox[{"{", 
                    
                    RowBox[{
                    "1", ",", "1", ",", "1", ",", "3", ",", "1", ",", "1"}], 
                    "}"}], "\[Rule]", 
                    StyleBox[
                    PaneBox[
                    "5.823903902538174`*^-10", ContentPadding -> False, 
                    FrameMargins -> 0, StripOnInput -> True, BaselinePosition -> 
                    Baseline, ImageSize -> {{1, 300}, Automatic}], 
                    LineBreakWithin -> False]}]}, {
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"1", ",", "1", ",", "1", ",", "1", ",", "2", ",", 
                    "1"}], "}"}], "\[Rule]", 
                    StyleBox[
                    PaneBox[
                    RowBox[{"-", "2.035643020467659`*^-9"}], ContentPadding -> 
                    False, FrameMargins -> 0, StripOnInput -> True, 
                    BaselinePosition -> Baseline, 
                    ImageSize -> {{1, 300}, Automatic}], LineBreakWithin -> 
                    False]}]}, {
                    RowBox[{
                    RowBox[{"{", 
                    
                    RowBox[{
                    "1", ",", "1", ",", "1", ",", "2", ",", "2", ",", "1"}], 
                    "}"}], "\[Rule]", 
                    StyleBox[
                    PaneBox[
                    "3.2086154531929534`*^-9", ContentPadding -> False, 
                    FrameMargins -> 0, StripOnInput -> True, BaselinePosition -> 
                    Baseline, ImageSize -> {{1, 300}, Automatic}], 
                    LineBreakWithin -> False]}]}, {
                    ItemBox[
                    "\"\[VerticalEllipsis]\"", Alignment -> Center, 
                    StripOnInput -> False]}}, 
                    GridBoxAlignment -> {"Columns" -> {{Left}}}, 
                    DefaultBaseStyle -> "Column", 
                    GridBoxItemSize -> {
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}], 
                   "Column"], "SummaryItem"]}}, 
               GridBoxAlignment -> {
                "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
               False, GridBoxItemSize -> {
                "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
               GridBoxSpacings -> {
                "Columns" -> {{2}}, "Rows" -> {{Automatic}}}, 
               BaseStyle -> {
                ShowStringCharacters -> False, NumberMarks -> False, 
                 PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
            GridBoxAlignment -> {"Rows" -> {{Top}}}, AutoDelete -> False, 
            GridBoxItemSize -> {
             "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
            BaselinePosition -> {1, 1}]}, 
         Dynamic[Typeset`open$$], ImageSize -> Automatic], BaselinePosition -> 
        Baseline], DynamicModuleValues :> {}], 
      StyleBox["]", "NonInterpretableSummary"]}]},
   "CopyTag",
   DisplayFunction->(#& ),
   InterpretationFunction->("SparseArray[<70>, {3, 3, 2, 3, 3, 2}]"& )],
  False,
  Editable->False,
  SelectWithContents->True,
  Selectable->False]], "Output",
 CellChangeTimes->{3.675689301716309*^9, 3.675690150133176*^9, 
  3.675699421595903*^9, 3.675699482890127*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"coeffs", "\[LeftDoubleBracket]", 
    RowBox[{"1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1"}], 
    "\[RightDoubleBracket]"}], ",", "\[IndentingNewLine]", 
   RowBox[{"coeffs", "\[LeftDoubleBracket]", 
    RowBox[{"1", ",", "2", ",", "1", ",", "1", ",", "1", ",", "1"}], 
    "\[RightDoubleBracket]"}], ",", "\[IndentingNewLine]", 
   RowBox[{"coeffs", "\[LeftDoubleBracket]", 
    RowBox[{"1", ",", "3", ",", "1", ",", "1", ",", "1", ",", "1"}], 
    "\[RightDoubleBracket]"}], ",", "\[IndentingNewLine]", 
   RowBox[{"coeffs", "\[LeftDoubleBracket]", 
    RowBox[{"1", ",", "3", ",", "2", ",", "1", ",", "1", ",", "1"}], 
    "\[RightDoubleBracket]"}], ",", "\[IndentingNewLine]", 
   RowBox[{"coeffs", "\[LeftDoubleBracket]", 
    RowBox[{"2", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1"}], 
    "\[RightDoubleBracket]"}], ",", "\[IndentingNewLine]", 
   RowBox[{"coeffs", "\[LeftDoubleBracket]", 
    RowBox[{"2", ",", "2", ",", "1", ",", "1", ",", "1", ",", "1"}], 
    "\[RightDoubleBracket]"}], ",", "\[IndentingNewLine]", 
   RowBox[{"coeffs", "\[LeftDoubleBracket]", 
    RowBox[{"2", ",", "3", ",", "1", ",", "1", ",", "1", ",", "1"}], 
    "\[RightDoubleBracket]"}], ",", "\[IndentingNewLine]", 
   RowBox[{"coeffs", "\[LeftDoubleBracket]", 
    RowBox[{"2", ",", "3", ",", "2", ",", "1", ",", "1", ",", "1"}], 
    "\[RightDoubleBracket]"}], ",", "\[IndentingNewLine]", 
   RowBox[{"coeffs", "\[LeftDoubleBracket]", 
    RowBox[{"3", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1"}], 
    "\[RightDoubleBracket]"}], ",", "\[IndentingNewLine]", 
   RowBox[{"coeffs", "\[LeftDoubleBracket]", 
    RowBox[{"3", ",", "2", ",", "1", ",", "1", ",", "1", ",", "1"}], 
    "\[RightDoubleBracket]"}], ",", "\[IndentingNewLine]", 
   RowBox[{"coeffs", "\[LeftDoubleBracket]", 
    RowBox[{"3", ",", "3", ",", "1", ",", "1", ",", "1", ",", "1"}], 
    "\[RightDoubleBracket]"}], ",", "\[IndentingNewLine]", 
   RowBox[{"coeffs", "\[LeftDoubleBracket]", 
    RowBox[{"3", ",", "3", ",", "2", ",", "1", ",", "1", ",", "1"}], 
    "\[RightDoubleBracket]"}]}], "}"}]], "Input",
 CellChangeTimes->{{3.675689849863028*^9, 3.675689861902364*^9}, {
  3.675689962629819*^9, 3.675689987516062*^9}, {3.675690135624954*^9, 
  3.6756902178748903`*^9}, {3.675690252979836*^9, 3.6756903279923773`*^9}, {
  3.675696011180057*^9, 3.675696015517054*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.6366197753212547`", ",", "0", ",", 
   RowBox[{"-", "0.005856092181884723`"}], ",", "0.0058560921818847644`", ",",
    "0", ",", "0.015092252152855534`", ",", "0.0005097637841936578`", ",", 
   "0.0005097637841936439`", ",", 
   RowBox[{"-", "0.30727387467830936`"}], ",", "0", ",", 
   "0.00002164974957968857`", ",", 
   RowBox[{"-", "0.000021649749579605304`"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.67568985819307*^9, 3.675689862348205*^9}, {
   3.6756899682679157`*^9, 3.675689987773259*^9}, 3.6756901533757057`*^9, 
   3.675690218487548*^9, {3.675690272442696*^9, 3.675690337504404*^9}, 
   3.675696016989983*^9, 3.6756994238005247`*^9, 3.675700228057681*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"Table", "[", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Sqrt", "[", 
      RowBox[{
       RowBox[{".042", "^", "2"}], " ", 
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"reconstructk", "[", 
             RowBox[{"3", ",", "#", ",", 
              RowBox[{"{", 
               RowBox[{"x", ",", "y"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"n", ",", "n"}], "}"}]}], "]"}], "-", 
            RowBox[{"Sin", "[", 
             RowBox[{
              RowBox[{"Pi", " ", "x"}], "+", "y"}], "]"}]}], ")"}], "^", 
          "2"}], ",", 
         RowBox[{"{", 
          RowBox[{"x", ",", "0", ",", "1", ",", ".042"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"y", ",", "0", ",", "1", ",", ".042"}], "}"}]}], "]"}]}], 
      "]"}], "&"}], "@", 
    RowBox[{"fullCoefficientsk", "[", 
     RowBox[{"3", ",", 
      RowBox[{
       RowBox[{"Sin", "[", 
        RowBox[{
         RowBox[{"Pi", " ", 
          RowBox[{
          "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], "+", 
         
         RowBox[{
         "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], "]"}],
        "&"}], ",", 
      RowBox[{"{", 
       RowBox[{"n", ",", "n"}], "}"}]}], "]"}]}], ",", 
   RowBox[{"{", 
    RowBox[{"n", ",", "1", ",", "2"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.6757006324583273`*^9, 3.675700747837984*^9}, {
  3.675700816101571*^9, 3.675700853085331*^9}, {3.6757014967986193`*^9, 
  3.675701499850274*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"k3Error2D", "=", 
  RowBox[{"{", 
   RowBox[{
   "0.008972828411276411`", ",", "0.001255381815069048`", ",", 
    "0.000180915441560261`"}], "}"}]}]], "Input",
 CellChangeTimes->{{3.6757015444677*^9, 3.675701551640152*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0.008972828411276411`", ",", "0.001255381815069048`", ",", 
   "0.000180915441560261`"}], "}"}]], "Output",
 CellChangeTimes->{3.675701571477953*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Sqrt", "[", 
    RowBox[{
     RowBox[{".042", "^", "2"}], " ", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"reconstructk", "[", 
           RowBox[{"3", ",", "#", ",", 
            RowBox[{"{", 
             RowBox[{"x", ",", "y"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"3", ",", "3"}], "}"}]}], "]"}], "-", 
          RowBox[{"Sin", "[", 
           RowBox[{
            RowBox[{"Pi", " ", "x"}], "+", "y"}], "]"}]}], ")"}], "^", "2"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", "0", ",", "1", ",", ".042"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"y", ",", "0", ",", "1", ",", ".042"}], "}"}]}], "]"}]}], 
    "]"}], "&"}], "@", 
  RowBox[{"fullCoefficientsk", "[", 
   RowBox[{"3", ",", 
    RowBox[{
     RowBox[{"Sin", "[", 
      RowBox[{
       RowBox[{"Pi", " ", 
        RowBox[{"#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}],
        "+", 
       RowBox[{"#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
      "]"}], "&"}], ",", 
    RowBox[{"{", 
     RowBox[{"3", ",", "3"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.67570090404609*^9, 3.675700906675572*^9}, {
  3.6757014006229877`*^9, 3.6757014258812027`*^9}}],

Cell[BoxData["0.000180915441560261`"], "Output",
 CellChangeTimes->{3.6757009610231857`*^9, 3.6757014865469093`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Sqrt", "[", 
       RowBox[{
        RowBox[{".042", "^", "2"}], " ", 
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"reconstructk", "[", 
              RowBox[{"2", ",", "#", ",", 
               RowBox[{"{", 
                RowBox[{"x", ",", "y"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"n", ",", "n"}], "}"}]}], "]"}], "-", 
             RowBox[{"Sin", "[", 
              RowBox[{
               RowBox[{"Pi", " ", "x"}], "+", "y"}], "]"}]}], ")"}], "^", 
           "2"}], ",", 
          RowBox[{"{", 
           RowBox[{"x", ",", "0", ",", "1", ",", ".042"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"y", ",", "0", ",", "1", ",", ".042"}], "}"}]}], "]"}]}], 
       "]"}], "&"}], "@", 
     RowBox[{"fullCoefficientsk", "[", 
      RowBox[{"2", ",", 
       RowBox[{
        RowBox[{"Sin", "[", 
         RowBox[{
          RowBox[{"Pi", " ", 
           RowBox[{
           "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], "+", 
          RowBox[{
          "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
         "]"}], "&"}], ",", 
       RowBox[{"{", 
        RowBox[{"n", ",", "n"}], "}"}]}], "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"n", ",", "1", ",", "2"}], "}"}]}], "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Table", "[", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Sqrt", "[", 
      RowBox[{
       RowBox[{".021", "^", "2"}], " ", 
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"reconstructk", "[", 
             RowBox[{"2", ",", "#", ",", 
              RowBox[{"{", 
               RowBox[{"x", ",", "y"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"n", ",", "n"}], "}"}]}], "]"}], "-", 
            RowBox[{"Sin", "[", 
             RowBox[{
              RowBox[{"Pi", " ", "x"}], "+", "y"}], "]"}]}], ")"}], "^", 
          "2"}], ",", 
         RowBox[{"{", 
          RowBox[{"x", ",", "0", ",", "1", ",", ".021"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"y", ",", "0", ",", "1", ",", ".021"}], "}"}]}], "]"}]}], 
      "]"}], "&"}], "@", 
    RowBox[{"fullCoefficientsk", "[", 
     RowBox[{"2", ",", 
      RowBox[{
       RowBox[{"Sin", "[", 
        RowBox[{
         RowBox[{"Pi", " ", 
          RowBox[{
          "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], "+", 
         
         RowBox[{
         "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], "]"}],
        "&"}], ",", 
      RowBox[{"{", 
       RowBox[{"n", ",", "n"}], "}"}]}], "]"}]}], ",", 
   RowBox[{"{", 
    RowBox[{"n", ",", "1", ",", "2"}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.675700992206559*^9, 3.675700994424534*^9}, {
   3.675701389831311*^9, 3.675701393693149*^9}, {3.675703052643264*^9, 
   3.675703066345828*^9}, 3.675737215317155*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.06578470539224326`", ",", "0.017857903723802963`"}], 
  "}"}]], "Output",
 CellChangeTimes->{3.675703074166832*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.06461227126787097`", ",", "0.01672065262138391`"}], 
  "}"}]], "Output",
 CellChangeTimes->{3.675703087710135*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"k2Error2D", "=", 
  RowBox[{"{", 
   RowBox[{
   "0.06461227126787097`", ",", "0.01672065262138391`", ",", 
    "0.004324636027334101`"}], "}"}]}]], "Input",
 CellChangeTimes->{{3.6757015648085127`*^9, 3.6757015678411818`*^9}, 
   3.675703099731632*^9, 3.675704024161704*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0.06461227126787097`", ",", "0.01672065262138391`", ",", 
   "0.004324636027334101`"}], "}"}]], "Output",
 CellChangeTimes->{3.675701569722958*^9, 3.675703100620152*^9, 
  3.675704024662291*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Sqrt", "[", 
    RowBox[{
     RowBox[{".021", "^", "2"}], " ", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"reconstructk", "[", 
           RowBox[{"2", ",", "#", ",", 
            RowBox[{"{", 
             RowBox[{"x", ",", "y"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"3", ",", "3"}], "}"}]}], "]"}], "-", 
          RowBox[{"Sin", "[", 
           RowBox[{
            RowBox[{"Pi", " ", "x"}], "+", "y"}], "]"}]}], ")"}], "^", "2"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", "0", ",", "1", ",", ".021"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"y", ",", "0", ",", "1", ",", ".021"}], "}"}]}], "]"}]}], 
    "]"}], "&"}], "@", 
  RowBox[{"fullCoefficientsk", "[", 
   RowBox[{"2", ",", 
    RowBox[{
     RowBox[{"Sin", "[", 
      RowBox[{
       RowBox[{"Pi", " ", 
        RowBox[{"#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}],
        "+", 
       RowBox[{"#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
      "]"}], "&"}], ",", 
    RowBox[{"{", 
     RowBox[{"3", ",", "3"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.675701046112761*^9, 3.675701047677504*^9}, {
  3.675701299135983*^9, 3.675701335752852*^9}, {3.675703122011153*^9, 
  3.6757031261022663`*^9}}],

Cell[BoxData["0.004324636027334101`"], "Output",
 CellChangeTimes->{3.675701064170487*^9, 3.6757013175638027`*^9, 
  3.675701352246928*^9, 3.6757031538334923`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Show", "[", 
  RowBox[{
   RowBox[{"ListPlot", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"k2Error2D", ",", "k3Error2D", ",", "k4Error2D"}], "}"}], "//", 
     "Log2"}], "]"}], ",", 
   RowBox[{"Plot", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"-", "2"}], "x"}], "-", "2"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "3"}], "x"}], "-", "3.5"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "4"}], "x"}], "-", "5"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", "0", ",", "3"}], "}"}]}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.675701097166885*^9, 3.67570111280575*^9}, {
  3.675701578393867*^9, 3.6757016152193747`*^9}, {3.6757028952846937`*^9, 
  3.67570296454115*^9}}],

Cell[BoxData[
 GraphicsBox[{{{}, {{}, 
     {RGBColor[0.368417, 0.506779, 0.709798], PointSize[
      0.012833333333333334`], AbsoluteThickness[1.6], 
      PointBox[{{1., -3.952047999839442}, {2., -5.902225031634669}, {
       3., -7.8532055677870485`}}]}, 
     {RGBColor[0.880722, 0.611041, 0.142051], PointSize[
      0.012833333333333334`], AbsoluteThickness[1.6], 
      PointBox[{{1., -6.800221462090325}, {2., -9.637658068748353}, {
       3., -12.432396828905564`}}]}, 
     {RGBColor[0.560181, 0.691569, 0.194885], PointSize[
      0.012833333333333334`], AbsoluteThickness[1.6], 
      PointBox[{{1., -10.146624336884193`}, {2., -13.752229226821424`}, {
       3., -16.999013169527036`}}]}, {}}, {}}, {{{}, {}, 
     {RGBColor[0.368417, 0.506779, 0.709798], AbsoluteThickness[1.6], Opacity[
      1.], LineBox[CompressedData["
1:eJwlx3lQ1GUcx/Ef7MIDm9y4cj8IuiPhWBhIavA8YCRSG4chEKeEOjoIjKlc
SWCzHMpNVMgAi7mGgiSLFSnHV45EhstADREVAlZJ5FJQFyTq+ePzfs1nbXi0
zz5VjuPEK/vPlx9HlXhFxzivRHflQoD6SYMe0afEJWZkoJXHgTSX7MkShZDR
HN8fMxAHLb6lsZGiKGLbs32LgQ4HvnVijSBREvkfCw5KD8p6d4uySZ9H+U+f
fMCBq+utK56iUqLp1udcFMfBt5sU58WianJsq+PhzTMcCEKezTw+1ESGxyxy
qudVIM1s/7Ff9twgeS1V1XcmVIHX5tEuu9VNpP6av9vf44FBm9DqSGwfcauR
pN8f4sOvT6V7rtO7ZNP2Ct93e9WgyupimWPgIKlMn1B03VEHvOVZgST8IUnP
UkaU/4XAO21fk0v+MKlokT+0vKkBDQkGpL/4bxLSkIEnujShplfrauPJMeL/
WD049LoAIgplgtVhCiLv8JEILr8FdPirsTf7nhBpTOORZfkqkOVIr9Fd/5A/
d/YGS89pgX0bz0zoO0nOjKhon76oDSkH+T5+flME7FUvVFbqgG1dhUtc8TQR
BvVb1ot1wXY5qiy7bIZ89/Vvnjd6dCE6dvC1V/4sqbt2+MSGXXrgXnvANLho
jpwbqM2q7tSD5PPNorLi54Tu3lvQI9aHxY6Wd7IyX5CkseHvP/pDH7RqR5da
8+ZJasBs0oi7AYR3Vt6skCwQu/HbEf3NBiAscUluPvqSnO62pHu3GUKo3YJy
fdwrcvkH5ZJ+vSFMzvscczj0mhxPvHDVxGE16CR312bHKIkGVQTsrFsNeWA0
ZH5kkbiHZT7T3ioEv82a/IDwJbKxiH9yY40Q5AeMp4f2vyEDtateRr23Bry7
ewa0P18mGxSKSHRpDWw4/vbdbes4yjSCmfFF6wIZR5lGEBRzNtrFQoUyjSF/
8G6JYbkKZRrDodBHHU6mqpRpAjPOXpMqBaqUaQI7OK/ZCUMeZZqC4z2reZts
HmWawotCyf0sPT5lmsEXlzzrMvP5lGkGXw49zR8WqFGmOYinjL0Cs9Qo0xw6
jE1W2SJ1yrSA+bKUhsIkdcq0gEkU772eQ5SJITV9x6ggHlEmhpbivDpRIqJM
DNzPDzNdTyDKxBB/O9EhIQVRJoZIqyupTzIQZWLwrl9n034GUSYGs2m1KEk9
okwM/rzPXMsbEWViKBSeFTYAokwM2k7OTc9bEWViUDl1XDeiC1EmhnFrhdz1
AaJMDNaODmkhjxBlYgjz+CYwYQRRJoaBGMyXjyPKxNDZ4Oe7dgpRJgaNWzIb
pxlEmRjcRueW/OcQZWJoFOSez11AlIlBaf4goeoVokwM79tt9GxXIsrEcPTD
BOvRJUSZGGr82heWlxFlYvgXJBVFAA==
       "]]}, 
     {RGBColor[0.880722, 0.611041, 0.142051], AbsoluteThickness[1.6], Opacity[
      1.], LineBox[CompressedData["
1:eJwVxXk41GkcAPBxvjWGTVMTRpjD9JNSPE3ayrzv6Niyj6tWjiQselSOJFe2
xxHtehphqCdCxxrWpt2wZXcZ32JqViXK6rCJ3GVy5sgxu/vH5/lwAiP2BWvS
aDTn//z/zNfhhW4RkaLhGZkRjcYAb90U5lOBCw4oe767VIcBV7PwAYnAD7d7
0k656DGgwaMo9rggHMMd79YrLAZ41Dgv8RWcwbnRjIwv1zOgKLSkZb8gEzuM
npiL8mGAo2NrtaugCGcObO/sq2ZArs2AzFlwC29of3bjUag+0P0+jg0ercet
XrfadcYN4JxpyKnfDjzEFTkaWpyNy0BL4aQsaW3GcZoPM0p7lgFTweJGxT7H
kzuDQoJlhnBn+OqBe+QFDlwnInzf5XCTW15sf7ADJ/WPhJlwmGC++aM0LfAt
FpTX6sW/Y4L7ueB6cU43li9/UPry4gqoS2DitoIejFxKL0X4rITbLfp/yFP6
sKONIg0ZsiAor4S+0n8A6xot9qBGFpDuxL7F4CEc12ZwEaevgpILV/8kez/g
TqHv7rhtRrBJoWXK8lDhydBkp0G1ESSHau/z9BzBWaX35ADGYF1TJo4rGMUW
GSLb/GgTsFaHF2cWj2F/LJ0ut2dDRGzHZ7eccSy9zK+tVbFhT9UR9qHLEzjm
gaRNp8oUkmT3BcUFk7hr3vDQ3ejVMN/UsEFy/hN2ePmsJ9TKDPSrehcas6ew
U/ox+X6VGQQ+/vmvsrRp7PSKXBL9aA6sQnHS/egZPJhvNKq0toDDttNzlnGz
+GxloshAYgGqqX2nhEc/48umar22AQv4Iqm5KjNyDutGhqUKnTiQDUZvVkfN
4817huwelXPA026ptnfgAu6KSg3o1uZC5RHj0Tchi7gnfelWaQgX3JufvjLw
UWM/VUW24h4XqJi1L7byaaTo5WHOOjYPxvrnedISGhFWLPjYJPLAN/J6hNhM
g+xq+515u50HOR0vCldc0yC3egNinm7hw9HDXU0ObE2S9RXlFZ7LhzGRm0pD
qkmEG+ZPiD/yYQfNbfz9Ci1iR6sV/upqCfavuVNWmVrkJ15+XHG5JXzKS/tH
YqhN4jYGBa/VF8C3Fa4153O0Cf3+toyhMAGcfDOc003XISyZrY2VUgDOI8Zu
ByU6JOEkM1F77RpoMjZhWCNd4iVl7vVPWwNTxcl1eWd0yYw9x2W0cw2oULy7
JQ2RcYXJAptQkP79jl56PCJBMjtrZT4FDQXZNYLTiDzbFEY/dIUC2i9vzzt+
hwhpKB0aK6Qg/u/TwoRkRNhdpmXsaxQc51anD/2ASKsxsowopcC9lm+lzEfE
QdJhxqqmwHRUJzytFpGV0WeXBz2hwEvrG8drckRSNOvHZpopyGNdZ9UBIqNZ
sy2SFgoMHET1k42INFWEX7j7nAKNjJhlQU8QSR7wYui9pqCfN1Dp2InIsM96
3cp+Cnj2wnN+XYj4DB3p2z1Igb9T6sGEd4goY683dgxR8CrSXLuyH5EbuatS
dVQUPK7z9OCMIOLdrEHznqBgSWuJlcMYIg98t79VTVKwq3diwWsCkU0fYuQp
UxTI6VmyrGlEDJYMJ96cpWBudWfCzVlEEi8KfMVzFGyxXeeqnEPkPT9gW/s8
BdE7E3i9C4h4VhWYHFuk4LanclqtRkQhbp9Vqyn4FxztROE=
       "]]}, 
     {RGBColor[0.560181, 0.691569, 0.194885], AbsoluteThickness[1.6], Opacity[
      1.], LineBox[CompressedData["
1:eJwlxX08FHYcwPHj8JOVHly3SB7uOA8nfrWkh/H7YZpsN0e7uBIy1atewqvn
tETt0EKctJV5artmJQttXXWnb9GSV+iBpELsOFniKA+dh7XdH5/P2zYqLniL
PoPBEHzoP8e+iM0XxsV7fdgcBoMFYqOjZo28r4h3fFdrDZMFRVlkfQYvnKhO
in4+jlhQLSrYH8OLJfzG1cvNZrNAJBcYh/ESyf9YsaBgu+zBOl4meRxQ/OuX
n7LAx+fhlUBeAZnh99jrzAEWnHJVnxfwysjelR47l2pYYBL+RtO74ybp7LY6
WTYyH1Itt+79Y/1dkl1dWvakjw3MOwG1socNpCh0xrVlzz4Gsztszq79j4lf
uSTtRdsC+PN10fpbtIW4ri4R4QfmUMq5UOix8Tm5mNanrn9iAdbL3+RIojpI
WoY2uvjpQghK3XLTW9pJSqorOmzuWYIywYw05f1NwpXHrfvqF0H5g1nXq452
k9Beo00Rt6wgOldmMj9STSrqgiUml62Bdn7bPbXlFRGuiLh2RGwDspNFN+ja
f8grbq+r8JENLLvDtGSL+olAw0j1E9lC8naD4JCQARJpkdzU3GwLfHmJ94G8
QcIOa7JRCDjAn44tzCzUkNNHrgbebeRA3P7n74XSISK/sfOw41ou+FduW7jp
zDD5pbUyo+w+F5LO3+YV5r0ldN3mnEaBHUzUVbtlpL8jid2dP6z5yw5mVaom
a7JHSIp4KLHL3x6i7l+8VyIZJUt6mqObbtsDO9876faeMXKiwYZuXsWDiCWj
WvsD4+Tyj9rJeQoe9I8E73Xf8Z7sO/TbdQt3B5id1FCZGa8lxlQt/lzuANmw
oG3RrgniH5n+xnSlI4QsnWEgjpokLmcMjrqUO0LFNvPBtq1TpLVy5ljsJ04Q
1NDYarphmjiq1THokhM47nNuWWXHoDqdQdMzwc2RMahOZwiLPxfnbaVHdfJB
+rwln1WsR3XyYUfEyzrPhfpUpwtovIT9ejn6VKcL+DKEQ30sJtW5GDyecUac
MplU52J4lyt5kTHXgOp0hW8uBcrTpQZUpyvsbnst7TQxpDrdQDBgLtyYYUh1
ukGducVMPjKi3TNnpeQyMYwUJitzE42othHaAwiGfnQwyJ6B6MgxRcm8JAwp
ab4qk4OI+tbY7pIoMFTnZct5hxDtqvcPy1FiYPzeke5zGNGklrg1xVUYDjYf
ck9IRlTRp7RQAoYYzpWUV8cRXT53Q/XbGgxBCjun2rOIOoZLWdH1GCwHDWMl
CkRNx/Sv+rRjCGV+7VNchWipnnOxsANDLvscWwmIBnwUdCL8JQZTT6+bb2sQ
TbUqjEjowqD3/b450fWIMvxWG1f0YOjhqit82hEdzt4tth3AwPVwTw1/iag0
76yv2yCGyIBjGxO6EMWyW4s9NRha460NKnoQjZHP1hcPY7ivDBHZDiDa037x
QtYoBuOHMidPDaLf9T46VTCGwU81PBk6jChnaDyxdBxDlUnW+axRRCMM/dfV
ajFoF7UnlI4jOmUa5/lkAsOKJS6BtVpEf1pw2kE1iWHPZwlc1SSiqzjKuUNT
GMpDakenpxF9yldpp6cx/AuNEE7h
       "]]}}, {}}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{True, True},
  AxesLabel->{None, None},
  AxesOrigin->{0., 0},
  DisplayFunction->Identity,
  Frame->{{False, False}, {False, False}},
  FrameLabel->{{None, None}, {None, None}},
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  ImagePadding->All,
  Method->{"CoordinatesToolOptions" -> {"DisplayFunction" -> ({
        (Part[{{Identity, Identity}, {Identity, Identity}}, 1, 2][#]& )[
         Part[#, 1]], 
        (Part[{{Identity, Identity}, {Identity, Identity}}, 2, 2][#]& )[
         Part[#, 2]]}& ), "CopiedValueFunction" -> ({
        (Part[{{Identity, Identity}, {Identity, Identity}}, 1, 2][#]& )[
         Part[#, 1]], 
        (Part[{{Identity, Identity}, {Identity, Identity}}, 2, 2][#]& )[
         Part[#, 2]]}& )}},
  PlotRange->{{0., 3.}, {-16.999013169527036`, 0}},
  PlotRangeClipping->True,
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {
     Scaled[0.05], 
     Scaled[0.02]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{{3.675701109992447*^9, 3.675701113058147*^9}, {
   3.675701572852415*^9, 3.6757016154371653`*^9}, 3.675702897068986*^9, {
   3.6757029297052794`*^9, 3.675702965333359*^9}, 3.6757031080719357`*^9, 
   3.675704026546048*^9, 3.675704320733556*^9, 3.67572508790865*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"Table", "[", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Sqrt", "[", 
      RowBox[{
       RowBox[{".042", "^", "2"}], " ", 
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"reconstructk", "[", 
             RowBox[{"4", ",", "#", ",", 
              RowBox[{"{", 
               RowBox[{"x", ",", "y"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"n", ",", "n"}], "}"}]}], "]"}], "-", 
            RowBox[{"Sin", "[", 
             RowBox[{
              RowBox[{"Pi", " ", "x"}], "+", "y"}], "]"}]}], ")"}], "^", 
          "2"}], ",", 
         RowBox[{"{", 
          RowBox[{"x", ",", "0", ",", "1", ",", ".042"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"y", ",", "0", ",", "1", ",", ".042"}], "}"}]}], "]"}]}], 
      "]"}], "&"}], "@", 
    RowBox[{"fullCoefficientsk", "[", 
     RowBox[{"4", ",", 
      RowBox[{
       RowBox[{"Sin", "[", 
        RowBox[{
         RowBox[{"Pi", " ", 
          RowBox[{
          "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], "+", 
         
         RowBox[{
         "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], "]"}],
        "&"}], ",", 
      RowBox[{"{", 
       RowBox[{"n", ",", "n"}], "}"}]}], "]"}]}], ",", 
   RowBox[{"{", 
    RowBox[{"n", ",", "1", ",", "3"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.675702566888404*^9, 3.675702579060319*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"k4Error2D", "=", 
  RowBox[{"{", 
   RowBox[{
   "0.0008821891657517703`", ",", "0.00007247137403391592`", ",", 
    "7.634614965470947`*^-6"}], "}"}]}]], "Input",
 CellChangeTimes->{{3.675702885600314*^9, 3.67570288979996*^9}, 
   3.675704316719129*^9, 3.675725084373694*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0.0008821891657517703`", ",", "0.00007247137403391592`", ",", 
   "7.634614965470947`*^-6"}], "}"}]], "Output",
 CellChangeTimes->{3.6757028902075253`*^9, 3.675704317237171*^9, 
  3.6757250852165813`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Sqrt", "[", 
    RowBox[{
     RowBox[{".021", "^", "2"}], " ", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"reconstructk", "[", 
           RowBox[{"4", ",", "#", ",", 
            RowBox[{"{", 
             RowBox[{"x", ",", "y"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"2", ",", "2"}], "}"}]}], "]"}], "-", 
          RowBox[{"Sin", "[", 
           RowBox[{
            RowBox[{"Pi", " ", "x"}], "+", "y"}], "]"}]}], ")"}], "^", "2"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", "0", ",", "1", ",", ".021"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"y", ",", "0", ",", "1", ",", ".021"}], "}"}]}], "]"}]}], 
    "]"}], "&"}], "@", 
  RowBox[{"fullCoefficientsk", "[", 
   RowBox[{"4", ",", 
    RowBox[{
     RowBox[{"Sin", "[", 
      RowBox[{
       RowBox[{"Pi", " ", 
        RowBox[{"#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}],
        "+", 
       RowBox[{"#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
      "]"}], "&"}], ",", 
    RowBox[{"{", 
     RowBox[{"2", ",", "2"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.675704045963018*^9, 3.67570406398081*^9}, {
  3.67570432870407*^9, 3.675704351896193*^9}, {3.675725054902663*^9, 
  3.6757250631186523`*^9}, {3.675725098429775*^9, 3.675725100899*^9}}],

Cell[BoxData["0.000058397614355469583`"], "Output",
 CellChangeTimes->{3.67570405400807*^9, 3.675704279198488*^9, 
  3.675704343891399*^9, 3.6757043764432173`*^9, 3.675725187061368*^9}]
}, Open  ]]
},
WindowSize->{808, 651},
WindowMargins->{{Automatic, 12}, {Automatic, 0}},
FrontEndVersion->"10.4 for Mac OS X x86 (32-bit, 64-bit Kernel) (February 25, \
2016)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 847, 24, 52, "Input",
 InitializationCell->True],
Cell[1408, 46, 372, 10, 28, "Input"],
Cell[1783, 58, 12494, 395, 844, "Input",
 InitializationCell->True],
Cell[14280, 455, 343, 9, 28, "Input",
 InitializationCell->True],
Cell[14626, 466, 925, 27, 52, "Input",
 InitializationCell->True],
Cell[15554, 495, 1409, 37, 63, "Input"],
Cell[16966, 534, 6076, 177, 227, "Input"],
Cell[23045, 713, 10181, 238, 814, "Input"],
Cell[33229, 953, 1462, 44, 63, "Input"],
Cell[34694, 999, 11879, 264, 675, "Input"],
Cell[46576, 1265, 237, 5, 28, "Input"],
Cell[CellGroupData[{
Cell[46838, 1274, 495, 14, 28, "Input"],
Cell[47336, 1290, 1642, 44, 46, "Output"]
}, Open  ]],
Cell[48993, 1337, 266, 7, 28, "Input"],
Cell[CellGroupData[{
Cell[49284, 1348, 200, 5, 28, "Input"],
Cell[49487, 1355, 188, 4, 28, "Output"]
}, Open  ]],
Cell[49690, 1362, 609, 18, 46, "Input"],
Cell[CellGroupData[{
Cell[50324, 1384, 442, 12, 28, "Input"],
Cell[50769, 1398, 9750, 204, 61, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[60556, 1607, 2404, 42, 216, "Input"],
Cell[62963, 1651, 712, 12, 46, "Output"]
}, Open  ]],
Cell[63690, 1666, 1594, 46, 80, "Input"],
Cell[CellGroupData[{
Cell[65309, 1716, 247, 6, 28, InheritFromParent],
Cell[65559, 1724, 192, 5, 28, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[65788, 1734, 1336, 39, 46, "Input"],
Cell[67127, 1775, 116, 1, 28, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[67280, 1781, 3114, 90, 165, "Input"],
Cell[70397, 1873, 157, 4, 28, "Output"],
Cell[70557, 1879, 156, 4, 28, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[70750, 1888, 299, 7, 28, InheritFromParent],
Cell[71052, 1897, 237, 6, 28, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[71326, 1908, 1384, 40, 46, "Input"],
Cell[72713, 1950, 163, 2, 28, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[72913, 1957, 820, 25, 46, "Input"],
Cell[73736, 1984, 7283, 134, 232, "Output"]
}, Open  ]],
Cell[81034, 2121, 1492, 44, 80, "Input"],
Cell[CellGroupData[{
Cell[82551, 2169, 300, 7, 28, InheritFromParent],
Cell[82854, 2178, 247, 6, 35, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[83138, 2189, 1425, 40, 46, "Input"],
Cell[84566, 2231, 185, 2, 28, "Output"]
}, Open  ]]
}
]
*)

